<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>30&nbsp; Inferenza bayesiana su una media – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/linear_models/08_two_means.html" rel="next">
<link href="../../chapters/linear_models/06_specification_error.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_sec.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/07_one_mean.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#la-variabilit%C3%A0-come-punto-di-partenza" id="toc-la-variabilità-come-punto-di-partenza" class="nav-link active" data-scroll-target="#la-variabilit%C3%A0-come-punto-di-partenza"><span class="header-section-number">30.1</span> La variabilità come punto di partenza</a></li>
  <li><a href="#il-modello-normale-un-primo-passo-nella-descrizione-della-variabilit%C3%A0" id="toc-il-modello-normale-un-primo-passo-nella-descrizione-della-variabilità" class="nav-link" data-scroll-target="#il-modello-normale-un-primo-passo-nella-descrizione-della-variabilit%C3%A0"><span class="header-section-number">30.2</span> Il modello Normale: un primo passo nella descrizione della variabilità</a></li>
  <li><a href="#un-esempio-concreto-la-variabilit%C3%A0-dellaltezza-nei-kung-san" id="toc-un-esempio-concreto-la-variabilità-dellaltezza-nei-kung-san" class="nav-link" data-scroll-target="#un-esempio-concreto-la-variabilit%C3%A0-dellaltezza-nei-kung-san"><span class="header-section-number">30.3</span> Un esempio concreto: la variabilità dell’altezza nei !Kung San</a></li>
  <li><a href="#specifica-del-modello-una-distribuzione-per-descrivere-lincertezza" id="toc-specifica-del-modello-una-distribuzione-per-descrivere-lincertezza" class="nav-link" data-scroll-target="#specifica-del-modello-una-distribuzione-per-descrivere-lincertezza"><span class="header-section-number">30.4</span> Specifica del modello: una distribuzione per descrivere l’incertezza</a></li>
  <li><a href="#stime-preliminari-una-fotografia-della-variabilit%C3%A0" id="toc-stime-preliminari-una-fotografia-della-variabilità" class="nav-link" data-scroll-target="#stime-preliminari-una-fotografia-della-variabilit%C3%A0"><span class="header-section-number">30.5</span> Stime preliminari: una fotografia della variabilità</a></li>
  <li><a href="#il-modello-frequentista-stimare-la-media-come-punto-fisso" id="toc-il-modello-frequentista-stimare-la-media-come-punto-fisso" class="nav-link" data-scroll-target="#il-modello-frequentista-stimare-la-media-come-punto-fisso"><span class="header-section-number">30.6</span> Il modello frequentista: stimare la media come punto fisso</a></li>
  <li><a href="#il-modello-bayesiano-descrivere-lincertezza-con-distribuzioni" id="toc-il-modello-bayesiano-descrivere-lincertezza-con-distribuzioni" class="nav-link" data-scroll-target="#il-modello-bayesiano-descrivere-lincertezza-con-distribuzioni"><span class="header-section-number">30.7</span> Il modello Bayesiano: descrivere l’incertezza con distribuzioni</a></li>
  <li><a href="#uso-dei-prior-nel-modello-bayesiano-rendere-esplicite-le-ipotesi-sullincertezza" id="toc-uso-dei-prior-nel-modello-bayesiano-rendere-esplicite-le-ipotesi-sullincertezza" class="nav-link" data-scroll-target="#uso-dei-prior-nel-modello-bayesiano-rendere-esplicite-le-ipotesi-sullincertezza"><span class="header-section-number">30.8</span> Uso dei Prior nel Modello Bayesiano: rendere esplicite le ipotesi sull’incertezza</a></li>
  <li><a href="#visualizzare-lincertezza-con-bayesplot" id="toc-visualizzare-lincertezza-con-bayesplot" class="nav-link" data-scroll-target="#visualizzare-lincertezza-con-bayesplot"><span class="header-section-number">30.9</span> Visualizzare l’incertezza con <code>bayesplot</code></a></li>
  <li><a href="#lapproccio-tradizionale-il-test-t-di-student" id="toc-lapproccio-tradizionale-il-test-t-di-student" class="nav-link" data-scroll-target="#lapproccio-tradizionale-il-test-t-di-student"><span class="header-section-number">30.10</span> L’approccio tradizionale: il test t di Student</a></li>
  <li><a href="#confronto-tra-approcci-stesso-dato-epistemologie-diverse" id="toc-confronto-tra-approcci-stesso-dato-epistemologie-diverse" class="nav-link" data-scroll-target="#confronto-tra-approcci-stesso-dato-epistemologie-diverse"><span class="header-section-number">30.11</span> Confronto tra approcci: stesso dato, epistemologie diverse</a></li>
  <li><a href="#replicare-lanalisi-con-cmdstanr" id="toc-replicare-lanalisi-con-cmdstanr" class="nav-link" data-scroll-target="#replicare-lanalisi-con-cmdstanr"><span class="header-section-number">30.12</span> Replicare l’analisi con <code>cmdstanr</code></a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/07_one_mean.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_sec.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/07_one_mean.html"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-mcmc-one-mean" class="quarto-section-identifier"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="epigraph">
<blockquote class="blockquote">
<p>“Il problema statistico non è stimare una media come se fosse un’entità assoluta, ma descrivere la distribuzione delle nostre credenze su di essa.”</p>
<p>— ispirato a <strong>Harold Jeffreys</strong></p>
</blockquote>
</div>
<section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>In questo capitolo affrontiamo uno dei problemi più elementari — e al tempo stesso fondamentali — della statistica: stimare la <strong>media di una popolazione</strong> a partire da un campione di osservazioni. È una situazione ricorrente nella ricerca psicologica: possiamo chiederci qual è l’altezza media in un gruppo di adolescenti, il livello medio di ansia in un campione clinico, oppure la soddisfazione media di studenti che hanno seguito un determinato corso.</p>
<p>Tradizionalmente, questo problema è stato affrontato nell’ottica frequentista, che porta a costruire intervalli di confidenza o a testare ipotesi sulla media. In questa prospettiva, la media della popolazione è un valore fisso ma sconosciuto, e il ragionamento si concentra sul comportamento dei campioni che avremmo potuto osservare “se ripetessimo l’esperimento molte volte”.</p>
<p>L’approccio <em>bayesiano</em> rovescia la prospettiva: la media non è un’entità misteriosa e fissa, ma una quantità sulla quale formuliamo delle <em>credenze incerte</em>, che possiamo aggiornare alla luce dei dati raccolti. Non stimiamo quindi “la media” in senso assoluto, ma descriviamo la <em>distribuzione delle nostre convinzioni</em> plausibili su di essa.</p>
<p>Questo cambiamento concettuale ha conseguenze profonde. Significa che l’analisi non si riduce a un verdetto dicotomico, ma diventa una rappresentazione sfumata dell’incertezza. Significa anche che possiamo integrare conoscenze pregresse tramite distribuzioni a priori, e che ogni inferenza riguarda direttamente i valori del parametro, non campioni ipotetici mai osservati.</p>
<p>In questo capitolo vedremo come costruire e interpretare una distribuzione a posteriori per la media di una popolazione, utilizzando esempi psicologici concreti. Sarà il primo passo per estendere il ragionamento bayesiano a situazioni più articolate, come il confronto tra due gruppi o la valutazione della grandezza di un effetto.</p>
<section id="panoramica-del-capitolo" class="level3 unnumbered unlisted"><h3 class="unnumbered unlisted anchored" data-anchor-id="panoramica-del-capitolo">Panoramica del capitolo</h3>
<ul>
<li>Come fare inferenza sulla media di un campione.</li>
<li>Come trovare le distribuzioni a posteriori usando <code>brms</code>.</li>
<li>Verificare il modello usando i pp-check plots.</li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Geocentric models</em> di Statistical rethinking <span class="citation" data-cites="McElreath_rethinking">(<a href="#ref-McElreath_rethinking" role="doc-biblioref">McElreath, 2020</a>)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">bayestestR</span>, <span class="va">brms</span>, <span class="va">ggdist</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">conflicts_prefer</span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="la-variabilità-come-punto-di-partenza" class="level2" data-number="30.1"><h2 data-number="30.1" class="anchored" data-anchor-id="la-variabilità-come-punto-di-partenza">
<span class="header-section-number">30.1</span> La variabilità come punto di partenza</h2>
<p>Ogni volta che raccogliamo dati psicologici, ci confrontiamo inevitabilmente con la variabilità. Alcune differenze sono <em>tra individui</em>:</p>
<p><em>Variabilità inter-individuale</em>: ad esempio, quanto differiscono tra loro le altezze, i tempi di reazione o i livelli di benessere soggettivo?</p>
<p>Altre differenze sono <em>all’interno dello stesso individuo</em>, anche se meno visibili in un singolo rilevamento:</p>
<p><em>Variabilità intra-individuale</em>: quanto potrebbe variare la risposta della stessa persona se la misurassimo in momenti diversi della giornata, o in giorni diversi? Anche quando non la osserviamo direttamente, la variabilità intra-individuale è sempre una componente latente del dato psicologico, e ci invita a riflettere sulle fonti di instabilità e fluttuazione nei comportamenti e negli stati mentali.</p>
<section id="lincertezza-come-oggetto-dellinferenza" class="level3" data-number="30.1.1"><h3 data-number="30.1.1" class="anchored" data-anchor-id="lincertezza-come-oggetto-dellinferenza">
<span class="header-section-number">30.1.1</span> L’incertezza come oggetto dell’inferenza</h3>
<p>A partire da questa variabilità, vogliamo formulare inferenze sul valore medio di un certo parametro (come l’altezza media in una popolazione). Ma ogni inferenza è anche un atto di <em>stima incerta</em>: nessun campione ci dà la verità, ma solo una gamma di possibilità più o meno plausibili.</p>
<p>In questo capitolo affronteremo quindi il problema dell’inferenza sulla media da due prospettive complementari:</p>
<ul>
<li>
<em>Approccio frequentista</em>: basato sull’idea di ripetizione del campionamento e sul calcolo di un intervallo di confidenza;</li>
<li>
<em>Approccio bayesiano</em>: che assume esplicitamente l’incertezza e la rappresenta attraverso una distribuzione di probabilità (la <em>distribuzione a posteriori</em>).</li>
</ul></section><section id="perché-usare-brms" class="level3" data-number="30.1.2"><h3 data-number="30.1.2" class="anchored" data-anchor-id="perché-usare-brms">
<span class="header-section-number">30.1.2</span> Perché usare <code>brms</code>?</h3>
<p>Invece di derivare la distribuzione a posteriori della media in modo analitico (come nei modelli con prior coniugati), useremo il pacchetto <code>brms</code>, che si basa su un potente algoritmo di campionamento chiamato <em>NUTS</em> (No-U-Turn Sampler). Questo ci permetterà di stimare numericamente l’intera distribuzione a posteriori della media e della variabilità, anche in casi in cui il calcolo analitico sarebbe difficile o impossibile. In questo modo, potremo:</p>
<ul>
<li>quantificare l’incertezza su ciò che ci interessa (ad esempio: qual è l’altezza media? con quanta certezza lo possiamo dire?);</li>
<li>visualizzare in modo intuitivo l’effetto dei dati e dei priori sulle nostre stime;</li>
<li>avvicinarci a un modo di pensare statistico più adatto alla complessità della psicologia, dove ogni dato è il risultato di molte fonti di variabilità.</li>
</ul></section></section><section id="il-modello-normale-un-primo-passo-nella-descrizione-della-variabilità" class="level2" data-number="30.2"><h2 data-number="30.2" class="anchored" data-anchor-id="il-modello-normale-un-primo-passo-nella-descrizione-della-variabilità">
<span class="header-section-number">30.2</span> Il modello Normale: un primo passo nella descrizione della variabilità</h2>
<p>Quando parliamo di altezza, ansia, tempo di reazione o qualsiasi altra variabile psicologica continua, un punto di partenza comune è il modello Normale. Questo modello assume che le osservazioni siano distribuite attorno a un valore medio, con una certa dispersione. In termini formali, diciamo che ogni osservazione <span class="math inline">\(y_n\)</span> è generata da una distribuzione Normale con media <span class="math inline">\(\mu\)</span> e deviazione standard <span class="math inline">\(\sigma\)</span>:</p>
<p><span class="math display">\[
y_n \;\sim\; \mathcal N\bigl(\mu, \sigma\bigr).
\]</span></p>
<p>Nel linguaggio dell’inferenza, <span class="math inline">\(\mu\)</span> rappresenta il valore centrale che vogliamo stimare, mentre <span class="math inline">\(\sigma\)</span> quantifica la variabilità delle osservazioni rispetto a quel centro. Entrambi i parametri sono ignoti, e l’obiettivo dell’inferenza è proprio descrivere l’incertezza che abbiamo su di essi.</p>
<p>Nel capitolo precedente abbiamo visto come calcolare la distribuzione a posteriori di questi parametri in modo analitico, quando si utilizzano prior coniugati. In questo capitolo, invece, riprendiamo lo stesso problema, ma adottiamo un approccio più generale e flessibile: stimiamo il modello usando il pacchetto <code>brms</code>, che utilizza metodi MCMC per approssimare la distribuzione a posteriori, anche quando non esistono soluzioni chiuse.</p>
</section><section id="un-esempio-concreto-la-variabilità-dellaltezza-nei-kung-san" class="level2" data-number="30.3"><h2 data-number="30.3" class="anchored" data-anchor-id="un-esempio-concreto-la-variabilità-dellaltezza-nei-kung-san">
<span class="header-section-number">30.3</span> Un esempio concreto: la variabilità dell’altezza nei !Kung San</h2>
<p>Per rendere più concreto il problema, useremo un dataset storico: i dati raccolti da Nancy Howell tra la fine degli anni ’60 presso i !Kung San, una popolazione del deserto del Kalahari con uno stile di vita basato su caccia e raccolta.</p>
<p>I dati che utilizzeremo riportano le altezze di individui adulti (con età superiore ai 18 anni). Questo esempio è tratto da <span class="citation" data-cites="McElreath_rethinking">McElreath (<a href="#ref-McElreath_rethinking" role="doc-biblioref">2020</a>)</span>, ed è ideale per iniziare a riflettere sulla <em>variabilità inter-individuale</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"Howell_18.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   height weight age male</span></span>
<span><span class="co">#&gt; 1    152   47.8  63    1</span></span>
<span><span class="co">#&gt; 2    140   36.5  63    0</span></span>
<span><span class="co">#&gt; 3    137   31.9  65    0</span></span>
<span><span class="co">#&gt; 4    157   53.0  41    1</span></span>
<span><span class="co">#&gt; 5    145   41.3  51    0</span></span>
<span><span class="co">#&gt; 6    164   63.0  35    1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il campione è composto da 352 osservazioni:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 352</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="distribuzione-osservata-dellaltezza" class="level3" data-number="30.3.1"><h3 data-number="30.3.1" class="anchored" data-anchor-id="distribuzione-osservata-dellaltezza">
<span class="header-section-number">30.3.1</span> Distribuzione osservata dell’altezza</h3>
<p>Una prima esplorazione visiva ci aiuta a capire la forma della distribuzione osservata. L’istogramma seguente mostra come si distribuiscono le altezze nel campione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Altezza"</span>, y <span class="op">=</span> <span class="st">"Frequenza"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>La forma appare compatibile con una distribuzione Normale. Ma quanto bene si adatta?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>sample <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_qq_line</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Quantili teorici"</span>, y <span class="op">=</span> <span class="st">"Valori osservati"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Il Q-Q plot mostra un leggero scostamento: la curva empirica è un po’ più piatta rispetto alla linea teorica, segno che la variabilità osservata è leggermente inferiore a quella attesa da una Normale standard (code meno pesanti). Tuttavia, la discrepanza è modesta, e possiamo comunque usare il modello gaussiano come prima approssimazione della distribuzione dei dati.</p>
</section></section><section id="specifica-del-modello-una-distribuzione-per-descrivere-lincertezza" class="level2" data-number="30.4"><h2 data-number="30.4" class="anchored" data-anchor-id="specifica-del-modello-una-distribuzione-per-descrivere-lincertezza">
<span class="header-section-number">30.4</span> Specifica del modello: una distribuzione per descrivere l’incertezza</h2>
<p>Nel modello bayesiano, ipotizziamo che ogni osservazione <span class="math inline">\(y_n\)</span> sia indipendente e identicamente distribuita (iid):</p>
<p><span class="math display">\[
y_n \sim \mathcal N(\mu, \sigma),
\]</span></p>
<ul>
<li>
<span class="math inline">\(\mu\)</span>: la media vera (ignota) della popolazione.</li>
<li>
<span class="math inline">\(\sigma\)</span>: la deviazione standard vera, che misura <em>quanta variabilità c’è tra gli individui</em>.</li>
</ul>
<blockquote class="blockquote">
<p>L’assunzione di indipendenza implica che conoscere l’errore commesso su un individuo non ci dice nulla sull’errore commesso su un altro. L’assunzione di identica distribuzione implica che tutti gli individui provengano dalla stessa popolazione.</p>
</blockquote>
<p>Scrivere <span class="math inline">\(y_n \sim \mathcal N(\mu, \sigma)\)</span> è quindi un modo compatto per dire che <em>ogni osservazione è un’espressione della variabilità inter-individuale</em>, distribuita attorno a un valore centrale.</p>
</section><section id="stime-preliminari-una-fotografia-della-variabilità" class="level2" data-number="30.5"><h2 data-number="30.5" class="anchored" data-anchor-id="stime-preliminari-una-fotografia-della-variabilità">
<span class="header-section-number">30.5</span> Stime preliminari: una fotografia della variabilità</h2>
<p>Prima di definire i priori o stimare la distribuzione a posteriori, è utile esplorare alcune statistiche descrittive:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>   <span class="co"># media campionaria</span></span>
<span><span class="co">#&gt; [1] 155</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>     <span class="co"># deviazione standard campionaria</span></span>
<span><span class="co">#&gt; [1] 7.74</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Queste due quantità ci offrono una prima “fotografia” della variabilità nel campione:</p>
<ul>
<li>La <em>media campionaria</em> è una stima iniziale di <span class="math inline">\(\mu\)</span>, che potrà guidarci nella scelta di una prior realistica.</li>
<li>La <em>deviazione standard campionaria</em> è una misura iniziale di <span class="math inline">\(\sigma\)</span>, e descrive quanto le osservazioni si discostano, in media, dalla media.</li>
</ul>
<p>Anche se queste statistiche non riflettono ancora in modo completo l’incertezza che abbiamo, sono molto utili per:</p>
<ol type="1">
<li>
<em>Guidare la scelta dei priors</em> in un’ottica informata;</li>
<li>
<em>Individuare possibili outlier o anomalie</em>, che potrebbero influenzare sia l’inferenza frequentista sia quella bayesiana.</li>
</ol></section><section id="il-modello-frequentista-stimare-la-media-come-punto-fisso" class="level2" data-number="30.6"><h2 data-number="30.6" class="anchored" data-anchor-id="il-modello-frequentista-stimare-la-media-come-punto-fisso">
<span class="header-section-number">30.6</span> Il modello frequentista: stimare la media come punto fisso</h2>
<p>Nel contesto dell’inferenza classica, uno dei modi più semplici per stimare la <em>media di una popolazione</em> consiste nell’adottare un modello lineare senza predittori: un modello che si limita a stimare un’unica quantità, chiamata <em>intercetta</em>. In pratica, questo corrisponde a stimare la <em>media campionaria</em> dei dati osservati.</p>
<p>In R, questo modello si specifica in modo molto compatto:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">height</span> <span class="op">~</span> <span class="fl">1</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Il simbolo <code>1</code> indica che vogliamo stimare solo l’intercetta, senza nessuna variabile esplicativa. In termini pratici, l’intercetta rappresenta qui la <em>media dell’altezza</em> nel campione.</p>
<section id="specifica-e-stima-del-modello" class="level3" data-number="30.6.1"><h3 data-number="30.6.1" class="anchored" data-anchor-id="specifica-e-stima-del-modello">
<span class="header-section-number">30.6.1</span> Specifica e stima del modello</h3>
<p>Possiamo stimare il modello con la funzione <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>, </span>
<span>  data <span class="op">=</span> <span class="va">df</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo comando applica il metodo della <em>minima somma dei quadrati</em>, producendo una stima puntuale della media, assieme a una misura della sua variabilità.</p>
</section><section id="interpretare-i-risultati" class="level3" data-number="30.6.2"><h3 data-number="30.6.2" class="anchored" data-anchor-id="interpretare-i-risultati">
<span class="header-section-number">30.6.2</span> Interpretare i risultati</h3>
<p>L’output del modello si ottiene con:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = height ~ 1, data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -18.072  -6.007  -0.292   6.058  24.473 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)  154.597      0.413     375   &lt;2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.74 on 351 degrees of freedom</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il riassunto mostra diverse informazioni, ma le più rilevanti in questo contesto sono:</p>
<ul>
<li>
<em>La stima dell’intercetta</em> <span class="math inline">\(\hat{\alpha}\)</span>: coincide con la media campionaria delle altezze.</li>
<li>
<em>L’errore standard</em>: misura la variabilità attesa della stima <span class="math inline">\(\hat{\alpha}\)</span> se ripetessimo il campionamento molte volte.</li>
<li>
<em>Il p-value</em>: quantifica la probabilità di osservare un valore della statistica test così estremo (o più) se la media vera fosse 0. In questo caso ha scarso interesse pratico, perché il valore di riferimento (0 cm) non è plausibile.</li>
<li>
<em>Il R²</em>: che in assenza di predittori non è interpretabile in modo utile.</li>
</ul></section><section id="intervallo-di-confidenza-al-95-una-misura-indiretta-dellincertezza" class="level3" data-number="30.6.3"><h3 data-number="30.6.3" class="anchored" data-anchor-id="intervallo-di-confidenza-al-95-una-misura-indiretta-dellincertezza">
<span class="header-section-number">30.6.3</span> Intervallo di confidenza al 95%: una misura indiretta dell’incertezza</h3>
<p>Il modello frequentista non descrive la nostra incertezza come una distribuzione su <span class="math inline">\(\mu\)</span>, ma fornisce invece un <em>intervallo di confidenza</em>, che ha un’interpretazione indiretta: se ripetessimo l’esperimento un numero molto elevato di volte, in circa il 95% dei casi l’intervallo conterrebbe il vero valore della media.</p>
<p>Possiamo calcolarlo con:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">fm1</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;             2.5 % 97.5 %</span></span>
<span><span class="co">#&gt; (Intercept)   154    155</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo intervallo si basa sulla formula classica:</p>
<p><span class="math display">\[
\hat{\alpha} \pm t_{\text{df}} \cdot \text{SE}(\hat{\alpha})
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(\hat{\alpha}\)</span> è la stima puntuale della media,</li>
<li>
<span class="math inline">\(t_{\text{df}}\)</span> è il quantile della distribuzione t di Student (con <span class="math inline">\(n - 1\)</span> gradi di libertà),</li>
<li>
<span class="math inline">\(\text{SE}(\hat{\alpha})\)</span> è l’errore standard della stima.</li>
</ul></section><section id="calcolo-manuale-opzionale" class="level3" data-number="30.6.4"><h3 data-number="30.6.4" class="anchored" data-anchor-id="calcolo-manuale-opzionale">
<span class="header-section-number">30.6.4</span> Calcolo manuale (opzionale)</h3>
<p>Se vogliamo calcolare l’intervallo “a mano”, possiamo scrivere:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.413</span></span>
<span><span class="co">#&gt; [1] 154 155</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<code>coef(fm1)</code> restituisce la stima dell’intercetta,</li>
<li>
<code>qt(0.975, df.residual(fm1))</code> fornisce il valore critico t,</li>
<li>
<code>0.413</code> è l’errore standard (da sostituire con quello esatto, se disponibile).</li>
</ul></section><section id="riflessione-cosè-lincertezza-per-davvero" class="level3" data-number="30.6.5"><h3 data-number="30.6.5" class="anchored" data-anchor-id="riflessione-cosè-lincertezza-per-davvero">
<span class="header-section-number">30.6.5</span> Riflessione: cos’è l’incertezza, per davvero?</h3>
<p>Nel modello frequentista, l’incertezza sulla media è descritta in termini di <em>variabilità potenziale tra campioni</em>, non come incertezza su un valore specifico. Il parametro <span class="math inline">\(\mu\)</span> è trattato come <em>fisso ma ignoto</em>, e tutta l’incertezza risiede nella stima che otteniamo da un singolo campione.</p>
<p>In questo senso, l’approccio frequentista <em>non fornisce una distribuzione sul parametro</em>: non possiamo dire “la probabilità che la media sia tra 153 e 155 cm è del 95%”, ma solo che “se ripetessimo l’esperimento molte volte, l’intervallo conterrebbe la media vera nel 95% dei casi”.</p>
<p>Nel prossimo paragrafo vedremo come un modello bayesiano offra un’alternativa: trattare <span class="math inline">\(\mu\)</span> come una <em>variabile aleatoria</em> su cui esprimere direttamente l’incertezza, permettendoci di formulare affermazioni probabilistiche esplicite sui valori possibili del parametro.</p>
</section></section><section id="il-modello-bayesiano-descrivere-lincertezza-con-distribuzioni" class="level2" data-number="30.7"><h2 data-number="30.7" class="anchored" data-anchor-id="il-modello-bayesiano-descrivere-lincertezza-con-distribuzioni">
<span class="header-section-number">30.7</span> Il modello Bayesiano: descrivere l’incertezza con distribuzioni</h2>
<p>Dopo aver stimato la media dell’altezza con il modello frequentista, possiamo affrontare lo stesso problema con un approccio bayesiano, usando il pacchetto <code>brms</code>. Questo ci consente di rappresentare in modo più diretto l’incertezza che abbiamo sui parametri del modello.</p>
<p>Nel framework bayesiano, tutti i parametri sono trattati come <em>variabili aleatorie</em>: invece di stimare un singolo valore per la media, stimiamo una <em>distribuzione a posteriori</em>, che riflette l’incertezza residua dopo aver osservato i dati.</p>
<section id="priori-debolmente-informativi-quando-non-sappiamo-molto" class="level3" data-number="30.7.1"><h3 data-number="30.7.1" class="anchored" data-anchor-id="priori-debolmente-informativi-quando-non-sappiamo-molto">
<span class="header-section-number">30.7.1</span> Priori debolmente informativi: quando “non sappiamo molto”</h3>
<p>Ogni modello bayesiano richiede la specifica di <em>distribuzioni a priori</em>. Tuttavia, quando non abbiamo conoscenze forti da inserire, possiamo affidarci ai <em>priori debolmente informativi</em>: distribuzioni ampie, generiche e poco vincolanti, che permettono ai dati di “parlare da soli”.</p>
<p>Se non specifichiamo nulla, <code>brms</code> userà questi prior di default. È un buon punto di partenza, soprattutto per modelli semplici e dataset abbastanza ricchi.</p>
</section><section id="specifica-del-modello-in-brms" class="level3" data-number="30.7.2"><h3 data-number="30.7.2" class="anchored" data-anchor-id="specifica-del-modello-in-brms">
<span class="header-section-number">30.7.2</span> Specifica del modello in <code>brms</code>
</h3>
<p>Il codice è simile a quello usato con <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>,       <span class="co"># stima solo l'intercetta (media dell’altezza)</span></span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,        <span class="co"># assunzione di distribuzione normale</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,                  <span class="co"># dataset</span></span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,                 <span class="co"># numero di catene MCMC</span></span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,                <span class="co"># iterazioni per catena</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>,              <span class="co"># periodo di adattamento</span></span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>        <span class="co"># motore di calcolo efficiente</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Qui stiamo stimando due parametri:</p>
<ul>
<li>
<span class="math inline">\(\mu\)</span> → media dell’altezza nella popolazione;</li>
<li>
<span class="math inline">\(\sigma\)</span> → deviazione standard, che rappresenta <em>quanta variabilità inter-individuale</em> osserviamo.</li>
</ul>
<p>In termini formali, il modello è scritto come:</p>
<p><span class="math display">\[
y_i = \alpha + \varepsilon_i,\quad \varepsilon_i \sim \mathcal{N}(0, \sigma).
\]</span></p>
</section><section id="interpretare-loutput-incertezza-esplicitata" class="level3" data-number="30.7.3"><h3 data-number="30.7.3" class="anchored" data-anchor-id="interpretare-loutput-incertezza-esplicitata">
<span class="header-section-number">30.7.3</span> Interpretare l’output: incertezza esplicitata</h3>
<p>Una volta che il modello è stato stimato, possiamo esaminarne l’output:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.60      0.40   153.79   155.38 1.00     3342     2620</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.76      0.29     7.23     8.35 1.00     3158     2486</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nel risultato troveremo:</p>
<ul>
<li>
<em>Media della distribuzione a posteriori</em> per <span class="math inline">\(\alpha\)</span>, che è la stima centrale di <span class="math inline">\(\mu\)</span>;</li>
<li>
<em>Errore standard a posteriori</em>, cioè quanto fluttua <span class="math inline">\(\mu\)</span> nei campioni simulati;</li>
<li>
<em>Intervallo di credibilità</em> al 95%: l’intervallo in cui cade il 95% della distribuzione a posteriori di <span class="math inline">\(\mu\)</span>.</li>
</ul>
<p>A differenza dell’intervallo di confidenza frequentista, qui possiamo davvero dire:</p>
<blockquote class="blockquote">
<p>C’è il 95% di probabilità che la media dell’altezza si trovi in questo intervallo, dati il modello e i dati osservati.</p>
</blockquote>
</section><section id="riportare-i-risultati-due-linguaggi-per-lo-stesso-fenomeno" class="level3" data-number="30.7.4"><h3 data-number="30.7.4" class="anchored" data-anchor-id="riportare-i-risultati-due-linguaggi-per-lo-stesso-fenomeno">
<span class="header-section-number">30.7.4</span> Riportare i risultati: due linguaggi per lo stesso fenomeno</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<thead><tr class="header">
<th>Approccio</th>
<th>Risultato</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Frequentista</td>
<td>“La media stimata è 154.6, con un intervallo di confidenza al 95% tra 153.8 e 155.4.”</td>
</tr>
<tr class="even">
<td>Bayesiano</td>
<td>“La media stimata a posteriori è 154.6, con un intervallo di credibilità al 95% tra 153.8 e 155.4.”</td>
</tr>
</tbody>
</table>
<p>Numericamente possono coincidere, ma la <em>logica inferenziale è diversa</em>: nel caso bayesiano, l’intervallo descrive ciò che crediamo plausibile; nel frequentista, ciò che la procedura catturerebbe nella maggior parte dei campioni ripetuti.</p>
</section><section id="esplorare-i-campioni-a-posteriori-guardare-lincertezza-in-faccia" class="level3" data-number="30.7.5"><h3 data-number="30.7.5" class="anchored" data-anchor-id="esplorare-i-campioni-a-posteriori-guardare-lincertezza-in-faccia">
<span class="header-section-number">30.7.5</span> Esplorare i campioni a posteriori: guardare l’incertezza in faccia</h3>
<p>Dopo aver stimato il modello, possiamo accedere direttamente ai campioni generati dall’algoritmo NUTS:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A draws_df: 3 iterations, 1 chains, and 5 variables</span></span>
<span><span class="co">#&gt;   b_Intercept sigma Intercept lprior  lp__</span></span>
<span><span class="co">#&gt; 1         155   7.6       155   -6.1 -1224</span></span>
<span><span class="co">#&gt; 2         155   7.6       155   -6.1 -1224</span></span>
<span><span class="co">#&gt; 3         155   7.6       155   -6.1 -1224</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ogni riga della colonna <code>b_Intercept</code> rappresenta un valore plausibile per <span class="math inline">\(\mu\)</span>, estratto dalla sua distribuzione a posteriori. Questi campioni sono il cuore dell’inferenza bayesiana: ci permettono di costruire grafici, intervalli e ragionamenti probabilistici.</p>
</section><section id="calcoli-riassuntivi-sui-campioni" class="level3" data-number="30.7.6"><h3 data-number="30.7.6" class="anchored" data-anchor-id="calcoli-riassuntivi-sui-campioni">
<span class="header-section-number">30.7.6</span> Calcoli riassuntivi sui campioni</h3>
<p>Possiamo usare i campioni per calcolare:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Media a posteriori</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 155</span></span>
<span></span>
<span><span class="co"># Deviazione standard a posteriori</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4</span></span>
<span></span>
<span><span class="co"># Intervallo di credibilità al 95%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span><span class="op">$</span><span class="va">b_Intercept</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  2.5% 97.5% </span></span>
<span><span class="co">#&gt;   154   155</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Questi valori sintetizzano l’incertezza associata alla nostra stima della media: non un singolo punto, ma una nuvola di possibilità, tutte compatibili con i dati osservati.</p>
</blockquote>
</section><section id="conclusioni-intermedie" class="level3" data-number="30.7.7"><h3 data-number="30.7.7" class="anchored" data-anchor-id="conclusioni-intermedie">
<span class="header-section-number">30.7.7</span> Conclusioni intermedie</h3>
<p>Abbiamo visto come:</p>
<ul>
<li>L’approccio frequentista fornisca una <em>stima puntuale</em> e un <em>intervallo ipotetico</em> di copertura.</li>
<li>L’approccio bayesiano fornisca una <em>distribuzione completa a posteriori</em>, da cui possiamo derivare medie, intervalli, probabilità e visualizzazioni.</li>
</ul>
<p>Entrambi gli approcci descrivono la <em>variabilità tra individui</em>, ma il metodo bayesiano offre strumenti più trasparenti per rappresentare l’<em>incertezza sui parametri</em>.</p>
<blockquote class="blockquote">
<p>Questo è particolarmente utile in psicologia, dove campioni ridotti, contesti variabili e differenze individuali richiedono modelli che sappiano dire “quanto (non) sappiamo”.</p>
</blockquote>
<p>Nel prossimo paragrafo vedremo come possiamo <em>personalizzare i priori</em>, incorporando informazioni pregresse (da studi precedenti, teoria, esperienza clinica…), e come questo possa influenzare l’inferenza nei casi in cui i dati da soli non siano sufficientemente informativi.</p>
</section></section><section id="uso-dei-prior-nel-modello-bayesiano-rendere-esplicite-le-ipotesi-sullincertezza" class="level2" data-number="30.8"><h2 data-number="30.8" class="anchored" data-anchor-id="uso-dei-prior-nel-modello-bayesiano-rendere-esplicite-le-ipotesi-sullincertezza">
<span class="header-section-number">30.8</span> Uso dei Prior nel Modello Bayesiano: rendere esplicite le ipotesi sull’incertezza</h2>
<p>Finora abbiamo visto che è possibile stimare un modello bayesiano anche senza specificare esplicitamente i prior: in tal caso, <code>brms</code> utilizza prior debolmente informativi, lasciando che siano i dati a guidare l’inferenza.</p>
<p>Ma il cuore dell’approccio bayesiano sta proprio qui: nella possibilità di incorporare conoscenze precedenti, aspettative, risultati di studi precedenti — insomma, di modellare in modo <em>esplicito e trasparente</em> l’incertezza che abbiamo prima di vedere i dati.</p>
<section id="tre-domande-chiave-prima-di-stimare" class="level3" data-number="30.8.1"><h3 data-number="30.8.1" class="anchored" data-anchor-id="tre-domande-chiave-prima-di-stimare">
<span class="header-section-number">30.8.1</span> Tre domande chiave prima di stimare</h3>
<p>Prima di usare un modello bayesiano, è utile porsi alcune domande fondamentali:</p>
<ul>
<li>Cosa sappiamo già del fenomeno?</li>
<li>Come possiamo esprimere questa conoscenza sotto forma di distribuzioni?</li>
<li>Quanto vogliamo che questa conoscenza influenzi l’inferenza?</li>
</ul>
<p>La risposta a queste domande guida la scelta dei prior. Nei passaggi che seguono, vedremo come un modello informato da prior realistici possa non solo migliorare la stima, ma anche <em>aumentare la coerenza tra teoria e dati</em>.</p>
</section><section id="specificare-i-prior-un-esempio-concreto" class="level3" data-number="30.8.2"><h3 data-number="30.8.2" class="anchored" data-anchor-id="specificare-i-prior-un-esempio-concreto">
<span class="header-section-number">30.8.2</span> Specificare i prior: un esempio concreto</h3>
<p>Riprendiamo il nostro esempio sull’altezza nella popolazione dei !Kung San. Supponiamo di avere un’idea ragionevole su quanto potrebbe essere la media e la variabilità delle altezze.</p>
<p>Possiamo tradurre questa conoscenza nel linguaggio delle distribuzioni:</p>
<ul>
<li><p>Per <span class="math inline">\(\mu\)</span> (la media), ipotizziamo: <span class="math inline">\(\mu \sim \mathcal{N}(181, 30)\)</span> — una media attesa intorno a 181 cm, con ampio margine di incertezza.</p></li>
<li><p>Per <span class="math inline">\(\sigma\)</span> (la deviazione standard), ipotizziamo: <span class="math inline">\(\sigma \sim \mathcal{N}^+(0, 20)\)</span> — una normale troncata a destra, che garantisce valori positivi.</p></li>
</ul>
<p>Questi prior sono <em>informativi ma ampi</em>: riflettono aspettative plausibili, senza imporre vincoli troppo rigidi.</p>
<blockquote class="blockquote">
<p>McElreath scherza dicendo di usare come prior la propria altezza. L’ironia nasconde un principio importante: <em>ogni ipotesi è valida, purché dichiarata</em>. Un buon modello bayesiano non finge oggettività, ma esplicita l’incertezza iniziale.</p>
</blockquote>
</section><section id="forma-del-modello-con-prior-espliciti" class="level3" data-number="30.8.3"><h3 data-number="30.8.3" class="anchored" data-anchor-id="forma-del-modello-con-prior-espliciti">
<span class="header-section-number">30.8.3</span> Forma del modello con prior espliciti</h3>
<p>Il modello completo si scrive così:</p>
<p><span class="math display">\[
\begin{aligned}
Y_i &amp;\sim \mathcal{N}(\mu, \sigma) \\\\
\mu &amp;\sim \mathcal{N}(181,\ 30) \\\\
\sigma &amp;\sim \mathcal{N}^+(0,\ 20)
\end{aligned}
\]</span></p>
<p>Qui, sia la media sia la variabilità della popolazione sono trattate come <em>quantità soggette a incertezza</em>. La stima diventa un aggiornamento: partiamo da un’opinione iniziale e la modifichiamo alla luce dei dati.</p>
</section><section id="implementazione-in-brms" class="level3" data-number="30.8.4"><h3 data-number="30.8.4" class="anchored" data-anchor-id="implementazione-in-brms">
<span class="header-section-number">30.8.4</span> Implementazione in <code>brms</code>
</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">height</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>  data    <span class="op">=</span> <span class="va">df</span>,</span>
<span>  family  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prior   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">181</span>, <span class="fl">30</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>    <span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains  <span class="op">=</span> <span class="fl">4</span>, iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed    <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="analisi-delloutput" class="level3" data-number="30.8.5"><h3 data-number="30.8.5" class="anchored" data-anchor-id="analisi-delloutput">
<span class="header-section-number">30.8.5</span> Analisi dell’output</h3>
<p>Una volta stimato il modello, possiamo esaminarlo come sempre con:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.60      0.41   153.80   155.41 1.00     3156     2659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.77      0.29     7.20     8.38 1.00     3256     2596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se i dati sono informativi (come in questo caso), l’effetto dei prior sarà contenuto: la distribuzione a posteriori sarà molto simile a quella ottenuta con prior deboli. Questo è un comportamento desiderabile: il prior <em>non deve forzare i risultati</em>, ma integrarsi con essi.</p>
</section><section id="scegliere-il-livello-dellintervallo-di-credibilità" class="level3" data-number="30.8.6"><h3 data-number="30.8.6" class="anchored" data-anchor-id="scegliere-il-livello-dellintervallo-di-credibilità">
<span class="header-section-number">30.8.6</span> Scegliere il livello dell’intervallo di credibilità</h3>
<p>Possiamo modificare la probabilità coperta dall’intervallo credibile, ad esempio scegliendo un <em>intervallo all’89%</em> anziché al 95%:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm3</span>, prob <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: height ~ 1 </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 352) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept   154.60      0.41   153.94   155.27 1.00     3156     2659</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-89% CI u-89% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     7.77      0.29     7.32     8.25 1.00     3256     2596</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questa scelta è proposta da McElreath come default per motivi pedagogici: evitare che l’intervallo venga interpretato come test di significatività.</p>
<blockquote class="blockquote">
<p>“Why 89%? Because it’s prime.” — è un invito a <em>pensare criticamente</em> alle convenzioni statistiche, e a riflettere su cosa stiamo cercando davvero di comunicare quando riportiamo un intervallo.</p>
</blockquote>
</section><section id="cosa-otteniamo-con-prior-espliciti" class="level3" data-number="30.8.7"><h3 data-number="30.8.7" class="anchored" data-anchor-id="cosa-otteniamo-con-prior-espliciti">
<span class="header-section-number">30.8.7</span> Cosa otteniamo con prior espliciti?</h3>
<p>Usare prior informativi consente di:</p>
<ul>
<li>Incorporare conoscenze teoriche, esperienze passate, dati precedenti.</li>
<li>Rendere il modello più robusto quando i dati sono scarsi o rumorosi.</li>
<li>Evitare stime irrealistiche in contesti con alta incertezza.</li>
<li>Esplicitare le nostre ipotesi, invece di nasconderle dietro un’apparente neutralità.</li>
</ul></section><section id="conclusione" class="level3" data-number="30.8.8"><h3 data-number="30.8.8" class="anchored" data-anchor-id="conclusione">
<span class="header-section-number">30.8.8</span> Conclusione</h3>
<p>In un modello bayesiano, ogni assunzione è chiara e trattabile. I risultati non sono semplici numeri, ma <em>distribuzioni di credibilità</em> che raccontano ciò che è plausibile, dato ciò che sapevamo prima e ciò che abbiamo osservato ora.</p>
<blockquote class="blockquote">
<p>Questo rende l’approccio bayesiano particolarmente adatto alla psicologia: un campo dove l’incertezza è la norma, la variabilità è parte del fenomeno da spiegare, e la trasparenza delle assunzioni è fondamentale.</p>
</blockquote>
<p>Nel prossimo paragrafo, ci concentreremo su come visualizzare e valutare queste distribuzioni a posteriori, usando strumenti diagnostici e grafici che ci aiutano a comprendere — e comunicare — la variabilità residua stimata dal modello.</p>
</section></section><section id="visualizzare-lincertezza-con-bayesplot" class="level2" data-number="30.9"><h2 data-number="30.9" class="anchored" data-anchor-id="visualizzare-lincertezza-con-bayesplot">
<span class="header-section-number">30.9</span> Visualizzare l’incertezza con <code>bayesplot</code>
</h2>
<p>Il pacchetto <code>bayesplot</code> è uno strumento prezioso per ogni analisi bayesiana: permette di esplorare visivamente la variabilità delle stime a posteriori, di diagnosticare l’efficienza del campionamento MCMC e di verificare se il modello riesce a riprodurre i dati osservati.</p>
<p>In un contesto psicologico, dove spesso i dati sono rumorosi e le inferenze complesse, poter visualizzare <em>dove e quanto il modello è incerto</em> è fondamentale.</p>
<section id="traceplot-osservare-le-catene-in-azione" class="level3" data-number="30.9.1"><h3 data-number="30.9.1" class="anchored" data-anchor-id="traceplot-osservare-le-catene-in-azione">
<span class="header-section-number">30.9.1</span> Traceplot: osservare le catene in azione</h3>
<p>Il traceplot mostra l’evoluzione dei campioni per ogni parametro nel corso delle iterazioni MCMC. Serve a controllare:</p>
<ul>
<li>che le catene siano <em>stazionarie</em> (nessuna deriva sistematica),</li>
<li>che si <em>mescolino bene</em> (assenza di autocorrelazione),</li>
<li>che ci sia <em>convergenza</em> (tutte le catene esplorano la stessa distribuzione).</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_trace</span><span class="op">(</span><span class="va">fm3</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"sigma"</span><span class="op">)</span>, facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Un buon traceplot mostra bande dense, senza tendenze crescenti o oscillazioni lente: questo suggerisce che il campionamento stia catturando in modo affidabile la distribuzione a posteriori.</p>
</section><section id="densità-a-posteriori-cosa-crediamo-dopo-aver-visto-i-dati" class="level3" data-number="30.9.2"><h3 data-number="30.9.2" class="anchored" data-anchor-id="densità-a-posteriori-cosa-crediamo-dopo-aver-visto-i-dati">
<span class="header-section-number">30.9.2</span> Densità a posteriori: cosa crediamo dopo aver visto i dati</h3>
<p>Per visualizzare la distribuzione di probabilità di un parametro stimato, possiamo usare:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">fm3</span>, regex_pars <span class="op">=</span> <span class="st">"b_Intercept"</span>, prob <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questa funzione evidenzia l’<em>intervallo credibile</em> in cui cade, ad esempio, l’89% della densità a posteriori per la media dell’altezza.</p>
<blockquote class="blockquote">
<p>A differenza dell’intervallo di confidenza, qui possiamo davvero dire che <em>c’è l’89% di probabilità che la media vera sia compresa in quell’intervallo</em>.</p>
</blockquote>
</section><section id="distribuzione-congiunta-di-due-parametri-incrociare-incertezze" class="level3" data-number="30.9.3"><h3 data-number="30.9.3" class="anchored" data-anchor-id="distribuzione-congiunta-di-due-parametri-incrociare-incertezze">
<span class="header-section-number">30.9.3</span> Distribuzione congiunta di due parametri: incrociare incertezze</h3>
<p>Quando vogliamo esplorare la relazione tra due parametri (ad esempio, media e deviazione standard), possiamo usare:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_scatter</span><span class="op">(</span><span class="va">fm3</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questo tipo di visualizzazione è utile per valutare <em>dipendenze tra parametri</em>: ad esempio, se i campioni sono inclinati lungo una diagonale, significa che c’è correlazione a posteriori tra i due.</p>
</section><section id="posterior-predictive-check-il-modello-spiega-davvero-i-dati" class="level3" data-number="30.9.4"><h3 data-number="30.9.4" class="anchored" data-anchor-id="posterior-predictive-check-il-modello-spiega-davvero-i-dati">
<span class="header-section-number">30.9.4</span> Posterior Predictive Check: il modello spiega davvero i dati?</h3>
<p>Una delle forze dell’approccio bayesiano è che i modelli sono <em>generativi</em>: possiamo simulare nuovi dati partendo dalle distribuzioni a posteriori e confrontarli con quelli osservati.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>La funzione <code><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check()</a></code> mostra:</p>
<ul>
<li>in nero: la distribuzione dei dati osservati,</li>
<li>in colore: più repliche simulate dal modello.</li>
</ul>
<p>Se le simulazioni coprono bene i dati reali, il modello è coerente con le osservazioni. Se invece ci sono <em>scostamenti sistematici</em>, questo può indicare che:</p>
<ul>
<li>la distribuzione scelta non è adatta,</li>
<li>ci sono outlier non gestiti,</li>
<li>mancano variabili esplicative nel modello.</li>
</ul></section></section><section id="lapproccio-tradizionale-il-test-t-di-student" class="level2" data-number="30.10"><h2 data-number="30.10" class="anchored" data-anchor-id="lapproccio-tradizionale-il-test-t-di-student">
<span class="header-section-number">30.10</span> L’approccio tradizionale: il test t di Student</h2>
<p>Prima dell’adozione diffusa dei metodi bayesiani, l’inferenza sulla media veniva solitamente effettuata con il <em>test t</em>. Questo approccio assume che la variabilità osservata nel campione (stimata con la deviazione standard campionaria) sia sufficiente a rappresentare l’incertezza sul parametro d’interesse.</p>
<p>Il calcolo si basa sulla statistica:</p>
<p><span class="math display">\[
T = \frac{\bar{X} - \mu_0}{s / \sqrt{n}}.
\]</span></p>
<p>Il test permette di costruire un intervallo di confidenza, ma non di fare affermazioni probabilistiche sui parametri. Il valore <span class="math inline">\(\mu\)</span> è considerato fisso ma sconosciuto, e l’incertezza è attribuita unicamente al <em>campionamento</em>.</p>
</section><section id="confronto-tra-approcci-stesso-dato-epistemologie-diverse" class="level2" data-number="30.11"><h2 data-number="30.11" class="anchored" data-anchor-id="confronto-tra-approcci-stesso-dato-epistemologie-diverse">
<span class="header-section-number">30.11</span> Confronto tra approcci: stesso dato, epistemologie diverse</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 35%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th>Elemento</th>
<th>Frequentista</th>
<th>Bayesiano</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Concetto di parametro</td>
<td>Fisso ma ignoto</td>
<td>Variabile aleatoria</td>
</tr>
<tr class="even">
<td>Incertezza</td>
<td>Tra campioni</td>
<td>Nei parametri</td>
</tr>
<tr class="odd">
<td>Intervallo (95%)</td>
<td>Procedura che copre nel 95% dei casi</td>
<td>Credibilità del 95% sul valore vero</td>
</tr>
<tr class="even">
<td>Estensione a modelli complessi</td>
<td>Limitata</td>
<td>Flessibile</td>
</tr>
<tr class="odd">
<td>Trasparenza delle assunzioni</td>
<td>Implicita</td>
<td>Esplicita</td>
</tr>
</tbody>
</table></section><section id="replicare-lanalisi-con-cmdstanr" class="level2" data-number="30.12"><h2 data-number="30.12" class="anchored" data-anchor-id="replicare-lanalisi-con-cmdstanr">
<span class="header-section-number">30.12</span> Replicare l’analisi con <code>cmdstanr</code>
</h2>
<p>Ora replichiamo con <em>cmdstanr</em> (Stan esplicito) l’analisi ottenuta con <code>brm</code> e salvata nell’oggetto <code>fm3</code>.</p>
<p>Il modello è:</p>
<p><span class="math display">\[
y_i \sim \mathrm{Normal}(\mu,\sigma), \qquad
\mu \sim \mathcal{N}(181, 30), \qquad
\sigma \sim \mathcal{N}^+(0, 20),
\]</span></p>
<p>dove <span class="math inline">\(\mathcal{N}^+\)</span> indica la normale troncata ai valori positivi.</p>
<p>Il modello Stan equivalente è</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stancode</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=1&gt; N;</span></span>
<span><span class="st">  vector[N] y;</span></span>
<span><span class="st">}</span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  real mu;</span></span>
<span><span class="st">  real&lt;lower=0&gt; sigma;</span></span>
<span><span class="st">}</span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  // Priors equivalenti a brms:</span></span>
<span><span class="st">  mu    ~ normal(181, 30);</span></span>
<span><span class="st">  sigma ~ normal(0, 20); // con &lt;lower=0&gt; diventa automaticamente Half-Normal(0,20)</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Likelihood</span></span>
<span><span class="st">  y ~ normal(mu, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">generated quantities {</span></span>
<span><span class="st">  vector[N] y_rep;</span></span>
<span><span class="st">  for (n in 1:N) y_rep[n] = normal_rng(mu, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compiliamo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_file</span> <span class="op">&lt;-</span> <span class="fu">write_stan_file</span><span class="op">(</span><span class="va">stancode</span>, dir <span class="op">=</span> <span class="st">"stan"</span>, basename <span class="op">=</span> <span class="st">"one_mean_fm3.stan"</span><span class="op">)</span></span>
<span><span class="va">mod</span>       <span class="op">&lt;-</span> <span class="fu">cmdstan_model</span><span class="op">(</span><span class="va">stan_file</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Prepariamo i dati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">stan_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 2</span></span>
<span><span class="co">#&gt;  $ N: int 352</span></span>
<span><span class="co">#&gt;  $ y: num [1:352] 152 140 137 157 145 ...</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguiamo il campionamento:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_stan</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, </span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">4000</span>, </span>
<span>  parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo i risultati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_stan</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mu"</span>,<span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span><span class="co">#&gt;   variable    mean  median    sd   mad      q5     q95  rhat  ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 mu       154.601 154.602 0.413 0.406 153.918 155.285 1.000 10185.459 8086.662</span></span>
<span><span class="co">#&gt; 2 sigma      7.767   7.757 0.290 0.288   7.303   8.259 1.000 10043.384 8612.693</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="confronto-delle-posterior-brms-vs-stan" class="level3" data-number="30.12.1"><h3 data-number="30.12.1" class="anchored" data-anchor-id="confronto-delle-posterior-brms-vs-stan">
<span class="header-section-number">30.12.1</span> Confronto delle posterior (<em>brms</em> vs <em>Stan</em>)</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws_brm</span>  <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">transmute</span><span class="op">(</span>mu <span class="op">=</span> <span class="va">b_Intercept</span>, sigma <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="va">draws_stan</span> <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">fit_stan</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mu"</span>,<span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summ_brm</span>  <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws_brm</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>modello <span class="op">=</span> <span class="st">"brms"</span><span class="op">)</span></span>
<span><span class="va">summ_stan</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws_stan</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span>modello <span class="op">=</span> <span class="st">"stan"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">summ_brm</span>, <span class="va">summ_stan</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">modello</span>, <span class="va">variable</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">q5</span>, <span class="va">q95</span>, <span class="va">rhat</span>, <span class="va">ess_bulk</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">modello</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 8</span></span>
<span><span class="co">#&gt;   modello variable    mean    sd      q5     q95  rhat  ess_bulk</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 brms    mu       154.603 0.414 153.924 155.281 1.000  3150.751</span></span>
<span><span class="co">#&gt; 2 stan    mu       154.601 0.413 153.918 155.285 1.000 10185.459</span></span>
<span><span class="co">#&gt; 3 brms    sigma      7.771 0.294   7.305   8.264 1.000  3220.370</span></span>
<span><span class="co">#&gt; 4 stan    sigma      7.767 0.290   7.303   8.259 1.000 10043.384</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="visualizzazione-delle-densità-posteriori" class="level3" data-number="30.12.2"><h3 data-number="30.12.2" class="anchored" data-anchor-id="visualizzazione-delle-densità-posteriori">
<span class="header-section-number">30.12.2</span> Visualizzazione delle densità posteriori</h3>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/plot-fm3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Se le aree colorate e le linee dei due modelli si sovrappongono quasi perfettamente in ciascun pannello, le <em>posterior</em> coincidono entro il rumore Monte Carlo.</p>
</section><section id="posterior-predictive-check" class="level3" data-number="30.12.3"><h3 data-number="30.12.3" class="anchored" data-anchor-id="posterior-predictive-check">
<span class="header-section-number">30.12.3</span> Posterior predictive check</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws_yrep</span> <span class="op">&lt;-</span> <span class="va">fit_stan</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"y_rep"</span><span class="op">)</span></span>
<span><span class="va">arr</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_array.html">as_draws_array</a></span><span class="op">(</span><span class="va">draws_yrep</span><span class="op">)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="va">yrep_df</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="va">arr</span>, nrow <span class="op">=</span> <span class="va">M</span>, ncol <span class="op">=</span> <span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obs_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="va">yrep_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">yrep_df</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ppc_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="va">yrep_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">base_col</span>  <span class="op">&lt;-</span> <span class="st">"#56B4E9"</span></span>
<span><span class="va">line_col</span>  <span class="op">&lt;-</span> <span class="st">"#D55E00"</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ppc_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">stat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">50</span>, color <span class="op">=</span> <span class="st">"white"</span>, fill <span class="op">=</span> <span class="va">base_col</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">obs_mean</span>, color <span class="op">=</span> <span class="va">line_col</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Media(y_rep)"</span>, y <span class="op">=</span> <span class="st">"Densità"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="07_one_mean_files/figure-html/ppc-fm3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="nota-sulle-prior" class="level3" data-number="30.12.4"><h3 data-number="30.12.4" class="anchored" data-anchor-id="nota-sulle-prior">
<span class="header-section-number">30.12.4</span> Nota sulle prior</h3>
<p>Con il vincolo <span class="math inline">\(\sigma&gt;0\)</span> in Stan, la specifica <code>sigma ~ normal(0, 20);</code> implementa automaticamente una <em>Half-Normal</em> con scala 20, coerente con <code>prior(normal(0, 20), class = "sigma")</code> in <code>brms</code>. Questa equivalenza assicura che i risultati dei due approcci coincidano entro l’errore Monte Carlo, a parità di dati e impostazioni MCMC.</p>
</section></section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>In questo capitolo abbiamo riformulato un problema classico — la stima della media di una popolazione — nella prospettiva bayesiana. Abbiamo visto che ciò che otteniamo non è un singolo numero, ma una <em>distribuzione a posteriori</em> che descrive in modo esplicito le nostre credenze aggiornate sul parametro. Questa distribuzione ci dice quanto sono plausibili diversi valori della media, integrando insieme l’informazione a priori e i dati osservati.</p>
<p>Il passaggio dall’approccio frequentista a quello bayesiano segna un cambiamento concettuale profondo. Non ci limitiamo più a calcolare un intervallo di confidenza o a verificare un’ipotesi nulla, ma costruiamo una rappresentazione diretta dell’incertezza sui parametri che ci interessano. In questo modo, l’inferenza diventa non solo più intuitiva, ma anche più trasparente e coerente con il modo in cui gli psicologi ragionano sui fenomeni: sempre con un certo margine di dubbio, ma anche con la possibilità di pesare scenari alternativi.</p>
<p>Naturalmente, la stima di una media è solo il punto di partenza. Nella ricerca psicologica siamo spesso interessati a <em>confrontare due gruppi</em>, per capire se una popolazione differisce da un’altra, e se sì di quanto. Nei prossimi capitoli vedremo come estendere il ragionamento bayesiano a questi casi, collegando la stima della media al confronto tra condizioni sperimentali e alla valutazione della <em>grandezza dell’effetto</em>.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><em>Obiettivo:</em> Utilizzare i dati dello studio di <span class="citation" data-cites="tarrats2025efficacy">Tarrats-Pons et al. (<a href="#ref-tarrats2025efficacy" role="doc-biblioref">2025</a>)</span> per replicare i risultati riportati nella Figura 2 , applicando sia l’approccio frequentista che il framework bayesiano. Calcolare inoltre la grandezza dell’effetto nel contesto bayesiano (Cohen’s <span class="math inline">\(d\)</span>) e generare un grafico che visualizzi la distribuzione a posteriori della grandezza dell’effetto ottenuta.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/">posterior</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/bayestestR/">bayestestR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span></span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span></span>
<span>    <span class="st">"data"</span>,</span>
<span>    <span class="st">"Tarrats-Pons.xlsx"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Sample</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span></span>
<span>    avg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">`CESS-D`</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">df_wide</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">IdentificationNumber</span>, <span class="va">Sample</span>, CESS_D <span class="op">=</span> <span class="va">`CESS-D`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">Sample</span>, <span class="co"># da POST/PRE</span></span>
<span>    values_from <span class="op">=</span> <span class="va">CESS_D</span>, <span class="co"># i valori da mettere nelle colonne</span></span>
<span>    names_prefix <span class="op">=</span> <span class="st">"CESSD_"</span> <span class="co"># opzionale, per nominare CESSD_POST, CESSD_PRE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Controlla il risultato</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">df_wide</span><span class="op">$</span><span class="va">CESSD_PRE</span> <span class="op">-</span> <span class="va">df_wide</span><span class="op">$</span><span class="va">CESSD_POST</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># t-test sulle differenze</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Numero di soggetti</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">df_wide</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo di Cohen's d</span></span>
<span><span class="va">d_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mostro risultato</span></span>
<span><span class="va">d_t</span></span>
<span></span>
<span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># Modello con sola intercetta (mu)</span></span>
<span>  data <span class="op">=</span> <span class="va">df_wide</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># Distribuzione Normale</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>, <span class="co"># Prior su mu</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="co"># Prior su sigma</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">diff</span> <span class="op">~</span> <span class="fl">1</span>, <span class="co"># Modello con sola intercetta (mu)</span></span>
<span>  data <span class="op">=</span> <span class="va">df_wide</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html">student</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># Distribuzione Normale</span></span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>, <span class="co"># Prior su mu</span></span>
<span>    <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span> <span class="co"># Prior su sigma</span></span>
<span>  <span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_samples</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="va">post_samples</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">/</span> <span class="va">post_samples</span><span class="op">$</span><span class="va">sigma</span></span>
<span></span>
<span><span class="co"># Calcolo diretto delle statistiche dell'effect size</span></span>
<span><span class="va">mean_effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span><span class="op">)</span></span>
<span><span class="va">sd_effect_size</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span><span class="op">)</span></span>
<span><span class="va">ci_effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stampa dei risultati</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"=== Statistiche dell'Effect Size Bayesiano ===\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Effect size medio:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mean_effect_size</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"SD dell'effect size:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sd_effect_size</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Intervallo di credibilità al 95%:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"-"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"\n\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Interpretazione dell'effect size secondo le convenzioni di Cohen</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"piccolo"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"medio-piccolo"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">mean_effect_size</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"medio"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">interpretation</span> <span class="op">&lt;-</span> <span class="st">"grande"</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Interpretazione (Cohen):"</span>, <span class="va">interpretation</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcola la probabilità che l'effect size sia maggiore di zero</span></span>
<span><span class="va">prob_positive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia positivo:"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_positive</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Se necessario, calcola probabilità per altre soglie</span></span>
<span><span class="va">prob_medium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia &gt; 0.5 (medio):"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_medium</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">prob_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">post_samples</span><span class="op">$</span><span class="va">effect_size</span> <span class="op">&gt;</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Probabilità che l'effect size sia &gt; 0.8 (grande):"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_large</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="st">"%\n"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualizzazione della distribuzione posteriore dell'effect size</span></span>
<span><span class="co"># (Per eseguire questo blocco, devi avere ggplot2 installato e caricato)</span></span>
<span><span class="co"># library(ggplot2)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">post_samples</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">effect_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"skyblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">mean_effect_size</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">ci_effect_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dotted"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Effect Size (Cohen's d)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] readxl_1.4.5          lubridate_1.9.4       forcats_1.0.0        </span></span>
<span><span class="co">#&gt;  [4] stringr_1.5.1         purrr_1.1.0           readr_2.1.5          </span></span>
<span><span class="co">#&gt;  [7] tidyverse_2.0.0       bayestestR_0.17.0     cmdstanr_0.9.0       </span></span>
<span><span class="co">#&gt; [10] pillar_1.11.0         tinytable_0.13.0      patchwork_1.3.2      </span></span>
<span><span class="co">#&gt; [13] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.14.0     </span></span>
<span><span class="co">#&gt; [16] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.1     </span></span>
<span><span class="co">#&gt; [19] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         </span></span>
<span><span class="co">#&gt; [22] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           </span></span>
<span><span class="co">#&gt; [25] sessioninfo_1.2.3     conflicted_1.2.0      janitor_2.2.1        </span></span>
<span><span class="co">#&gt; [28] matrixStats_1.5.0     modelr_0.1.11         tibble_3.3.0         </span></span>
<span><span class="co">#&gt; [31] dplyr_1.1.4           tidyr_1.3.1           rio_1.2.3            </span></span>
<span><span class="co">#&gt; [34] here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] RColorBrewer_1.1-3    tensorA_0.36.2.1      jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt;  [4] magrittr_2.0.3        TH.data_1.1-4         estimability_1.5.1   </span></span>
<span><span class="co">#&gt;  [7] farver_2.1.2          rmarkdown_2.29        ragg_1.5.0           </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5           memoise_2.0.1         htmltools_0.5.8.1    </span></span>
<span><span class="co">#&gt; [13] distributional_0.5.0  curl_7.0.0            broom_1.0.9          </span></span>
<span><span class="co">#&gt; [16] cellranger_1.1.0      htmlwidgets_1.6.4     plyr_1.8.9           </span></span>
<span><span class="co">#&gt; [19] sandwich_3.1-1        emmeans_1.11.2-8      zoo_1.8-14           </span></span>
<span><span class="co">#&gt; [22] cachem_1.1.0          lifecycle_1.0.4       pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt; [25] Matrix_1.7-4          R6_2.6.1              fastmap_1.2.0        </span></span>
<span><span class="co">#&gt; [28] snakecase_0.11.1      digest_0.6.37         colorspace_2.1-1     </span></span>
<span><span class="co">#&gt; [31] ps_1.9.1              rprojroot_2.1.1       textshaping_1.0.3    </span></span>
<span><span class="co">#&gt; [34] labeling_0.4.3        timechange_0.3.0      abind_1.4-8          </span></span>
<span><span class="co">#&gt; [37] compiler_4.5.1        withr_3.0.2           backports_1.5.0      </span></span>
<span><span class="co">#&gt; [40] inline_0.3.21         QuickJSR_1.8.0        pkgbuild_1.4.8       </span></span>
<span><span class="co">#&gt; [43] R.utils_2.13.0        MASS_7.3-65           tools_4.5.1          </span></span>
<span><span class="co">#&gt; [46] R.oo_1.27.1           glue_1.8.0            nlme_3.1-168         </span></span>
<span><span class="co">#&gt; [49] grid_4.5.1            checkmate_2.3.3       reshape2_1.4.4       </span></span>
<span><span class="co">#&gt; [52] generics_0.1.4        gtable_0.3.6          tzdb_0.5.0           </span></span>
<span><span class="co">#&gt; [55] R.methodsS3_1.8.2     data.table_1.17.8     hms_1.1.3            </span></span>
<span><span class="co">#&gt; [58] utf8_1.2.6            splines_4.5.1         lattice_0.22-7       </span></span>
<span><span class="co">#&gt; [61] survival_3.8-3        tidyselect_1.2.1      knitr_1.50           </span></span>
<span><span class="co">#&gt; [64] arrayhelpers_1.1-0    gridExtra_2.3         V8_7.0.0             </span></span>
<span><span class="co">#&gt; [67] stats4_4.5.1          xfun_0.53             bridgesampling_1.1-2 </span></span>
<span><span class="co">#&gt; [70] stringi_1.8.7         yaml_2.3.10           pacman_0.5.1         </span></span>
<span><span class="co">#&gt; [73] evaluate_1.0.5        codetools_0.2-20      cli_3.6.5            </span></span>
<span><span class="co">#&gt; [76] RcppParallel_5.1.11-1 xtable_1.8-4          systemfonts_1.2.3    </span></span>
<span><span class="co">#&gt; [79] processx_3.8.6        coda_0.19-4.1         svUnit_1.0.8         </span></span>
<span><span class="co">#&gt; [82] parallel_4.5.1        rstantools_2.5.0      Brobdingnag_1.2-9    </span></span>
<span><span class="co">#&gt; [85] mvtnorm_1.3-3         scales_1.4.0          ggridges_0.5.7       </span></span>
<span><span class="co">#&gt; [88] insight_1.4.2         rlang_1.1.6           multcomp_1.4-28</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-McElreath_rethinking" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: <span>A</span> <span>Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (2nd Edition). CRC Press.
</div>
<div id="ref-tarrats2025efficacy" class="csl-entry" role="listitem">
Tarrats-Pons, E., Mussons-Torras, M., &amp; Jiménez-Pérez, Y. (2025). Efficacy of a Positive Psychology Intervention in Enhancing Optimism and Reducing Depression Among University Students: A Quasi-Experimental Study. <em>Behavioral Sciences</em>, <em>15</em>(5), 571.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/linear_models/06_specification_error.html" class="pagination-link" aria-label="Errore di specificazione e bias da variabile omessa">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/linear_models/08_two_means.html" class="pagination-link" aria-label="Confronto tra le medie di due gruppi">
        <span class="nav-page-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/07_one_mean.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>