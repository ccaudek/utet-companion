<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>27&nbsp; Zucchero sintattico – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/linear_models/05_stan_regression.html" rel="next">
<link href="../../chapters/linear_models/03_reglin_bayes.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_sec.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#interfaccia-brms" id="toc-interfaccia-brms" class="nav-link active" data-scroll-target="#interfaccia-brms"><span class="header-section-number">27.1</span> Interfaccia <code>brms</code></a></li>
  <li><a href="#due-tipi-di-incertezza-nei-modelli-bayesiani" id="toc-due-tipi-di-incertezza-nei-modelli-bayesiani" class="nav-link" data-scroll-target="#due-tipi-di-incertezza-nei-modelli-bayesiani"><span class="header-section-number">27.2</span> Due tipi di incertezza nei modelli bayesiani</a></li>
  <li><a href="#distribuzione-a-posteriori-dei-parametri" id="toc-distribuzione-a-posteriori-dei-parametri" class="nav-link" data-scroll-target="#distribuzione-a-posteriori-dei-parametri"><span class="header-section-number">27.3</span> Distribuzione a posteriori dei parametri</a></li>
  <li><a href="#specificare-i-priors" id="toc-specificare-i-priors" class="nav-link" data-scroll-target="#specificare-i-priors"><span class="header-section-number">27.4</span> Specificare i priors</a></li>
  <li><a href="#predizioni-a-posteriori-posterior-predictive-checks" id="toc-predizioni-a-posteriori-posterior-predictive-checks" class="nav-link" data-scroll-target="#predizioni-a-posteriori-posterior-predictive-checks"><span class="header-section-number">27.5</span> Predizioni a posteriori (<em>Posterior Predictive Checks</em>)</a></li>
  <li><a href="#regressione-robusta" id="toc-regressione-robusta" class="nav-link" data-scroll-target="#regressione-robusta"><span class="header-section-number">27.6</span> Regressione robusta</a></li>
  <li><a href="#indice-di-determinazione-bayesiano" id="toc-indice-di-determinazione-bayesiano" class="nav-link" data-scroll-target="#indice-di-determinazione-bayesiano"><span class="header-section-number">27.7</span> Indice di determinazione bayesiano</a></li>
  <li><a href="#approfondimento-manipolare-la-distribuzione-a-posteriori-con-brms" id="toc-approfondimento-manipolare-la-distribuzione-a-posteriori-con-brms" class="nav-link" data-scroll-target="#approfondimento-manipolare-la-distribuzione-a-posteriori-con-brms"><span class="header-section-number">27.8</span> Approfondimento: manipolare la distribuzione a posteriori con <code>brms</code></a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/04_synt_sugar_sea_ice.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/linear_models/introduction_sec.html">Regressione</a></li><li class="breadcrumb-item"><a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-linar-models-brms" class="quarto-section-identifier"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>Nel capitolo precedente abbiamo visto come formulare e stimare un modello bayesiano di regressione lineare bivariata utilizzando distribuzioni a priori semplici. Questo esercizio ci ha permesso di cogliere l’essenza dell’approccio: i parametri della retta di regressione non sono valori fissi, ma quantità descritte da distribuzioni di probabilità aggiornate alla luce dei dati.</p>
<p>Tuttavia, la scrittura esplicita di ogni dettaglio del modello può diventare rapidamente ingombrante, soprattutto quando si lavora con più predittori o con modelli più complessi. Per rendere l’analisi più agevole, possiamo introdurre alcune notazioni e funzioni che alleggeriscono il codice senza modificarne il significato statistico.</p>
<p>In questo capitolo presenteremo quindi quello che potremmo chiamare <em>“zucchero sintattico”</em>: strumenti che rendono la specificazione dei modelli in R più compatta e leggibile, pur mantenendo intatta la logica bayesiana sottostante. Sarà un passaggio intermedio utile, che ci permetterà di concentrarci sugli aspetti concettuali della modellazione senza appesantirci con dettagli tecnici ripetitivi. Nei capitoli successivi, quando introdurremo Stan, vedremo come questa stessa esigenza di sintesi e chiarezza diventi ancora più cruciale.</p>
<section id="panoramica-del-capitolo" class="level3 unnumbered unlisted"><h3 class="unnumbered unlisted anchored" data-anchor-id="panoramica-del-capitolo">Panoramica del capitolo</h3>
<ul>
<li>Costruire e adattare modelli lineari con la funzione <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>.</li>
<li>Interpretare i risultati e confrontarli con quelli ottenuti da un approccio frequentista.</li>
<li>Visualizzare le relazioni stimate e distinguere tra intervalli di credibilità e di predizione.</li>
<li>Specificare priors personalizzati e valutare l’impatto sui risultati.</li>
<li>Eseguire verifiche predittive a posteriori (<em>posterior predictive checks</em>).</li>
<li>Gestire la presenza di outlier tramite la regressione robusta.</li>
<li>Calcolare e interpretare l’indice di determinazione bayesiano (<em>Bayes R²</em>).</li>
<li>Accedere e manipolare la distribuzione a posteriori dei parametri.</li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Leggere <em>Navigating the Bayes maze: The psychologist’s guide to Bayesian statistics, a hands-on tutorial with R code</em> <span class="citation" data-cites="alter2025navigating">(<a href="#ref-alter2025navigating" role="doc-biblioref">Alter et al., 2025</a>)</span>.</li>
<li>Consultare <a href="https://paulbuerkner.com/software/brms-book/brms-book.pdf">The brms Book: Applied Bayesian Regression Modelling Using R and Stan</a>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">brms</span>, <span class="va">posterior</span>, <span class="va">cmdstanr</span>, <span class="va">tidybayes</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="interfaccia-brms" class="level2" data-number="27.1"><h2 data-number="27.1" class="anchored" data-anchor-id="interfaccia-brms">
<span class="header-section-number">27.1</span> Interfaccia <code>brms</code>
</h2>
<p>Come esempio, utilizzeremo un dataset che ci consente di stimare un modello lineare molto semplice. Il <a href="https://nsidc.org/home">National Snow and Ice Data Center</a> mette a disposizione numerosi dati pubblici, scaricabili ed esplorabili liberamente. Uno degli effetti più evidenti del cambiamento climatico riguarda la progressiva riduzione dell’estensione dei ghiacci marini nell’emisfero settentrionale. Qui analizzeremo come questa estensione è variata nel tempo.</p>
<p>La progressiva scomparsa di un elemento così iconico del nostro pianeta non è solo un dato fisico; agisce come un potente <em>segnale psicologico</em>. La percezione di perdite ambientali tangibili e su larga scala è un fattore chiave nel fenomeno dell’<em>ansia climatica</em> (<em>climate anxiety</em>), quella preoccupazione cronica e angoscia per gli impatti presenti e futuri del cambiamento climatico <span class="citation" data-cites="clayton2020climate">(<a href="#ref-clayton2020climate" role="doc-biblioref">Clayton, 2020</a>)</span>.</p>
<p>Visualizzare un trend discendente così chiaro, come quello che emergerà dalla nostra analisi, fornisce un contesto cruciale. Non si tratta di un’astratta previsione futura, ma della documentazione di una trasformazione in atto che sta già alterando ecosistemi, economie e, non da ultimo, il nostro benessere psicologico collettivo (<a href="https://www.apa.org/news/press/releases/2017/03/mental-health-climate.pdf">APA, 2017</a>). L’analisi dei dati diventa così uno strumento per comprendere e comunicare una delle fonti dello stress ambientale contemporaneo.</p>
<p>I dati contenuti nel file <code>N_08_extent_v4.0.csv</code> riguardano le osservazioni del mese di agosto dal 1979 al 2024 e riportano i valori di <code>extent</code>. Con questo termine si indica la superficie marina totale in cui la concentrazione di ghiaccio è almeno del 15%. L’<em>extent</em> è considerato l’indicatore più robusto per monitorare le tendenze climatiche di lungo periodo, poiché risente meno delle fluttuazioni giornaliere dovute al vento (che può comprimere o disperdere il ghiaccio, modificandone la concentrazione ma non la sua estensione complessiva). Per questo motivo, quando si parla di “minimo storico dei ghiacci artici”, il riferimento è quasi sempre al valore di <em>extent</em>. La variabile <code>extent</code> è espressa in milioni di chilometri quadrati (ad esempio, 8.04 = 8.040.000 km²).</p>
<p>Carichiamo i dati e diamo un’occhiata alle prime righe:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"N_08_extent_v4.0.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year mo source_dataset region extent area</span></span>
<span><span class="co">#&gt; 1 1979  8     NSIDC-0051      N   8.04 5.06</span></span>
<span><span class="co">#&gt; 2 1980  8     NSIDC-0051      N   7.98 4.94</span></span>
<span><span class="co">#&gt; 3 1981  8     NSIDC-0051      N   7.84 4.48</span></span>
<span><span class="co">#&gt; 4 1982  8     NSIDC-0051      N   8.14 5.00</span></span>
<span><span class="co">#&gt; 5 1983  8     NSIDC-0051      N   8.19 4.97</span></span>
<span><span class="co">#&gt; 6 1984  8     NSIDC-0051      N   7.77 4.68</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizziamo ora la relazione tra <code>extent</code> e <code>year</code> con un diagramma a dispersione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">extent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Anno"</span>, y <span class="op">=</span> <span class="st">"Estensione (milioni km²)"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Il pacchetto <code>brms</code> si concentra sui <em>modelli di regressione</em>. Questa specializzazione consente di adottare una sintassi semplice e compatta, detta <em>sintassi di Wilkinson</em> <span class="citation" data-cites="wilkinson1973symbolic">(<a href="#ref-wilkinson1973symbolic" role="doc-biblioref">Wilkinson &amp; Rogers, 1973</a>)</span>.</p>
<p>Per esempio, il modello lineare</p>
<p><span class="math display">\[
y = \alpha + \beta x + \varepsilon
\]</span> può essere scritto in <code>brms</code> nel modo seguente:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ <span class="dv">1</span> <span class="sc">+</span> year, <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Nella sintassi di Wilkinson:</p>
<ul>
<li>il simbolo <code>~</code> separa la variabile dipendente (a sinistra) dalle variabili indipendenti (a destra);</li>
<li>
<code>1</code> rappresenta l’intercetta, che in realtà è inclusa di default.</li>
</ul>
<p>Quindi il modello precedente può essere scritto in maniera equivalente come:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ year, <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Se desideriamo <em>escludere l’intercetta</em> dal modello, possiamo farlo così:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>no_intercept_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ <span class="dv">0</span> <span class="sc">+</span> year, <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>oppure:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>no_intercept_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> year, <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Per aggiungere altre variabili indipendenti, basta estendere la formula:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ year <span class="sc">+</span> z, <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>brms</code> permette anche di stimare <em>modelli gerarchici (a effetti misti)</em>. Ad esempio, se avessimo osservazioni raggruppate per area geografica <code>g</code> e volessimo stimare un effetto di <code>year</code> che varia da un gruppo all’altro, potremmo scrivere:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model_h <span class="ot">&lt;-</span> <span class="fu">brm</span>(extent ∼ year <span class="sc">+</span> z <span class="sc">+</span> (year <span class="sc">|</span> g), <span class="at">data =</span> df)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>È importante sottolineare che la sintassi di Wilkinson <em>non specifica le distribuzioni a priori</em>, ma soltanto come le variabili sono collegate tra loro. In assenza di istruzioni esplicite, <code>brms</code> assegna automaticamente delle <em>prior debolmente informative</em>, che permettono di stimare comunque il modello senza ulteriori interventi. Tuttavia, se desideriamo avere un controllo più preciso, possiamo definire manualmente le prior, come vedremo nelle sezioni successive.</p>
<section id="centrare-le-variabili" class="level3" data-number="27.1.1"><h3 data-number="27.1.1" class="anchored" data-anchor-id="centrare-le-variabili">
<span class="header-section-number">27.1.1</span> Centrare le variabili</h3>
<p>Per interpretare più facilmente <em>l’intercetta</em>, centriamo la variabile <code>year</code> rispetto alla sua media nel campione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">year_c</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">year</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In questo modo, <em>l’intercetta</em> (<span class="math inline">\(\alpha\)</span>) del modello rappresenterà l’<em>estensione media prevista</em> (<em>extent</em>, in milioni di km²) <em>nell’anno medio del campione</em> (cioè l’anno medio tra 1979 e 2024).</p>
<p>Adattiamo un modello lineare con <code>year</code> centrata ed esaminiamo i risultati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_1</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<code>center = FALSE</code> nel <em>bf(…)</em> assicura che <em>brms non applichi un centraggio automatico</em> ai predittori numerici: così evitiamo il “doppio centraggio”, dato che abbiamo già centrato <code>year</code> a mano.</li>
<li>
<code>backend = "cmdstanr"</code> indica a <code>brms</code> di usare <em>CmdStan tramite l’interfaccia <code>cmdstanr</code></em> (anziché l’interfaccia <code>rstan</code>). In questo corso useremo <code>cmdstanr</code>, quindi è utile specificarlo esplicitamente.</li>
<li>
<code>silent = 0</code> lascia visibili alcuni messaggi informativi durante la compilazione e il campionamento (opzionale).</li>
</ul>
<p>Le <em>tracce MCMC</em> dei parametri si ottengono così:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_trace</span><span class="op">(</span></span>
<span>  <span class="va">fit_1</span>,</span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b_Intercept"</span>, <span class="st">"b_year_c"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Riepilogo del modello:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: gaussian </span></span>
<span><span class="co">#&gt;   Links: mu = identity; sigma = identity </span></span>
<span><span class="co">#&gt; Formula: extent ~ 1 + year_c </span></span>
<span><span class="co">#&gt;    Data: df (Number of observations: 46) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept     6.71      0.07     6.58     6.83 1.00     3383     2942</span></span>
<span><span class="co">#&gt; year_c       -0.07      0.01    -0.08    -0.06 1.00     4432     2887</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Further Distributional Parameters:</span></span>
<span><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sigma     0.45      0.05     0.37     0.56 1.00     3341     2803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione" class="level4" data-number="27.1.1.1"><h4 data-number="27.1.1.1" class="anchored" data-anchor-id="interpretazione">
<span class="header-section-number">27.1.1.1</span> Interpretazione</h4>
<ul>
<li>L’<em>intercetta</em> <span class="math inline">\(\alpha\)</span> = <code>b_Intercept</code> è l’<em>extent previsto</em> (milioni di km²) <em>nell’anno medio</em> del campione (circa <span class="math inline">\(\text{mean(df\$year)}\)</span>).</li>
<li>La <em>pendenza</em> <span class="math inline">\(\beta\)</span> = <code>b_year_c</code> quantifica la <em>variazione media annua</em> dell’extent: un valore negativo indica una <em>diminuzione</em> dell’estensione dei ghiacci nel tempo (trend atteso in questi dati).</li>
</ul>
<p>Per confronto, stimiamo lo <em>stesso modello</em> con l’approccio frequentista:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = extent ~ 1 + year_c, data = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.2394 -0.2755  0.0204  0.3081  1.0768 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept)  6.71000    0.06537   102.6   &lt;2e-16</span></span>
<span><span class="co">#&gt; year_c      -0.07148    0.00492   -14.5   &lt;2e-16</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.443 on 44 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.827,  Adjusted R-squared:  0.823 </span></span>
<span><span class="co">#&gt; F-statistic:  211 on 1 and 44 DF,  p-value: &lt;2e-16</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con <em>prior debolmente informativi</em>, i risultati bayesiani e frequentisti tendono a essere molto simili (stesse quantità stimate, ma nel caso bayesiano abbiamo l’intera <em>distribuzione a posteriori</em> dei parametri, utile per inferenze e previsione).</p>
</section></section><section id="visualizzazione-dei-risultati" class="level3" data-number="27.1.2"><h3 data-number="27.1.2" class="anchored" data-anchor-id="visualizzazione-dei-risultati">
<span class="header-section-number">27.1.2</span> Visualizzazione dei risultati</h3>
<p>Per comprendere visivamente la relazione stimata tra <em>anno</em> ed <em>estensione dei ghiacci artici</em> nel nostro modello bayesiano, possiamo utilizzare la funzione <code>conditional_effects</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">conditional_effects</span><span class="op">(</span><span class="va">fit_1</span>, effects <span class="op">=</span> <span class="st">"year_c"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Il grafico generato fornisce una rappresentazione intuitiva della stima:</p>
<ul>
<li>
<strong>Linea centrale (media posteriore):</strong> rappresenta il valore medio previsto di <em>extent</em> per ciascun valore di <code>year_c</code>.</li>
<li>
<strong>Area colorata (intervallo di credibilità):</strong> mostra l’<em>intervallo di credibilità</em> al 95% (Highest Density Interval, HDI), cioè l’intervallo in cui cade il 95% della distribuzione a posteriori delle previsioni.</li>
</ul>
<p>Possiamo modificare il livello di incertezza visualizzato regolando l’argomento <code>prob</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualizzazione con intervallo di credibilità all'89%</span></span>
<span><span class="fu">conditional_effects</span><span class="op">(</span><span class="va">fit_1</span>, effects <span class="op">=</span> <span class="st">"year_c"</span>, prob <span class="op">=</span> <span class="fl">0.89</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Riducendo <code>prob</code> (ad esempio a 0.80 o 0.50) otteniamo intervalli più stretti, che mostrano solo la parte più densa della distribuzione posteriore.</li>
<li>Aumentando <code>prob</code> (ad esempio a 0.99) otteniamo intervalli più ampi, che riflettono una maggiore incertezza.</li>
</ul>
<section id="interpretazione-pratica-del-grafico" class="level4" data-number="27.1.2.1"><h4 data-number="27.1.2.1" class="anchored" data-anchor-id="interpretazione-pratica-del-grafico">
<span class="header-section-number">27.1.2.1</span> Interpretazione pratica del grafico</h4>
<p>Nel grafico:</p>
<ul>
<li>il punto in cui la linea attraversa <code>year_c = 0</code> corrisponde all’<em>estensione prevista dei ghiacci</em> nell’anno medio del campione (circa il 2001, dato che abbiamo centrato la variabile <code>year</code>);</li>
<li>la <em>pendenza della linea</em> indica la variazione media di estensione dei ghiacci (in milioni di km²) per ogni anno in più: un valore negativo segnala una riduzione progressiva;</li>
<li>la <em>larghezza dell’intervallo di credibilità</em> riflette il grado di incertezza delle stime: intervalli più stretti indicano maggiore precisione, intervalli più larghi indicano più incertezza.</li>
</ul></section></section></section><section id="due-tipi-di-incertezza-nei-modelli-bayesiani" class="level2" data-number="27.2"><h2 data-number="27.2" class="anchored" data-anchor-id="due-tipi-di-incertezza-nei-modelli-bayesiani">
<span class="header-section-number">27.2</span> Due tipi di incertezza nei modelli bayesiani</h2>
<p>Immaginiamo di voler capire come l’<em>anno</em> (<em>X</em>) sia collegato all’<em>estensione dei ghiacci artici</em> (<em>Y</em>). Con un modello bayesiano otteniamo due tipi distinti di incertezza, che corrispondono a due domande diverse:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 53%">
<col style="width: 23%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>Che cosa stiamo stimando?</th>
<th>Come si chiama l’incertezza?</th>
<th>Che intervallo disegniamo?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<em>La media “vera”</em> dell’estensione dei ghiacci per un dato anno</td>
<td>
<em>Incertezza del parametro</em> (o dell’effetto medio)</td>
<td>
<em>Intervallo di credibilità</em> (credible interval)</td>
</tr>
<tr class="even">
<td>
<em>Il valore futuro di una nuova osservazione</em> (quale sarà l’estensione dei ghiacci in un singolo anno come quello)</td>
<td><em>Incertezza predittiva</em></td>
<td>
<em>Intervallo di predizione</em> (prediction interval)</td>
</tr>
</tbody>
</table>
<section id="incertezza-del-parametro-quanto-stiamo-sbagliando-la-linea-media" class="level3" data-number="27.2.1"><h3 data-number="27.2.1" class="anchored" data-anchor-id="incertezza-del-parametro-quanto-stiamo-sbagliando-la-linea-media">
<span class="header-section-number">27.2.1</span> Incertezza del parametro – «Quanto stiamo sbagliando la linea media?»</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">conditional_effects</span><span class="op">(</span><span class="va">fit_1</span>, effects <span class="op">=</span> <span class="st">"year_c"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Disegna la <em>linea di regressione</em> (la media stimata dell’estensione per ogni anno centrato).</p></li>
<li><p>Aggiunge intorno una <em>fascia stretta</em>: l’intervallo di credibilità al 95%.</p></li>
<li><p><em>Come leggerla:</em> Se la fascia, per l’anno medio del campione, va ad esempio da 7.5 a 7.7 milioni di km², significa che “con il 95% di probabilità la vera media dell’estensione in quell’anno sta lì dentro”. Non dice nulla sulle singole osservazioni, che possono discostarsi anche molto dalla media.</p></li>
</ul>
<p><strong>Metafora veloce.</strong> <em>Pensa a tirare freccette: la media cade vicino al centro, ma ogni singola freccia può atterrare in punti diversi. L’intervallo di credibilità descrive solo </em>dove cade il centro<em>.</em></p>
</section><section id="incertezza-predittiva-quanto-potrebbe-variare-la-prossima-osservazione" class="level3" data-number="27.2.2"><h3 data-number="27.2.2" class="anchored" data-anchor-id="incertezza-predittiva-quanto-potrebbe-variare-la-prossima-osservazione">
<span class="header-section-number">27.2.2</span> Incertezza predittiva – «Quanto potrebbe variare la prossima osservazione?»</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">conditional_effects</span><span class="op">(</span><span class="va">fit_1</span>, effects <span class="op">=</span> <span class="st">"year_c"</span>, method <span class="op">=</span> <span class="st">"predict"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Ripropone la stessa linea media.</li>
<li>Disegna però una <em>fascia molto più larga</em>: l’intervallo di predizione.</li>
</ul>
<p>L’intervallo predittivo include due fonti di variabilità:</p>
<ol type="1">
<li>
<em>Incertezza sulla linea media</em> (come sopra).</li>
<li>
<em>Variabilità residua</em>: le differenze naturali tra osservazioni nello stesso anno (fluttuazioni dovute a vento, condizioni meteorologiche, ecc.).</li>
</ol>
<p><strong>Metafora veloce.</strong> <em>Ora guardi non solo il centro del bersaglio, ma l’intero disco dove ogni freccia potrebbe cadere. L’area è molto più grande.</em></p>
</section><section id="quando-usare-luna-o-laltra-fascia" class="level3" data-number="27.2.3"><h3 data-number="27.2.3" class="anchored" data-anchor-id="quando-usare-luna-o-laltra-fascia">
<span class="header-section-number">27.2.3</span> Quando usare l’una o l’altra fascia?</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 56%">
<col style="width: 27%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th>Obiettivo della tua domanda</th>
<th>Funzione da usare</th>
<th>Quale fascia guardare</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Capire <em>l’effetto medio</em> (es. “quanto si riduce in media l’estensione ogni anno?”)</td>
<td><code>conditional_effects(...)</code></td>
<td><em>Intervallo di credibilità</em></td>
</tr>
<tr class="even">
<td>Fare <em>previsioni su un caso futuro</em> (es. “quale sarà l’estensione osservata nell’agosto 2025?”)</td>
<td><code>conditional_effects(..., method = "predict")</code></td>
<td><em>Intervallo di predizione</em></td>
</tr>
</tbody>
</table>
<section id="in-sintesi" class="level4" data-number="27.2.3.1"><h4 data-number="27.2.3.1" class="anchored" data-anchor-id="in-sintesi">
<span class="header-section-number">27.2.3.1</span> In sintesi</h4>
<ol type="1">
<li>
<em>Credibilità</em> = incertezza sul <em>parametro medio</em> → fascia stretta (stima della retta).</li>
<li>
<em>Predizione</em> = incertezza su <em>osservazioni future</em> → fascia larga (linea + variabilità residua).</li>
<li>La scelta dipende dalla domanda: “qual è la media?” (credibilità) oppure “dove cadrà il prossimo dato?” (predizione).</li>
</ol>
<p>In breve, la visualizzazione predittiva è più onesta quando vogliamo fare previsioni concrete su nuove osservazioni, mentre quella con l’intervallo di credibilità è più utile per capire la relazione generale tra anno ed estensione dei ghiacci.</p>
</section></section></section><section id="distribuzione-a-posteriori-dei-parametri" class="level2" data-number="27.3"><h2 data-number="27.3" class="anchored" data-anchor-id="distribuzione-a-posteriori-dei-parametri">
<span class="header-section-number">27.3</span> Distribuzione a posteriori dei parametri</h2>
<p>Per esaminare la <em>distribuzione a posteriori dei parametri</em> del modello, possiamo utilizzare la funzione <code><a href="https://paulbuerkner.com/brms/reference/mcmc_plot.brmsfit.html">mcmc_plot()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_plot</span><span class="op">(</span><span class="va">fit_1</span>, type <span class="op">=</span> <span class="st">"dens"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questa funzione disegna la <em>densità a posteriori</em> dei parametri, mostrando graficamente quali valori sono più plausibili dato il modello, i dati e le scelte a priori.</p>
<p>Per un’analisi numerica più dettagliata, trasformiamo l’oggetto <code>fit_1</code> in un formato compatibile con il pacchetto <code>posterior</code> e poi calcoliamo le statistiche di sintesi:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_1</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable      mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept  6.709 0.066     0.001   0.001</span></span>
<span><span class="co">#&gt; 2 b_year_c    -0.071 0.005     0.000   0.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>La funzione <code><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws()</a></code> converte l’oggetto in una struttura che rappresenta i campioni MCMC.</li>
<li>Gli argomenti <code>variable = "^b_"</code> e <code>regex = TRUE</code> selezionano solo i parametri che iniziano con <code>b_</code>, cioè i coefficienti del modello: l’intercetta e la pendenza.</li>
<li>La funzione <code>summarise_draws()</code> calcola statistiche riassuntive per la distribuzione a posteriori di questi parametri.</li>
</ul>
<section id="spiegazione-di-mcse_mean-e-mcse_sd" class="level3" data-number="27.3.1"><h3 data-number="27.3.1" class="anchored" data-anchor-id="spiegazione-di-mcse_mean-e-mcse_sd">
<span class="header-section-number">27.3.1</span> Spiegazione di <code>mcse_mean</code> e <code>mcse_sd</code>
</h3>
<p>Oltre a media (<code>mean</code>) e deviazione standard (<code>sd</code>), <code>summarise_draws()</code> riporta anche due indici utili:</p>
<ul>
<li>
<p><strong><code>mcse_mean</code></strong> = <em>Monte Carlo Standard Error</em> della media.</p>
<ul>
<li>Indica quanto la stima della media potrebbe variare semplicemente perché abbiamo un numero finito di campioni MCMC.</li>
<li>Se è molto piccolo rispetto a <code>sd</code>, possiamo fidarci che la media stimata rappresenta bene la distribuzione a posteriori.</li>
</ul>
</li>
<li>
<p><strong><code>mcse_sd</code></strong> = <em>Monte Carlo Standard Error</em> della deviazione standard.</p>
<ul>
<li>Indica quanto la stima della deviazione standard della distribuzione a posteriori potrebbe variare per lo stesso motivo.</li>
<li>Anche qui, un valore molto piccolo rispetto alla <code>sd</code> è segno che il campionamento è stato sufficiente.</li>
</ul>
</li>
</ul></section><section id="come-interpretarli-in-pratica" class="level3" data-number="27.3.2"><h3 data-number="27.3.2" class="anchored" data-anchor-id="come-interpretarli-in-pratica">
<span class="header-section-number">27.3.2</span> Come interpretarli in pratica?</h3>
<ul>
<li>
<p><strong>Rapporto rispetto a <code>sd</code></strong></p>
<ul>
<li>
<code>mcse_mean</code> e <code>mcse_sd</code> dovrebbero essere almeno un ordine di grandezza più piccoli delle corrispondenti stime (<code>mean</code> e <code>sd</code>).</li>
<li>Ad esempio: se per <code>b_Intercept</code> abbiamo <code>mcse_mean = 0.0044</code> e <code>sd = 0.2695</code>, il valore è più di 60 volte più piccolo → la stima è robusta.</li>
</ul>
</li>
<li>
<p><strong>Qualità del campionamento</strong></p>
<ul>
<li>
<p>Se <code>mcse_mean</code> o <code>mcse_sd</code> fossero troppo grandi, questo indicherebbe che:</p>
<ul>
<li>il numero di iterazioni MCMC è insufficiente,</li>
<li>le catene non hanno mescolato bene,</li>
<li>o ci sono problemi di convergenza.</li>
</ul>
</li>
</ul>
</li>
</ul>
<section id="in-sintesi-1" class="level4" data-number="27.3.2.1"><h4 data-number="27.3.2.1" class="anchored" data-anchor-id="in-sintesi-1">
<span class="header-section-number">27.3.2.1</span> In sintesi</h4>
<ul>
<li>
<code>mcse_mean</code> e <code>mcse_sd</code> non descrivono l’incertezza statistica sui dati, ma <em>la qualità del campionamento Monte Carlo</em>.</li>
<li>Se sono piccoli, significa che il numero di campioni è sufficiente e la distribuzione a posteriori è rappresentata in modo accurato.</li>
<li>In altre parole: ci dicono se possiamo fidarci che la “fotografia” ottenuta con l’MCMC rispecchi bene la vera distribuzione a posteriori.</li>
</ul></section></section></section><section id="specificare-i-priors" class="level2" data-number="27.4"><h2 data-number="27.4" class="anchored" data-anchor-id="specificare-i-priors">
<span class="header-section-number">27.4</span> Specificare i priors</h2>
<p>Nei modelli bayesiani i <em>priors</em> rappresentano le nostre aspettative sui parametri <em>prima</em> di osservare i dati. Se non li specifichiamo, <code>brms</code> assegna dei prior debolmente informativi di default.</p>
<p>Possiamo ispezionarli con la funzione <code>get_prior</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">get_prior</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   prior     class   coef group resp dpar nlpar lb ub</span></span>
<span><span class="co">#&gt;  student_t(3, 6.8, 2.5) Intercept                                   </span></span>
<span><span class="co">#&gt;                  (flat)         b                                   </span></span>
<span><span class="co">#&gt;                  (flat)         b year_c                            </span></span>
<span><span class="co">#&gt;    student_t(3, 0, 2.5)     sigma                               0   </span></span>
<span><span class="co">#&gt;        source</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’output mostra quali prior vengono assegnati a ciascun parametro del modello. Per esempio:</p>
<ol type="1">
<li>
<p><strong><code>prior</code></strong> – indica il prior utilizzato.</p>
<ul>
<li>
<code>student_t(3, 6.8, 2.5)</code>: prior t di Student per l’intercetta, con 3 gradi di libertà, media 6.8 e scala 2.5.</li>
<li>
<code>(flat)</code>: prior piatto (non informativo) per i coefficienti delle variabili predittive, come il coefficiente di <code>year_c</code>.</li>
<li>
<code>student_t(3, 0, 2.5)</code>: prior t di Student per la deviazione standard residua (<span class="math inline">\(\sigma\)</span>), centrato su 0 con scala 2.5.</li>
</ul>
</li>
<li>
<p><strong><code>class</code></strong> – indica a quale tipo di parametro il prior si riferisce:</p>
<ul>
<li>
<code>Intercept</code>: prior sull’intercetta (<span class="math inline">\(\alpha\)</span>);</li>
<li>
<code>b</code>: prior sui coefficienti dei predittori (<span class="math inline">\(\beta\)</span>);</li>
<li>
<code>sigma</code>: prior sulla deviazione standard residua (<span class="math inline">\(\sigma\)</span>).</li>
</ul>
</li>
<li>
<p><strong><code>coef</code></strong> – specifica a quale predittore si riferisce il prior.</p>
<ul>
<li>Vuoto per l’intercetta (perché non dipende da un predittore specifico).</li>
<li>
<code>year_c</code> per il coefficiente associato al predittore <code>year_c</code>.</li>
</ul>
</li>
<li>
<p><strong><code>lb</code> e <code>ub</code></strong> – rappresentano i limiti inferiore (<em>lower bound</em>) e superiore (<em>upper bound</em>) del prior, se esistono.</p>
<ul>
<li>Per <code>sigma</code>, il limite inferiore è 0, poiché una deviazione standard non può essere negativa.</li>
</ul>
</li>
<li><p><strong><code>source</code></strong> – indica se il prior è stato impostato dall’utente o se è il valore predefinito (<code>default</code>).</p></li>
</ol>
<section id="specificare-priors-manualmente" class="level3" data-number="27.4.1"><h3 data-number="27.4.1" class="anchored" data-anchor-id="specificare-priors-manualmente">
<span class="header-section-number">27.4.1</span> Specificare priors manualmente</h3>
<p>Se vogliamo rendere esplicite le nostre ipotesi, possiamo definire dei priors diversi da quelli di default. Ad esempio:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prior_gaussian</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">+</span>    <span class="co"># Intercetta attorno a 7 (milioni km²)</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"year_c"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Coefficiente di year_c</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span>          <span class="co"># Deviazione standard residua</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Nota: usiamo <code><a href="https://paulbuerkner.com/brms/reference/set_prior.html">brms::prior()</a></code> per essere sicuri di richiamare la funzione del pacchetto <code>brms</code> ed evitare conflitti con funzioni omonime di altri pacchetti.</p>
</blockquote>
<p>Adattiamo ora il modello con i priors specificati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, </span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>E otteniamo un sommario numerico delle distribuzioni a posteriori:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_2</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable      mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept  6.711 0.068     0.001   0.001</span></span>
<span><span class="co">#&gt; 2 b_year_c    -0.072 0.005     0.000   0.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="confronto-con-i-priors-di-default" class="level3" data-number="27.4.2"><h3 data-number="27.4.2" class="anchored" data-anchor-id="confronto-con-i-priors-di-default">
<span class="header-section-number">27.4.2</span> Confronto con i priors di default</h3>
<p>Nel nostro caso, i priors esplicitamente definiti <em>non cambiano in modo rilevante</em> le distribuzioni a posteriori. Questo accade perché i dati disponibili sono numerosi e forniscono già informazioni molto forti: in pratica, le osservazioni “dominano” sulle ipotesi iniziali.</p>
<p>Dal punto di vista didattico è un aspetto cruciale da sottolineare:</p>
<ul>
<li>
<strong>Con molti dati e alta informatività</strong>, i priors hanno un ruolo marginale: le stime finali saranno simili indipendentemente dalle ipotesi iniziali.</li>
<li>
<strong>Con pochi dati o dati molto rumorosi</strong>, invece, i priors diventano determinanti: le scelte iniziali possono influenzare in maniera sostanziale i risultati finali.</li>
</ul>
<p>In altre parole, la forza relativa tra <em>dati</em> e <em>priors</em> dipende dalla quantità e dalla qualità dell’informazione empirica disponibile.</p>
</section></section><section id="predizioni-a-posteriori-posterior-predictive-checks" class="level2" data-number="27.5"><h2 data-number="27.5" class="anchored" data-anchor-id="predizioni-a-posteriori-posterior-predictive-checks">
<span class="header-section-number">27.5</span> Predizioni a posteriori (<em>Posterior Predictive Checks</em>)</h2>
<p>Un aspetto fondamentale nella valutazione di un modello statistico, sia frequentista che bayesiano, è verificare <em>quanto bene le predizioni del modello rappresentino i dati osservati</em>. La logica di fondo è simile nei due paradigmi, ma l’approccio e l’interpretazione sono diversi.</p>
<section id="confronto-frequentista" class="level3" data-number="27.5.1"><h3 data-number="27.5.1" class="anchored" data-anchor-id="confronto-frequentista">
<span class="header-section-number">27.5.1</span> Confronto frequentista</h3>
<p>Nel caso frequentista, il confronto si basa sui valori stimati dal modello:</p>
<p><span class="math display">\[
\hat{y} = \hat{\alpha} + \hat{\beta}x
\]</span></p>
<p>Si analizzano principalmente:</p>
<ul>
<li>la vicinanza della retta di regressione ai dati osservati;</li>
<li>la presenza di eventuali pattern non lineari nei residui;</li>
<li>la variazione della dispersione di <span class="math inline">\(y\)</span> rispetto a <span class="math inline">\(x\)</span> (per verificare l’ipotesi di omoschedasticità).</li>
</ul></section><section id="approccio-bayesiano" class="level3" data-number="27.5.2"><h3 data-number="27.5.2" class="anchored" data-anchor-id="approccio-bayesiano">
<span class="header-section-number">27.5.2</span> Approccio bayesiano</h3>
<p>Nell’approccio bayesiano eseguiamo <em>le stesse verifiche di base</em>, ma disponiamo di uno strumento in più: le <em>Predizioni a Posteriori</em> (<em>Posterior Predictive Checks, PPCs</em>).</p>
<p>L’idea è semplice ma potente:</p>
<ul>
<li>invece di confrontare i dati osservati solo con una linea di regressione “fissa”,</li>
<li>li confrontiamo con <em>dati simulati dal modello</em>, generati utilizzando i campioni dalle distribuzioni a posteriori dei parametri.</li>
</ul>
<p>In questo modo, nelle predizioni è incorporata anche l’<em>incertezza sui parametri</em> stimata dal modello.</p>
</section><section id="come-si-costruiscono-le-predizioni-a-posteriori" class="level3" data-number="27.5.3"><h3 data-number="27.5.3" class="anchored" data-anchor-id="come-si-costruiscono-le-predizioni-a-posteriori">
<span class="header-section-number">27.5.3</span> Come si costruiscono le predizioni a posteriori</h3>
<p>Nel caso di un modello lineare semplice, il procedimento è:</p>
<ol type="1">
<li><p><strong>Dati osservati:</strong> partiamo dalla distribuzione empirica della variabile risposta (<span class="math inline">\(y\)</span>).</p></li>
<li><p><strong>Estrazione dei parametri:</strong> prendiamo un campione casuale <span class="math inline">\(\alpha'\)</span>, <span class="math inline">\(\beta'\)</span>, <span class="math inline">\(\sigma'\)</span> dalle distribuzioni a posteriori dei parametri.</p></li>
<li>
<p><strong>Simulazione dei dati:</strong> generiamo valori simulati da una normale:</p>
<p><span class="math display">\[
y_{\text{sim}} \sim \mathcal{N}(\alpha' + \beta' x, \sigma')
\]</span></p>
<p>dove <span class="math inline">\(x\)</span> sono i predittori osservati.</p>
</li>
<li><p><strong>Ripetizione:</strong> il processo viene ripetuto molte volte, producendo numerosi dataset simulati.</p></li>
<li><p><strong>Confronto:</strong> i dati simulati vengono confrontati con i dati reali (istogrammi, densità o residui).</p></li>
</ol></section><section id="interpretazione-1" class="level3" data-number="27.5.4"><h3 data-number="27.5.4" class="anchored" data-anchor-id="interpretazione-1">
<span class="header-section-number">27.5.4</span> Interpretazione</h3>
<ul>
<li>
<strong>Buona corrispondenza:</strong> se la distribuzione dei dati simulati si sovrappone bene a quella osservata, il modello rappresenta adeguatamente i dati.</li>
<li>
<strong>Discrepanze:</strong> differenze sistematiche (picchi mancanti, code sottostimate, ecc.) indicano che il modello non cattura tutti gli aspetti dei dati.</li>
</ul>
<p>Il vantaggio dei PPC è che:</p>
<ul>
<li>integrano l’incertezza sui parametri;</li>
<li>permettono di valutare non solo la bontà di adattamento media, ma anche dettagli della distribuzione;</li>
<li>sono molto intuitivi e visivi, facilitando la diagnosi di problemi.</li>
</ul>
<section id="esempi-con-r" class="level4" data-number="27.5.4.1"><h4 data-number="27.5.4.1" class="anchored" data-anchor-id="esempi-con-r">
<span class="header-section-number">27.5.4.1</span> Esempi con R</h4>
<p>Verifichiamo le predizioni del modello confrontandole con i dati osservati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>In questo caso, il grafico mostra una buona corrispondenza tra i dati simulati e quelli reali.</p>
<p>Possiamo poi analizzare i <em>residui bayesiani</em> con un grafico più specifico:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pp_check</span><span class="op">(</span><span class="va">fit_1</span>, type <span class="op">=</span> <span class="st">"error_scatter_avg"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Questo grafico rappresenta i residui (differenze tra osservato e predetto) rispetto ai valori predetti:</p>
<ul>
<li>se i residui appaiono distribuiti in modo uniforme, il modello descrive correttamente la relazione;</li>
<li>se emergono pattern sistematici (ad esempio curvature o variazioni di dispersione), il modello potrebbe essere inadeguato.</li>
</ul></section></section><section id="commento-sui-residui" class="level3" data-number="27.5.5"><h3 data-number="27.5.5" class="anchored" data-anchor-id="commento-sui-residui">
<span class="header-section-number">27.5.5</span> Commento sui residui</h3>
<p>Nel grafico dei residui (<span class="math inline">\(y\)</span> in funzione di <span class="math inline">\(y - y_{\text{rep}}\)</span>) si osserva un <em>trend crescente</em>: i residui non sono distribuiti in modo uniforme, ma mostrano una struttura sistematica. Questo pattern indica che il modello lineare bivariato <em>non cattura pienamente le proprietà dei dati</em>. In particolare, trattandosi di una serie temporale, è probabile che vi siano <em>dipendenze tra osservazioni successive nel tempo</em>: l’estensione dei ghiacci in un anno dipende anche dai valori degli anni immediatamente precedenti. Il modello lineare semplice, invece, assume che gli errori siano <em>indipendenti e identicamente distribuiti</em>, e non è quindi in grado di rappresentare questa dinamica temporale.</p>
<p>Questo esempio è didatticamente importante perché mostra che:</p>
<ul>
<li>anche un modello molto semplice può aiutare a evidenziare <em>strutture nascoste nei dati</em> (qui la dipendenza temporale);</li>
<li>tuttavia, se compaiono <em>incongruenze nei residui</em>, significa che il modello non è adeguato e va <em>migliorato o reso più complesso</em> (ad esempio con modelli di regressione per serie temporali o modelli gerarchici dinamici).</li>
</ul>
<p>La verifica dei residui è dunque un passaggio cruciale: non solo permette di valutare l’adattamento del modello, ma può suggerire <em>nuove direzioni di modellizzazione</em> per rappresentare meglio la complessità del fenomeno.</p>
<section id="in-sintesi-2" class="level4" data-number="27.5.5.1"><h4 data-number="27.5.5.1" class="anchored" data-anchor-id="in-sintesi-2">
<span class="header-section-number">27.5.5.1</span> In sintesi</h4>
<p>Le <em>Predizioni a Posteriori</em> forniscono un modo robusto per valutare l’adeguatezza di un modello bayesiano:</p>
<ul>
<li>se i dati simulati somigliano ai dati reali, il modello è plausibile per il campione analizzato;</li>
<li>in caso contrario, è opportuno rivedere la struttura del modello (es. includendo effetti non lineari, variabili aggiuntive o priors più adeguati).</li>
</ul>
<p>Il PPC è una “prova del nove” del modello, che traduce la teoria in un confronto diretto e visivo con i dati osservati.</p>
</section></section></section><section id="regressione-robusta" class="level2" data-number="27.6"><h2 data-number="27.6" class="anchored" data-anchor-id="regressione-robusta">
<span class="header-section-number">27.6</span> Regressione robusta</h2>
<p>In questa sezione introduciamo la <em>regressione robusta</em>. L’obiettivo è mostrare quanto sia semplice modificare, in <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>, la distribuzione degli errori per rendere il modello meno sensibile agli <em>outlier</em>.</p>
<p>Questa flessibilità è un punto di forza dell’approccio bayesiano: nei modelli frequentisti standard, la distribuzione degli errori è quasi sempre fissata a priori (ad esempio normale/gaussiana) e non può essere facilmente modificata.</p>
<section id="perché-servono-modelli-robusti" class="level3" data-number="27.6.1"><h3 data-number="27.6.1" class="anchored" data-anchor-id="perché-servono-modelli-robusti">
<span class="header-section-number">27.6.1</span> Perché servono modelli robusti?</h3>
<p>Gli outlier — valori molto distanti dal resto delle osservazioni — possono influenzare in modo marcato le stime di regressione. Ad esempio, aggiungiamo artificialmente un outlier nel dataset:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_outlier</span> <span class="op">&lt;-</span> <span class="va">df</span></span>
<span><span class="va">df_outlier</span><span class="op">$</span><span class="va">extent</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span>     <span class="co"># valore anomalo molto alto</span></span>
<span><span class="va">df_outlier</span><span class="op">$</span><span class="va">year_c</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">25</span>    <span class="co"># anno centrato "estremo"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizziamo i dati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_outlier</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">year_c</span>, y <span class="op">=</span> <span class="va">extent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Anno centrato"</span>, y <span class="op">=</span> <span class="st">"Estensione (milioni km²)"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="effetto-delloutlier-su-un-modello-gaussiano" class="level3" data-number="27.6.2"><h3 data-number="27.6.2" class="anchored" data-anchor-id="effetto-delloutlier-su-un-modello-gaussiano">
<span class="header-section-number">27.6.2</span> Effetto dell’outlier su un modello gaussiano</h3>
<p>Stimiamo un modello lineare gaussiano:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_outlier</span>, </span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo i parametri stimati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_3</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable      mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept  6.961 0.252     0.004   0.004</span></span>
<span><span class="co">#&gt; 2 b_year_c    -0.107 0.019     0.000   0.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rispetto al modello stimato senza outlier (dove la pendenza <span class="math inline">\(\beta\)</span> era intorno a –0.07), qui la stima è fortemente distorta. Un singolo punto anomalo può dunque trascinare la retta di regressione.</p>
</section><section id="un-modello-robusto-con-distribuzione-t" class="level3" data-number="27.6.3"><h3 data-number="27.6.3" class="anchored" data-anchor-id="un-modello-robusto-con-distribuzione-t">
<span class="header-section-number">27.6.3</span> Un modello robusto con distribuzione <em>t</em>
</h3>
<p>Per ridurre la sensibilità agli outlier, possiamo sostituire la distribuzione gaussiana degli errori con una distribuzione <em>t</em> di Student, che ha <em>code più pesanti</em>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_4</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">student</span><span class="op">(</span><span class="op">)</span>,   <span class="co"># distribuzione t di Student</span></span>
<span>  data <span class="op">=</span> <span class="va">df_outlier</span>, </span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I risultati mostrano che il modello <em>t</em> è <em>meno influenzato dall’outlier</em> rispetto al modello gaussiano:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_4</span>, variable <span class="op">=</span> <span class="st">"^b_"</span>, regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   variable      mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 b_Intercept  6.740 0.068     0.001   0.001</span></span>
<span><span class="co">#&gt; 2 b_year_c    -0.072 0.005     0.000   0.000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="il-parametro-nu-quanto-sono-pesanti-le-code" class="level3" data-number="27.6.4"><h3 data-number="27.6.4" class="anchored" data-anchor-id="il-parametro-nu-quanto-sono-pesanti-le-code">
<span class="header-section-number">27.6.4</span> Il parametro <span class="math inline">\(\nu\)</span>: quanto sono pesanti le code?</h3>
<p>Il modello con distribuzione <em>t</em> stima anche il parametro <span class="math inline">\(\nu\)</span>, che controlla la pesantezza delle code:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws</a></span><span class="op">(</span><span class="va">fit_4</span>, variable <span class="op">=</span> <span class="st">"nu"</span><span class="op">)</span></span>
<span><span class="fu">posterior</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span><span class="va">draws</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"mcse_mean"</span>, <span class="st">"mcse_sd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 5</span></span>
<span><span class="co">#&gt;   variable  mean    sd mcse_mean mcse_sd</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 nu       2.527 0.840     0.014   0.016</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Con valori <em>alti</em> di <span class="math inline">\(\nu\)</span> (es. &gt; 30), la distribuzione <em>t</em> si avvicina a una normale.</li>
<li>Con valori <em>bassi</em> (es. <span class="math inline">\(\nu \approx 4\)</span>), le code sono molto più pesanti: la distribuzione “accetta” più facilmente valori estremi, senza permettere che influenzino eccessivamente le stime.</li>
</ul>
<p>Nel nostro caso, <span class="math inline">\(\nu \approx 4\)</span> indica una distribuzione ben più robusta della normale, e il modello riesce a ignorare in buona parte l’effetto dell’outlier.</p>
</section><section id="in-sintesi-3" class="level3" data-number="27.6.5"><h3 data-number="27.6.5" class="anchored" data-anchor-id="in-sintesi-3">
<span class="header-section-number">27.6.5</span> In sintesi</h3>
<p>La regressione robusta con distribuzione <em>t</em> è uno strumento essenziale quando sospettiamo che i dati possano contenere valori anomali. A differenza del modello gaussiano, non lascia che pochi outlier distorcano in modo significativo le stime dei parametri.</p>
</section></section><section id="indice-di-determinazione-bayesiano" class="level2" data-number="27.7"><h2 data-number="27.7" class="anchored" data-anchor-id="indice-di-determinazione-bayesiano">
<span class="header-section-number">27.7</span> Indice di determinazione bayesiano</h2>
<p>Con il pacchetto <code>brms</code> possiamo calcolare il <em>Bayes <span class="math inline">\(R^2\)</span></em>, l’equivalente bayesiano del classico indice di determinazione <span class="math inline">\(R^2\)</span>. Questo indice misura la <em>proporzione di varianza spiegata dal modello</em>, ma a differenza dell’approccio frequentista, tiene conto dell’<em>incertezza associata</em> alle stime dei parametri.</p>
<p>Il comando per calcolarlo è:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">bayes_R2</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Estimate Est.Error  Q2.5 Q97.5</span></span>
<span><span class="co">#&gt; R2    0.822     0.023 0.764 0.851</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione-delloutput" class="level3" data-number="27.7.1"><h3 data-number="27.7.1" class="anchored" data-anchor-id="interpretazione-delloutput">
<span class="header-section-number">27.7.1</span> Interpretazione dell’output</h3>
<p>Il risultato è un <em>tibble</em> (una tabella ordinata) che riporta:</p>
<ul>
<li>
<strong>Estimate</strong>: la media della distribuzione a posteriori del Bayes <span class="math inline">\(R^2\)</span>, cioè la proporzione di varianza spiegata dal modello;</li>
<li>
<strong>Est.Error</strong>: l’errore standard associato alla stima;</li>
<li>
<strong>Q2.5</strong> e <strong>Q97.5</strong>: i limiti inferiore e superiore dell’intervallo di credibilità al 95% per il Bayes <span class="math inline">\(R^2\)</span>.</li>
</ul>
<p>Esempio (con valori ipotetici coerenti col nostro modello):</p>
<ul>
<li>
<strong>Stima media</strong>: il modello spiega circa il 57% della varianza osservata;</li>
<li>
<strong>Errore standard</strong>: l’incertezza sulla stima è bassa (± 0.02);</li>
<li>
<strong>Intervallo di credibilità</strong>: con il 95% di probabilità, il vero valore del Bayes <span class="math inline">\(R^2\)</span> si trova tra 0.52 e 0.61.</li>
</ul></section><section id="differenze-rispetto-al-r2-frequentista" class="level3" data-number="27.7.2"><h3 data-number="27.7.2" class="anchored" data-anchor-id="differenze-rispetto-al-r2-frequentista">
<span class="header-section-number">27.7.2</span> Differenze rispetto al <span class="math inline">\(R^2\)</span> frequentista</h3>
<ol type="1">
<li>
<p><strong>Incertezza esplicita</strong></p>
<ul>
<li>Il Bayes <span class="math inline">\(R^2\)</span> non è una stima puntuale, ma una distribuzione a posteriori: possiamo quindi rappresentare l’incertezza con intervalli di credibilità.</li>
<li>Nel caso frequentista, invece, il <span class="math inline">\(R^2\)</span> è un singolo numero senza misura diretta di incertezza.</li>
</ul>
</li>
<li>
<p><strong>Influenza dei priors</strong></p>
<ul>
<li>Nel Bayes <span class="math inline">\(R^2\)</span>, i priors scelti per i parametri influiscono sulla stima finale.</li>
<li>Questo consente di incorporare conoscenze precedenti e rende la misura più flessibile e adattabile al contesto di ricerca.</li>
</ul>
</li>
</ol></section><section id="distribuzione-a-posteriori-del-bayes-r2" class="level3" data-number="27.7.3"><h3 data-number="27.7.3" class="anchored" data-anchor-id="distribuzione-a-posteriori-del-bayes-r2">
<span class="header-section-number">27.7.3</span> Distribuzione a posteriori del Bayes <span class="math inline">\(R^2\)</span>
</h3>
<p>Possiamo anche visualizzare la distribuzione completa dei valori simulati di <span class="math inline">\(R^2\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">r2_draws</span> <span class="op">&lt;-</span> <span class="fu">bayes_R2</span><span class="op">(</span><span class="va">fit_2</span>, summary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">r2_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">r2_draws</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">r2_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">R2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rug</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">R</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span></span>
<span>  <span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Calcoliamo anche i quantili:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">r2_df</span><span class="op">$</span><span class="va">R2</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.025</span>, <span class="fl">.5</span>, <span class="fl">.975</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;  2.5%   50% 97.5% </span></span>
<span><span class="co">#&gt; 0.764 0.827 0.851</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In alternativa, con <code>bayesplot</code> possiamo ottenere una visualizzazione immediata e compatta:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">r2_draws</span>, prob <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<section id="in-sintesi-4" class="level4" data-number="27.7.3.1"><h4 data-number="27.7.3.1" class="anchored" data-anchor-id="in-sintesi-4">
<span class="header-section-number">27.7.3.1</span> In sintesi</h4>
<p>Il Bayes <span class="math inline">\(R^2\)</span> è uno strumento potente perché combina l’intuitività del <span class="math inline">\(R^2\)</span> classico con la ricchezza informativa dell’approccio bayesiano, permettendo di valutare non solo quanta varianza il modello spiega, ma anche quanto siamo sicuri di questa stima.</p>
</section></section></section><section id="approfondimento-manipolare-la-distribuzione-a-posteriori-con-brms" class="level2" data-number="27.8"><h2 data-number="27.8" class="anchored" data-anchor-id="approfondimento-manipolare-la-distribuzione-a-posteriori-con-brms">
<span class="header-section-number">27.8</span> Approfondimento: manipolare la distribuzione a posteriori con <code>brms</code>
</h2>
<p>Vediamo ora come accedere e manipolare i <em>campioni della distribuzione a posteriori</em> generati da un modello stimato con <code>brms</code>.</p>
<p>Supponiamo di aver costruito un modello lineare semplice, in cui vogliamo predire l’estensione dei ghiacci (<code>extent</code>) a partire dall’anno centrato (<code>year_c</code>):</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="fu">bf</span><span class="op">(</span><span class="va">extent</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">year_c</span>, center <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span>
<span>  prior <span class="op">=</span> <span class="va">prior_gaussian</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>, </span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>  silent <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="estrarre-i-campioni" class="level3" data-number="27.8.1"><h3 data-number="27.8.1" class="anchored" data-anchor-id="estrarre-i-campioni">
<span class="header-section-number">27.8.1</span> Estrarre i campioni</h3>
<p>Una volta stimato il modello, possiamo ottenere i <em>campioni MCMC</em> della distribuzione a posteriori con <code><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">posterior_2</span> <span class="op">&lt;-</span> <span class="fu">as_draws</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’oggetto <code>posterior_2</code> è di tipo <em>draws</em>, definito dal pacchetto <em>posterior</em>. Al suo interno troviamo i campioni prodotti dall’algoritmo MCMC, organizzati come un array o una lista:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">posterior_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ 1:List of 5</span></span>
<span><span class="co">#&gt;   ..$ b_Intercept: num [1:1000] 6.74 6.72 6.75 6.65 6.79 ...</span></span>
<span><span class="co">#&gt;   ..$ b_year_c   : num [1:1000] -0.075 -0.0721 -0.0757 -0.0717 -0.0745 ...</span></span>
<span><span class="co">#&gt;   ..$ sigma      : num [1:1000] 0.43 0.427 0.494 0.493 0.413 ...</span></span>
<span><span class="co">#&gt;   ..$ lprior     : num [1:1000] -3.05 -3.05 -3.06 -3.07 -3.04 ...</span></span>
<span><span class="co">#&gt;   ..$ lp__       : num [1:1000] -31.1 -30.8 -31.8 -31.7 -31.9 ...</span></span>
<span><span class="co">#&gt;  $ 2:List of 5</span></span>
<span><span class="co">#&gt;   ..$ b_Intercept: num [1:1000] 6.75 6.75 6.69 6.73 6.53 ...</span></span>
<span><span class="co">#&gt;   ..$ b_year_c   : num [1:1000] -0.0714 -0.0711 -0.0695 -0.0789 -0.0687 ...</span></span>
<span><span class="co">#&gt;   ..$ sigma      : num [1:1000] 0.458 0.473 0.388 0.515 0.468 ...</span></span>
<span><span class="co">#&gt;   ..$ lprior     : num [1:1000] -3.05 -3.05 -3.04 -3.07 -3.07 ...</span></span>
<span><span class="co">#&gt;   ..$ lp__       : num [1:1000] -31 -31.1 -31.6 -32.6 -34.3 ...</span></span>
<span><span class="co">#&gt;  $ 3:List of 5</span></span>
<span><span class="co">#&gt;   ..$ b_Intercept: num [1:1000] 6.65 6.83 6.65 6.76 6.63 ...</span></span>
<span><span class="co">#&gt;   ..$ b_year_c   : num [1:1000] -0.0703 -0.0642 -0.0752 -0.0688 -0.077 ...</span></span>
<span><span class="co">#&gt;   ..$ sigma      : num [1:1000] 0.399 0.424 0.428 0.403 0.41 ...</span></span>
<span><span class="co">#&gt;   ..$ lprior     : num [1:1000] -3.05 -3.04 -3.05 -3.04 -3.05 ...</span></span>
<span><span class="co">#&gt;   ..$ lp__       : num [1:1000] -31.7 -33.8 -31.5 -31.5 -32.4 ...</span></span>
<span><span class="co">#&gt;  $ 4:List of 5</span></span>
<span><span class="co">#&gt;   ..$ b_Intercept: num [1:1000] 6.68 6.66 6.76 6.73 6.78 ...</span></span>
<span><span class="co">#&gt;   ..$ b_year_c   : num [1:1000] -0.0625 -0.0729 -0.0661 -0.0708 -0.0711 ...</span></span>
<span><span class="co">#&gt;   ..$ sigma      : num [1:1000] 0.44 0.423 0.465 0.451 0.414 ...</span></span>
<span><span class="co">#&gt;   ..$ lprior     : num [1:1000] -3.05 -3.05 -3.05 -3.05 -3.04 ...</span></span>
<span><span class="co">#&gt;   ..$ lp__       : num [1:1000] -32.5 -31.2 -31.7 -30.8 -31.5 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr [1:3] "draws_list" "draws" "list"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="parametri-del-modello" class="level3" data-number="27.8.2"><h3 data-number="27.8.2" class="anchored" data-anchor-id="parametri-del-modello">
<span class="header-section-number">27.8.2</span> Parametri del modello</h3>
<p>Per vedere i nomi dei parametri campionati (intercetta, slope, deviazione standard, ecc.) usiamo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">variables</span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "b_Intercept" "b_year_c"    "sigma"       "lprior"      "lp__"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nel nostro caso, siamo interessati al coefficiente di regressione associato a <code>year_c</code>, che in <code>brms</code> è etichettato come <code>b_year_c</code>.</p>
</section><section id="estrarre-e-riorganizzare-i-campioni" class="level3" data-number="27.8.3"><h3 data-number="27.8.3" class="anchored" data-anchor-id="estrarre-e-riorganizzare-i-campioni">
<span class="header-section-number">27.8.3</span> Estrarre e riorganizzare i campioni</h3>
<p>Per lavorare più comodamente con i campioni, possiamo usare <em>tidybayes</em>, che fornisce funzioni per trasformare gli output bayesiani in formato <em>tidy</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b_slope_draws</span> <span class="op">&lt;-</span> <span class="va">posterior_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">spread_draws</span><span class="op">(</span><span class="va">b_year_c</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La funzione <code>spread_draws()</code> “srotola” i campioni in un tibble:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">b_slope_draws</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   .chain .iteration .draw b_year_c</span></span>
<span><span class="co">#&gt;    &lt;int&gt;      &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1      1          1     1  -0.0750</span></span>
<span><span class="co">#&gt; 2      1          2     2  -0.0721</span></span>
<span><span class="co">#&gt; 3      1          3     3  -0.0757</span></span>
<span><span class="co">#&gt; 4      1          4     4  -0.0717</span></span>
<span><span class="co">#&gt; 5      1          5     5  -0.0745</span></span>
<span><span class="co">#&gt; 6      1          6     6  -0.0682</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ogni riga rappresenta un singolo campione della catena MCMC per quel parametro.</p>
</section><section id="calcolare-statistiche-di-sintesi" class="level3" data-number="27.8.4"><h3 data-number="27.8.4" class="anchored" data-anchor-id="calcolare-statistiche-di-sintesi">
<span class="header-section-number">27.8.4</span> Calcolare statistiche di sintesi</h3>
<p>Una volta estratti i campioni di <code>b_year_c</code>, possiamo calcolare facilmente mediana, media e quantili:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">b_slope_draws</span><span class="op">$</span><span class="va">b_year_c</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.50</span>, <span class="fl">0.97</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      3%     50%     97% </span></span>
<span><span class="co">#&gt; -0.0814 -0.0714 -0.0621</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">b_slope_draws</span><span class="op">$</span><span class="va">b_year_c</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.0715</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>I quantili a 0.03 e 0.97 definiscono un intervallo di credibilità al 94%.</li>
<li>Il quantile a 0.50 corrisponde alla <em>mediana a posteriori</em>.</li>
<li>La media a posteriori fornisce un’altra stima puntuale utile.</li>
</ul></section><section id="visualizzare-la-distribuzione-a-posteriori" class="level3" data-number="27.8.5"><h3 data-number="27.8.5" class="anchored" data-anchor-id="visualizzare-la-distribuzione-a-posteriori">
<span class="header-section-number">27.8.5</span> Visualizzare la distribuzione a posteriori</h3>
<p>Per capire meglio la forma della distribuzione a posteriori, possiamo tracciarne la densità. Con <em>tidyverse</em> e <em>tidybayes</em> bastano poche righe:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>beta <span class="op">=</span> <span class="va">b_slope_draws</span><span class="op">$</span><span class="va">b_year_c</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_halfeye</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Valore di β"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità a posteriori"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="04_synt_sugar_sea_ice_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>
<code>stat_halfeye()</code> mostra la densità stimata e mette in evidenza i valori più probabili.</li>
<li>La banda orizzontale rappresenta un intervallo di credibilità centrale.</li>
</ul>
<section id="in-sintesi-5" class="level4" data-number="27.8.5.1"><h4 data-number="27.8.5.1" class="anchored" data-anchor-id="in-sintesi-5">
<span class="header-section-number">27.8.5.1</span> In sintesi</h4>
<p>Grazie a <code><a href="https://mc-stan.org/posterior/reference/draws.html">as_draws()</a></code> di <em>posterior</em> e alle funzioni di <em>tidybayes</em>, possiamo:</p>
<ul>
<li>estrarre i campioni MCMC della distribuzione a posteriori,</li>
<li>calcolare statistiche di sintesi (media, mediana, quantili),</li>
<li>visualizzare in modo intuitivo la forma e l’incertezza della distribuzione di un parametro.</li>
</ul>
<p>La combinazione di <em>posterior</em>, <em>tidybayes</em> e <em>tidyverse</em> rende il flusso di lavoro con i modelli stimati da <code>brms</code> semplice, potente e flessibile.</p>
</section></section></section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>In questo capitolo abbiamo visto come la scrittura di un modello possa essere resa più chiara e compatta attraverso l’uso di scorciatoie sintattiche. Lo scopo non è cambiare la sostanza del modello, ma alleggerire la sua formulazione, così da concentrare l’attenzione sugli aspetti concettuali e interpretativi piuttosto che sui dettagli tecnici ripetitivi.</p>
<p>Questa operazione di “pulizia” del codice ha un valore didattico importante: permette di visualizzare con maggiore immediatezza la struttura del modello e di cogliere più facilmente il legame tra le formule statistiche e la loro implementazione. Inoltre, anticipa una sfida che incontreremo sempre più spesso man mano che i modelli diventeranno complessi: la necessità di strumenti che automatizzino i calcoli senza oscurare la logica sottostante.</p>
<p>Nei prossimi capitoli vedremo come <strong>Stan</strong> risponda a questa esigenza su scala molto più ampia, fornendo un linguaggio di programmazione che combina rigore statistico e potenza computazionale. In questo senso, lo “zucchero sintattico” non è solo una comodità, ma un passo preparatorio per abituarci a pensare ai modelli in modo modulare, leggibile e scalabile.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p><em>Modello base</em><br>
Importa il dataset <code>Howell_18.csv</code>, filtra gli individui di età ≥ 18 anni e adatta un modello bayesiano lineare <code>height ∼ weight</code> usando <code><a href="https://paulbuerkner.com/brms/reference/brm.html">brm()</a></code>. Visualizza il sommario.</p></li>
<li><p><em>Centraggio del predittore</em><br>
Calcola la variabile centrata <code>weight_c</code> e adatta il modello <code>height ∼ weight_c</code>. Confronta l’intercetta (<code>b_Intercept</code>) con quella del modello non centrato. Spiega la differenza.</p></li>
<li>
<p><em>Specificazione dei prior</em><br>
Usa <code><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior()</a></code> per recuperare i prior di default, poi definisci manualmente prior debolmente informativi:</p>
<ul>
<li><code>Intercept ∼ Normal(150, 20)</code></li>
<li><code>weight_c ∼ Normal(0, 10)</code></li>
<li><code>sigma ∼ Cauchy(0, 5)</code></li>
</ul>
<p>Adatta il modello con questi prior e confronta le stime a posteriori con quelle del modello con prior di default.</p>
</li>
<li>
<p><em>Predizioni predittive a posteriori</em><br>
Per il modello con prior personalizzati:</p>
<ul>
<li>Esegui <code><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check()</a></code> per la densità e per l’errore medio (<code>type = "error_scatter_avg"</code>).</li>
<li>Descrivi brevemente cosa mostrano i due grafici.</li>
</ul>
</li>
<li>
<p><em>Modello robusto</em><br>
Introduci un outlier modificando il primo record: imposta <code>height = 400</code>.</p>
<ul>
<li>Adatta prima un modello gaussiano e poi uno robusto con <code>family = student()</code>.</li>
<li>Confronta le stime di <code>b_weight_c</code> nei due modelli e discuti l’impatto dell’outlier.</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>
<p><em>Modello base</em></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="st">"data/Howell_18.csv"</span><span class="op">)</span></span>
<span><span class="va">df_adults</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span><span class="op">)</span></span>
<span><span class="va">fit_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">weight</span>, data <span class="op">=</span> <span class="va">df_adults</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_base</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</li>
<li>
<p><em>Centraggio del predittore</em></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_adults</span><span class="op">$</span><span class="va">weight_c</span> <span class="op">&lt;-</span> <span class="va">df_adults</span><span class="op">$</span><span class="va">weight</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_adults</span><span class="op">$</span><span class="va">weight</span><span class="op">)</span></span>
<span><span class="va">fit_centered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">weight_c</span>, data <span class="op">=</span> <span class="va">df_adults</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_centered</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Il <code>b_Intercept</code> nel modello non centrato è l’altezza prevista per peso = 0 (non interpretabile realisticamente).<br>
</li>
<li>Nel modello centrato, l’intercetta rappresenta l’altezza media alla media del peso del campione.</li>
</ul>
</li>
<li>
<p><em>Specificazione dei prior</em></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/default_prior.html">get_prior</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">weight_c</span>, data <span class="op">=</span> <span class="va">df_adults</span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">150</span>, <span class="fl">20</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span>, coef <span class="op">=</span> <span class="st">"weight_c"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sigma"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span></span>
<span>  <span class="va">height</span> <span class="op">~</span> <span class="va">weight_c</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_adults</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors_custom</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_priors</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Le stime a posteriori rimangono simili, ma i prior personalizzati influenzano leggermente l’incertezza.</li>
</ul>
</li>
<li>
<p><em>Predizioni predittive a posteriori</em></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fit_priors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/pp_check.html">pp_check</a></span><span class="op">(</span><span class="va">fit_priors</span>, type <span class="op">=</span> <span class="st">"error_scatter_avg"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Il grafico di densità mostra se la distribuzione simulata riproduce quella osservata.<br>
</li>
<li>Il grafico degli errori media evidenzia eventuali pattern sistematici nei residui.</li>
</ul>
</li>
<li>
<p><em>Modello robusto</em></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_out</span> <span class="op">&lt;-</span> <span class="va">df_adults</span></span>
<span><span class="va">df_out</span><span class="op">$</span><span class="va">height</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">fit_gauss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">weight_c</span>, data <span class="op">=</span> <span class="va">df_out</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span><span class="op">)</span></span>
<span><span class="va">fit_student</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">height</span> <span class="op">~</span> <span class="va">weight_c</span>, family <span class="op">=</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brmsfamily.html">student</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">df_out</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_gauss</span><span class="op">)</span><span class="op">$</span><span class="va">fixed</span><span class="op">[</span><span class="st">"weight_c"</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_student</span><span class="op">)</span><span class="op">$</span><span class="va">fixed</span><span class="op">[</span><span class="st">"weight_c"</span>, <span class="op">]</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Il modello gaussiano vede una variazione marcata di <code>b_weight_c</code> a causa dell’outlier.<br>
</li>
<li>Il modello Student stima un coefficiente più vicino al valore senza outlier, dimostrando robustezza.</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] cmdstanr_0.9.0        pillar_1.11.0         tinytable_0.13.0     </span></span>
<span><span class="co">#&gt;  [4] patchwork_1.3.2       ggdist_3.3.3          tidybayes_3.0.7      </span></span>
<span><span class="co">#&gt;  [7] bayesplot_1.14.0      ggplot2_3.5.2         reliabilitydiag_0.2.1</span></span>
<span><span class="co">#&gt; [10] priorsense_1.1.1      posterior_1.6.1       loo_2.8.0            </span></span>
<span><span class="co">#&gt; [13] rstan_2.32.7          StanHeaders_2.32.10   brms_2.22.0          </span></span>
<span><span class="co">#&gt; [16] Rcpp_1.1.0            sessioninfo_1.2.3     conflicted_1.2.0     </span></span>
<span><span class="co">#&gt; [19] janitor_2.2.1         matrixStats_1.5.0     modelr_0.1.11        </span></span>
<span><span class="co">#&gt; [22] tibble_3.3.0          dplyr_1.1.4           tidyr_1.3.1          </span></span>
<span><span class="co">#&gt; [25] rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      ggridges_0.5.7        compiler_4.5.1       </span></span>
<span><span class="co">#&gt; [10] reshape2_1.4.4        systemfonts_1.2.3     vctrs_0.6.5          </span></span>
<span><span class="co">#&gt; [13] stringr_1.5.1         pkgconfig_2.0.3       arrayhelpers_1.1-0   </span></span>
<span><span class="co">#&gt; [16] fastmap_1.2.0         backports_1.5.0       labeling_0.4.3       </span></span>
<span><span class="co">#&gt; [19] utf8_1.2.6            rmarkdown_2.29        ps_1.9.1             </span></span>
<span><span class="co">#&gt; [22] ragg_1.5.0            purrr_1.1.0           xfun_0.53            </span></span>
<span><span class="co">#&gt; [25] cachem_1.1.0          jsonlite_2.0.0        broom_1.0.9          </span></span>
<span><span class="co">#&gt; [28] parallel_4.5.1        R6_2.6.1              stringi_1.8.7        </span></span>
<span><span class="co">#&gt; [31] RColorBrewer_1.1-3    lubridate_1.9.4       estimability_1.5.1   </span></span>
<span><span class="co">#&gt; [34] knitr_1.50            zoo_1.8-14            R.utils_2.13.0       </span></span>
<span><span class="co">#&gt; [37] pacman_0.5.1          Matrix_1.7-4          splines_4.5.1        </span></span>
<span><span class="co">#&gt; [40] timechange_0.3.0      tidyselect_1.2.1      abind_1.4-8          </span></span>
<span><span class="co">#&gt; [43] yaml_2.3.10           codetools_0.2-20      curl_7.0.0           </span></span>
<span><span class="co">#&gt; [46] processx_3.8.6        pkgbuild_1.4.8        plyr_1.8.9           </span></span>
<span><span class="co">#&gt; [49] lattice_0.22-7        withr_3.0.2           bridgesampling_1.1-2 </span></span>
<span><span class="co">#&gt; [52] coda_0.19-4.1         evaluate_1.0.5        survival_3.8-3       </span></span>
<span><span class="co">#&gt; [55] RcppParallel_5.1.11-1 tensorA_0.36.2.1      checkmate_2.3.3      </span></span>
<span><span class="co">#&gt; [58] stats4_4.5.1          distributional_0.5.0  generics_0.1.4       </span></span>
<span><span class="co">#&gt; [61] rprojroot_2.1.1       rstantools_2.5.0      scales_1.4.0         </span></span>
<span><span class="co">#&gt; [64] xtable_1.8-4          glue_1.8.0            emmeans_1.11.2-8     </span></span>
<span><span class="co">#&gt; [67] tools_4.5.1           data.table_1.17.8     mvtnorm_1.3-3        </span></span>
<span><span class="co">#&gt; [70] grid_4.5.1            QuickJSR_1.8.0        colorspace_2.1-1     </span></span>
<span><span class="co">#&gt; [73] nlme_3.1-168          cli_3.6.5             textshaping_1.0.3    </span></span>
<span><span class="co">#&gt; [76] svUnit_1.0.8          Brobdingnag_1.2-9     V8_7.0.0             </span></span>
<span><span class="co">#&gt; [79] gtable_0.3.6          R.methodsS3_1.8.2     digest_0.6.37        </span></span>
<span><span class="co">#&gt; [82] TH.data_1.1-4         htmlwidgets_1.6.4     farver_2.1.2         </span></span>
<span><span class="co">#&gt; [85] R.oo_1.27.1           memoise_2.0.1         htmltools_0.5.8.1    </span></span>
<span><span class="co">#&gt; [88] lifecycle_1.0.4       MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-alter2025navigating" class="csl-entry" role="listitem">
Alter, U., Too, M. A., &amp; Cribbie, R. A. (2025). Navigating the Bayes maze: The psychologist’s guide to Bayesian statistics, a hands-on tutorial with R code. <em>International Journal of Psychology</em>, <em>60</em>(1), e13271.
</div>
<div id="ref-clayton2020climate" class="csl-entry" role="listitem">
Clayton, S. (2020). Climate anxiety: Psychological responses to climate change. <em>Journal of anxiety disorders</em>, <em>74</em>, 102263.
</div>
<div id="ref-wilkinson1973symbolic" class="csl-entry" role="listitem">
Wilkinson, G., &amp; Rogers, C. (1973). Symbolic description of factorial models for analysis of variance. <em>Journal of the Royal Statistical Society Series C: Applied Statistics</em>, <em>22</em>(3), 392–399.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/linear_models/03_reglin_bayes.html" class="pagination-link" aria-label="Modello bayesiano di regressione lineare bivariata">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/linear_models/05_stan_regression.html" class="pagination-link" aria-label="Regressione lineare in Stan">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/linear_models/04_synt_sugar_sea_ice.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>