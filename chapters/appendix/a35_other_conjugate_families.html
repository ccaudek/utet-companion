<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Appendice J — Altre famiglie coniugate – Metodi bayesiani in psicologia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/appendix/a36_gamma_poisson_model.html" rel="next">
<link href="../../chapters/appendix/a15_calculus.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/appendix/a01_shell.html">Appendices</a></li><li class="breadcrumb-item"><a href="../../chapters/appendix/a35_other_conjugate_families.html"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Metodi bayesiani in psicologia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/utet-companion/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Struttura del companion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefazione</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#perch%C3%A9-scegliere-una-distribuzione-normale" id="toc-perché-scegliere-una-distribuzione-normale" class="nav-link active" data-scroll-target="#perch%C3%A9-scegliere-una-distribuzione-normale"><span class="header-section-number">J.1</span> Perché scegliere una distribuzione normale?</a></li>
  <li><a href="#inferenza-bayesiana-per-la-media-di-una-popolazione-normale-varianza-nota" id="toc-inferenza-bayesiana-per-la-media-di-una-popolazione-normale-varianza-nota" class="nav-link" data-scroll-target="#inferenza-bayesiana-per-la-media-di-una-popolazione-normale-varianza-nota"><span class="header-section-number">J.2</span> Inferenza bayesiana per la media di una popolazione normale (varianza nota)</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/utet-companion/blob/main/chapters/appendix/a35_other_conjugate_families.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-companion/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/appendix/a01_shell.html">Appendices</a></li><li class="breadcrumb-item"><a href="../../chapters/appendix/a35_other_conjugate_families.html"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-bayesian-inference-conjugate-2" class="quarto-section-identifier">Appendice J — Altre famiglie coniugate</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Nei capitoli precedenti abbiamo visto come il concetto di <strong>coniugazione</strong> renda particolarmente semplice l’aggiornamento bayesiano. L’esempio Beta–Binomiale ci ha permesso di osservare in modo diretto come i parametri della distribuzione vengano modificati dai dati senza cambiare la forma della distribuzione stessa.</p>
<p>In questa appendice presentiamo altri casi di famiglie coniugate, meno immediati ma ugualmente interessanti. L’obiettivo non è memorizzare formule o cataloghi di distribuzioni, ma cogliere un principio generale: <strong>in alcune situazioni fortunate, i calcoli bayesiani diventano particolarmente trasparenti, perché il posterior appartiene alla stessa famiglia della prior</strong>.</p>
<p>Dal punto di vista della ricerca psicologica, non è indispensabile padroneggiare tutti questi casi. Nella pratica, la maggior parte dei modelli che incontreremo non ammetterà una forma coniugata, e dovremo ricorrere a metodi computazionali generali come il campionamento MCMC. Tuttavia, conoscere queste famiglie ha due vantaggi didattici:</p>
<ul>
<li>permette di consolidare l’intuizione su come i dati aggiornano i parametri, in contesti diversi da quello binomiale;</li>
<li>aiuta a riconoscere situazioni in cui i calcoli possono essere svolti senza simulazioni, facilitando l’analisi.</li>
</ul>
<p>Se è la prima volta che affronti questi argomenti, puoi leggere questa sezione in modo rapido, come un approfondimento facoltativo. Nei capitoli successivi torneremo a concentrarci sui metodi computazionali, che costituiscono lo strumento essenziale per affrontare i problemi psicologici reali.</p>
<section id="panoramica-del-capitolo" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="panoramica-del-capitolo">Panoramica del capitolo</h2>
<ul>
<li>Introdurre il modello Normale-Normale come esempio di famiglia coniugata.</li>
<li>Mostrare come combinare prior e verosimiglianza per ottenere la distribuzione a posteriori.<br>
</li>
<li>Calcolare media e varianza a posteriori in forma chiusa.</li>
<li>Interpretare il ruolo relativo di prior e dati nell’aggiornamento bayesiano.<br>
</li>
<li>Applicare il modello a casi concreti (tempi di reazione, punteggi di QI).</li>
</ul>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Conjugate Families</em> del testo di <span class="citation" data-cites="Johnson2022bayesrules">Johnson et al. (<a href="#ref-Johnson2022bayesrules" role="doc-biblioref">2022</a>)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">mice</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="perché-scegliere-una-distribuzione-normale" class="level2" data-number="J.1"><h2 data-number="J.1" class="anchored" data-anchor-id="perché-scegliere-una-distribuzione-normale">
<span class="header-section-number">J.1</span> Perché scegliere una distribuzione normale?</h2>
<p>La scelta di una distribuzione a priori (e di una verosimiglianza) Normale offre numerosi vantaggi, sia dal punto di vista teorico che pratico:</p>
<ol type="1">
<li><p><strong>Simmetria e Adattabilità</strong>: La caratteristica forma “a campana” e simmetrica della distribuzione Normale ben si adatta a descrivere molti fenomeni naturali, psicologici e cognitivi, come i tempi di reazione, i punteggi di abilità, o gli errori di misurazione. Questa simmetria facilita l’interpretazione della media <span class="math inline">\(\mu\)</span> come misura di tendenza centrale e della varianza <span class="math inline">\(\sigma^2\)</span> come misura della dispersione o incertezza.</p></li>
<li><p><strong>Efficienza Parametrica</strong>: Nel modello Normale-Normale con varianza nota, l’incertezza sulla media <span class="math inline">\(\mu\)</span> nella distribuzione a priori è descritta dal singolo parametro <span class="math inline">\(\sigma_0^2\)</span> (la varianza della prior). Analogamente, la variabilità dei dati è descritta da <span class="math inline">\(\sigma^2\)</span>. Questa parsimonia parametrica semplifica sia la fase di modellizzazione sia la comunicazione dei risultati.</p></li>
<li><p><strong>Convergenza con l’Inferenza Classica</strong>: Per campioni di dati sufficientemente ampi, le stime bayesiane ottenute con il modello Normale tendono a convergere verso quelle dell’inferenza frequentista. Questa proprietà, legata al teorema di Bernstein-von Mises, è talvolta indicata come <em>calibrazione asintotica</em> e fa sì che il modello Normale-Normale possa agire da ponte tra i due paradigmi inferenziali.</p></li>
<li><p><strong>Semplicità Computazionale</strong>: Le operazioni matematiche tra distribuzioni Normali (come il prodotto richiesto dal teorema di Bayes) risultano in un’altra distribuzione Normale. Questo permette di ottenere <em>soluzioni analitiche in forma chiusa</em> per i parametri della distribuzione a posteriori, evitando la necessità di ricorrere a metodi di approssimazione numerica complessi, come le simulazioni Monte Carlo Markov Chain (MCMC), almeno nei casi più semplici.</p></li>
</ol>
<p><strong>In sintesi</strong>: se le nostre conoscenze preliminari suggeriscono una distribuzione unimodale e simmetrica per il parametro di interesse, o se ci aspettiamo che la distribuzione a posteriori abbia tali caratteristiche (cosa spesso favorita dal Teorema del Limite Centrale quando si ha un campione ampio), la distribuzione Normale rappresenta una scelta robusta, elegante e computazionalmente vantaggiosa per condurre un’inferenza rigorosa.</p>
</section><section id="inferenza-bayesiana-per-la-media-di-una-popolazione-normale-varianza-nota" class="level2" data-number="J.2"><h2 data-number="J.2" class="anchored" data-anchor-id="inferenza-bayesiana-per-la-media-di-una-popolazione-normale-varianza-nota">
<span class="header-section-number">J.2</span> Inferenza bayesiana per la media di una popolazione normale (varianza nota)</h2>
<p>Immaginiamo di voler stimare il tempo medio di reazione <span class="math inline">\(\mu\)</span> (in millisecondi, ms) di una popolazione di studenti impegnati in un compito Stroop. Supponiamo di aver raccolto i tempi di reazione <span class="math inline">\(y_1, \dots, y_n\)</span> da un campione di <span class="math inline">\(n\)</span> studenti. Assumiamo che questi dati provengano da una distribuzione Normale <span class="math inline">\(y_i \sim \mathcal{N}(\mu, \sigma^2)\)</span> e, per semplificare inizialmente il modello, <em>assumiamo che la varianza <span class="math inline">\(\sigma^2\)</span> della popolazione sia nota</em> (ad esempio, da studi precedenti o dalla natura standardizzata del compito). Sia <span class="math inline">\(\sigma = 50\)</span> ms la deviazione standard nota.</p>
<section id="i-tre-passi-fondamentali-dellinferenza-bayesiana" class="level3" data-number="J.2.1"><h3 data-number="J.2.1" class="anchored" data-anchor-id="i-tre-passi-fondamentali-dellinferenza-bayesiana">
<span class="header-section-number">J.2.1</span> I tre passi fondamentali dell’inferenza bayesiana</h3>
<p>Il processo di inferenza bayesiana si articola nei seguenti passaggi chiave:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 40%">
<col style="width: 41%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Passo</th>
<th style="text-align: left;">Significato Intuitivo</th>
<th style="text-align: left;">Formalizzazione Matematica (Modello Normale-Normale)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>A. Distribuzione a Priori</strong></td>
<td style="text-align: left;">Le nostre convinzioni iniziali sulla media <span class="math inline">\(\mu\)</span>.</td>
<td style="text-align: left;"><span class="math inline">\(\mu \sim \mathcal{N}(\mu_0, \sigma_0^2)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>B. Verosimiglianza dei Dati</strong></td>
<td style="text-align: left;">L’informazione su <span class="math inline">\(\mu\)</span> contenuta nei dati osservati.</td>
<td style="text-align: left;"><span class="math inline">\(y_i \stackrel{\text{iid}}{\sim} \mathcal{N}(\mu, \sigma^2)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>C. Distribuzione a Posteriori</strong></td>
<td style="text-align: left;">Le nostre convinzioni aggiornate su <span class="math inline">\(\mu\)</span> dopo i dati.</td>
<td style="text-align: left;"><span class="math inline">\(\mu \mid \mathbf{y} \sim \mathcal{N}(\mu_p, \sigma_p^2)\)</span></td>
</tr>
</tbody>
</table>
<p>Quando la varianza <span class="math inline">\(\sigma^2\)</span> dei dati è nota e la prior per <span class="math inline">\(\mu\)</span> è Normale, la distribuzione Normale è <em>coniugata</em> per la media <span class="math inline">\(\mu\)</span>. Ciò significa che la distribuzione a posteriori per <span class="math inline">\(\mu\)</span> sarà anch’essa Normale, mantenendo la stessa forma funzionale attraverso l’aggiornamento bayesiano.</p>
</section><section id="distribuzione-a-priori" class="level3" data-number="J.2.2"><h3 data-number="J.2.2" class="anchored" data-anchor-id="distribuzione-a-priori">
<span class="header-section-number">J.2.2</span> Distribuzione a priori</h3>
<p><span class="math inline">\(\mu \sim \mathcal{N}(\mu_0,\sigma_0^2)\)</span>: descrive dove crediamo sia <span class="math inline">\(\mu\)</span> e quanta incertezza abbiamo, una varianza grande significa poca informazione.</p>
</section><section id="verosimiglianza" class="level3" data-number="J.2.3"><h3 data-number="J.2.3" class="anchored" data-anchor-id="verosimiglianza">
<span class="header-section-number">J.2.3</span> Verosimiglianza</h3>
<p><span class="math display">\[
p(y\mid\mu,\sigma)=\prod_{i=1}^{n}\frac{1}{\sigma\sqrt{2\pi}}
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \exp\!\Bigl[-\tfrac{(y_i-\mu)^2}{2\sigma^2}\Bigr].
\]</span></p>
</section><section id="teorema-di-bayes" class="level3" data-number="J.2.4"><h3 data-number="J.2.4" class="anchored" data-anchor-id="teorema-di-bayes">
<span class="header-section-number">J.2.4</span> Teorema di Bayes</h3>
<p>Il teorema di Bayes combina prior e verosimiglianza attraverso un prodotto ponderato:</p>
<p><span class="math display">\[
p(\mu\mid y)=\frac{p(y\mid\mu)\,p(\mu)}{p(y)} \;\; \propto\;\;
\underbrace{\mathcal{N}(\mu_0,\sigma_0^2)}_{\text{prior}}
\; \times \;
\underbrace{\mathcal{N}(\bar y,\sigma^2/n)}_{\text{verosimiglianza}} .
\]</span> Il prodotto di due distribuzioni gaussiane è una distribuzione gaussiana: basta <em>aggiornare media e varianza</em>.</p>
</section><section id="media-a-posteriori" class="level3" data-number="J.2.5"><h3 data-number="J.2.5" class="anchored" data-anchor-id="media-a-posteriori">
<span class="header-section-number">J.2.5</span> Media a posteriori</h3>
<p><span id="eq-post-normal-normal-mean"><span class="math display">\[
\mu_p=\frac{\tfrac{1}{\sigma_0^2}\,\mu_0 + \tfrac{n}{\sigma^2}\,\bar y}
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{\tfrac{1}{\sigma_0^2} + \tfrac{n}{\sigma^2}},
\qquad
\bar y=\frac{1}{n}\sum_{i=1}^{n}y_i.
\tag{J.1}\]</span></span></p>
<ul>
<li><p><span class="math inline">\(\mu_0\)</span>: l’idea iniziale.</p></li>
<li><p><span class="math inline">\(\sigma_0^2\)</span>: la fiducia in quell’idea.</p></li>
<li><p><span class="math inline">\(\bar y\)</span>: ciò che dicono i dati.</p></li>
<li><p><span class="math inline">\(n/\sigma^2\)</span>: la quantità di informazione empirica, aumenta con più casi e diminuisce con misure rumorose.</p></li>
<li>
<p><strong>Interpretazione:</strong> Il peso relativo di prior e dati dipende dalla loro credibilità:</p>
<ul>
<li>La prior è influente se ha alta precisione, ovvero 1/<span class="math inline">\(\sigma_0^2\)</span> è grande, o se ci sono pochi dati, <span class="math inline">\(n\)</span> piccolo.</li>
<li>I dati sono dominanti se la prior ha bassa precisione o se c’è un ampio campione.</li>
</ul>
</li>
</ul></section><section id="varianza-a-posteriori" class="level3" data-number="J.2.6"><h3 data-number="J.2.6" class="anchored" data-anchor-id="varianza-a-posteriori">
<span class="header-section-number">J.2.6</span> Varianza a posteriori</h3>
<p><span id="eq-post-normal-normal-var"><span class="math display">\[
\sigma_p^2=\frac{1}{\tfrac{1}{\sigma_0^2}+\tfrac{n}{\sigma^2}}.
\tag{J.2}\]</span></span></p>
<ul>
<li>
<strong>Proprietà Chiave:</strong> <span class="math inline">\(\sigma_p^2 \le \min(\sigma_0^2, \sigma^2/n)\)</span>. L’incertezza diminuisce monotonicamente all’aumentare di <span class="math inline">\(n\)</span>.</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esercizio 1.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supponiamo di voler stimare il tempo medio di reazione <span class="math inline">\(\mu\)</span> (in millisecondi) di un gruppo di studenti a un compito Stroop. Dalla letteratura o da esperienze precedenti, assumiamo che la deviazione standard dei tempi di reazione per questo tipo di compito sia <span class="math inline">\(\sigma = 50\)</span> ms.</p>
<p>Definiamo la nostra <em>distribuzione a priori</em> per <span class="math inline">\(\mu\)</span> basandoci su una nostra conoscenza preliminare o un’ipotesi plausibile. Ad esempio, potremmo ipotizzare che il tempo medio sia attorno ai 500 ms, con una certa incertezza: * Media a priori: <span class="math inline">\(\mu_0 = 500\)</span> ms * Deviazione standard a priori: <span class="math inline">\(\sigma_0 = 100\)</span> ms (quindi varianza a priori <span class="math inline">\(\sigma_0^2 = 100^2 = 10000\)</span>)</p>
<p>Successivamente, raccogliamo i dati da <span class="math inline">\(n=20\)</span> studenti e osserviamo una media campionaria dei tempi di reazione <span class="math inline">\(\bar{y} = 480\)</span> ms.</p>
<p>Riepilogo dei parametri:</p>
<table class="caption-top table">
<thead><tr class="header">
<th style="text-align: left;">Simbolo</th>
<th style="text-align: left;">Descrizione</th>
<th style="text-align: left;">Valore</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mu_0\)</span></td>
<td style="text-align: left;">Media a priori</td>
<td style="text-align: left;">500 ms</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma_0\)</span></td>
<td style="text-align: left;">Dev. std. a priori</td>
<td style="text-align: left;">100 ms</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma_0^2\)</span></td>
<td style="text-align: left;">Varianza a priori</td>
<td style="text-align: left;">10000 ms²</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;">Dev. std. dei dati (nota)</td>
<td style="text-align: left;">50 ms</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma^2\)</span></td>
<td style="text-align: left;">Varianza dei dati (nota)</td>
<td style="text-align: left;">2500 ms²</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(n\)</span></td>
<td style="text-align: left;">Numero di osservazioni</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\bar{y}\)</span></td>
<td style="text-align: left;">Media campionaria osservata</td>
<td style="text-align: left;">480 ms</td>
</tr>
</tbody>
</table>
<p><strong>1. Calcolo delle Precisioni (Pesi):</strong></p>
<ul>
<li>Precisione a priori: <span class="math inline">\(w_0 = \frac{1}{\sigma_0^2} = \frac{1}{100^2} = \frac{1}{10000} = 0.0001\)</span>
</li>
<li>Precisione dei dati: <span class="math inline">\(w_{\text{dati}} = \frac{n}{\sigma^2} = \frac{20}{50^2} = \frac{20}{2500} = 0.008\)</span>
</li>
</ul>
<p><strong>2. Calcolo della Media a Posteriori (<span class="math inline">\(\mu_n\)</span>):</strong> <span class="math display">\[ \mu_n = \frac{w_0 \mu_0 + w_{\text{dati}} \bar{y}}{w_0 + w_{\text{dati}}} = \frac{0.0001 \times 500 + 0.008 \times 480}{0.0001 + 0.008} = \frac{0.05 + 3.84}{0.0081} = \frac{3.89}{0.0081} \approx 480.247 \text{ ms} \]</span></p>
<p><strong>3. Calcolo della Varianza a Posteriori (<span class="math inline">\(\sigma_n^2\)</span>):</strong> <span class="math display">\[ \sigma_n^2 = \frac{1}{w_0 + w_{\text{dati}}} = \frac{1}{0.0001 + 0.008} = \frac{1}{0.0081} \approx 123.457 \text{ ms}^2 \]</span> La deviazione standard a posteriori è <span class="math inline">\(\sigma_n = \sqrt{\sigma_n^2} \approx \sqrt{123.457} \approx 11.11 \text{ ms}\)</span>.</p>
<p><strong>Risultato e Interpretazione:</strong> Siamo partiti da una stima a priori di <span class="math inline">\(\mu \approx 500 \pm 100\)</span> ms. Dopo aver osservato 20 tempi di reazione con una media di 480 ms (e sapendo che <span class="math inline">\(\sigma=50\)</span> ms), la nostra stima aggiornata per la media dei tempi di reazione è <span class="math inline">\(\mu_n \approx 480.25 \pm 11.11\)</span> ms. Notiamo che la media a posteriori (480.25 ms) è molto più vicina alla media campionaria (480 ms) che alla media a priori (500 ms). Questo perché la precisione dei dati (0.008) è significativamente maggiore della precisione a priori (0.0001). Inoltre, la nostra incertezza si è drasticamente ridotta: la deviazione standard è passata da 100 ms a circa 11 ms dopo sole 20 osservazioni. Questo illustra il potere dell’aggiornamento bayesiano nel raffinare le nostre stime e ridurre l’incertezza.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ---- Parametri dell'esempio -------------------------------------------</span></span>
<span><span class="va">mu0</span>    <span class="op">&lt;-</span> <span class="fl">500</span>   <span class="co"># Media a priori</span></span>
<span><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="fl">100</span>   <span class="co"># Deviazione standard a priori</span></span>
<span><span class="va">sigma</span>  <span class="op">&lt;-</span> <span class="fl">50</span>    <span class="co"># Deviazione standard nota dei dati</span></span>
<span><span class="va">n</span>      <span class="op">&lt;-</span> <span class="fl">20</span>    <span class="co"># Dimensione del campione</span></span>
<span><span class="va">ybar</span>   <span class="op">&lt;-</span> <span class="fl">480</span>   <span class="co"># Media campionaria osservata</span></span>
<span></span>
<span><span class="co"># ---- Calcolo dei parametri a posteriori -------------------------------</span></span>
<span><span class="co"># Precisioni</span></span>
<span><span class="va">prec_prior</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">sigma0</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">prec_data</span>  <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Parametri posteriori</span></span>
<span><span class="va">sigma_p2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">prec_prior</span> <span class="op">+</span> <span class="va">prec_data</span><span class="op">)</span>  <span class="co"># Varianza a posteriori</span></span>
<span><span class="va">sigma_p</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma_p2</span><span class="op">)</span>                <span class="co"># Deviazione standard a posteriori</span></span>
<span><span class="va">mu_p</span>     <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu0</span> <span class="op">*</span> <span class="va">prec_prior</span> <span class="op">+</span> <span class="va">ybar</span> <span class="op">*</span> <span class="va">prec_data</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">prec_prior</span> <span class="op">+</span> <span class="va">prec_data</span><span class="op">)</span> <span class="co"># Media a posteriori</span></span>
<span></span>
<span><span class="co"># ---- Griglia di valori per il parametro mu -----------------------------</span></span>
<span><span class="co"># Definiamo un range che copra bene tutte e tre le distribuzioni</span></span>
<span><span class="va">min_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mu0</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma0</span>, <span class="va">ybar</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">mu_p</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma_p</span><span class="op">)</span></span>
<span><span class="va">max_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mu0</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma0</span>, <span class="va">ybar</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">mu_p</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma_p</span><span class="op">)</span></span>
<span><span class="va">mu_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">min_mu</span>, <span class="va">max_mu</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Calcolo delle densità delle tre curve -----------------------------</span></span>
<span><span class="va">prior_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid</span>, mean <span class="op">=</span> <span class="va">mu0</span>,  sd <span class="op">=</span> <span class="va">sigma0</span><span class="op">)</span>            <span class="co"># Densità a priori</span></span>
<span><span class="va">post_dens</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid</span>, mean <span class="op">=</span> <span class="va">mu_p</span>, sd <span class="op">=</span> <span class="va">sigma_p</span><span class="op">)</span>           <span class="co"># Densità a posteriori</span></span>
<span></span>
<span><span class="co"># Verosimiglianza (standardizzata per mu, basata sulla media campionaria)</span></span>
<span><span class="co"># La sd per la verosimiglianza di mu è sigma/sqrt(n)</span></span>
<span><span class="va">lik_dens_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid</span>, mean <span class="op">=</span> <span class="va">ybar</span>, sd <span class="op">=</span> <span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Riscaliamo la verosimiglianza per renderla graficamente confrontabile con la prior</span></span>
<span><span class="co"># Questo è solo per visualizzazione, la verosimiglianza non è una densità per mu in senso stretto</span></span>
<span><span class="va">lik_dens_scaled</span> <span class="op">&lt;-</span> <span class="va">lik_dens_raw</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">prior_dens</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lik_dens_raw</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Preparazione dati in formato "lungo" per ggplot2 ------------------</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  mu         <span class="op">=</span> <span class="va">mu_grid</span>,</span>
<span>  Prior      <span class="op">=</span> <span class="va">prior_dens</span>,</span>
<span>  Likelihood_scaled <span class="op">=</span> <span class="va">lik_dens_scaled</span>, <span class="co"># Usiamo quella riscalata</span></span>
<span>  Posterior  <span class="op">=</span> <span class="va">post_dens</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_long</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df</span>, <span class="op">-</span><span class="va">mu</span>, names_to <span class="op">=</span> <span class="st">"Distribuzione"</span>, values_to <span class="op">=</span> <span class="st">"Densita"</span><span class="op">)</span></span>
<span><span class="va">df_long</span><span class="op">$</span><span class="va">Distribuzione</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df_long</span><span class="op">$</span><span class="va">Distribuzione</span>, </span>
<span>                                levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"Likelihood_scaled"</span>, <span class="st">"Posterior"</span><span class="op">)</span>,</span>
<span>                                labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A Priori"</span>, <span class="st">"Verosimiglianza (riscalata)"</span>, <span class="st">"A Posteriori"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># ---- Grafico delle distribuzioni ---------------------------------------</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_long</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mu</span>, y <span class="op">=</span> <span class="va">Densita</span>, colour <span class="op">=</span> <span class="va">Distribuzione</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Media dei Tempi di Reazione "</span>, <span class="va">mu</span>, <span class="st">" (ms)"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y      <span class="op">=</span> <span class="st">"Densità"</span>,</span>
<span>    title  <span class="op">=</span> <span class="st">"Aggiornamento Bayesiano: dal Prior al Posteriori"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Prior: N("</span>, <span class="va">mu0</span>, <span class="st">", "</span>, <span class="va">sigma0</span><span class="op">^</span><span class="fl">2</span>, <span class="st">"), "</span>,</span>
<span>                      <span class="st">"Verosimiglianza (per μ): N("</span>, <span class="va">ybar</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">"), "</span>,</span>
<span>                      <span class="st">"Posteriori: N("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mu_p</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sigma_p2</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A Priori"</span> <span class="op">=</span> <span class="st">"dodgerblue"</span>, </span>
<span>                                <span class="st">"Verosimiglianza (riscalata)"</span> <span class="op">=</span> <span class="st">"forestgreen"</span>, </span>
<span>                                <span class="st">"A Posteriori"</span> <span class="op">=</span> <span class="st">"orangered"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-stroop" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-stroop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a35_other_conjugate_families_files/figure-html/fig-stroop-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-stroop-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;J.1: Distribuzioni a priori, verosimiglianza (standardizzata e riscalata) e a posteriori per la media dei tempi di reazione (μ).
</figcaption></figure>
</div>
</div>
</div>
<p>Il grafico <a href="#fig-stroop" class="quarto-xref">Figura&nbsp;<span>J.1</span></a> illustra chiaramente come la distribuzione a posteriori sia “spostata” verso la verosimiglianza (che è più informativa della prior in questo caso) e come la sua varianza sia notevolmente ridotta rispetto a entrambe.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Messaggi chiave sull’inferenza con varianza nota
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Dialogo Costruttivo: L’inferenza bayesiana è un processo dinamico di dialogo tra le nostre ipotesi iniziali (prior) e l’evidenza empirica (dati/verosimiglianza).</li>
<li>Calcoli Trasparenti: Con la varianza della popolazione <span class="math inline">\(\sigma^2\)</span> nota, i calcoli per la media e la varianza a posteriori sono diretti e possono essere eseguiti analiticamente (anche “a mano” per esempi semplici).</li>
<li>Riduzione Garantita dell’Incertezza: Dopo aver osservato i dati, l’incertezza sul parametro (misurata dalla varianza a posteriori) non può che diminuire o, al limite, rimanere uguale (caso teorico di dati non informativi), rispetto alla varianza a priori.</li>
<li>Peso dell’Evidenza: Con pochi dati o dati molto “rumorosi” (alta <span class="math inline">\(\sigma^2\)</span>), la distribuzione a priori esercita un’influenza maggiore sulla stima finale. Con molti dati o dati molto precisi (bassa <span class="math inline">\(\sigma^2\)</span>), l’informazione proveniente dai dati tende a dominare, e l’influenza della prior sulla stima a posteriori diminuisce.</li>
<li>Applicabilità Vasta: Lo schema concettuale e matematico del modello Normale-Normale si applica a una vasta gamma di problemi in diverse discipline, inclusa la psicologia sperimentale (es. tempi di reazione, punteggi a test, ampiezze di segnali EEG), l’ingegneria, l’economia, e molte altre aree dove si misurano quantità continue. :::</li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esercizio 2.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>I test standard di Quoziente Intellettivo (QI) sono generalmente calibrati per avere una media di 100 e una deviazione standard di 15 nella popolazione di riferimento. Tuttavia, sono state sollevate questioni riguardo a possibili bias culturali che potrebbero favorire alcuni gruppi rispetto ad altri. Un’ulteriore complicazione sorge quando i punteggi QI vengono aggregati a livello nazionale, poiché le medie nazionali possono mascherare eterogeneità intra-paese significative.</p>
<p>Questo esempio, ispirato da <span class="citation" data-cites="gill2015bayesian">Gill (<a href="#ref-gill2015bayesian" role="doc-biblioref">2015</a>)</span> (che discute i dati di Lynn e Vanhanen, 2001), analizza i dati di QI medio riportati per 80 nazioni. L’obiettivo è stimare un QI medio “globale” <span class="math inline">\(\mu\)</span> utilizzando un approccio bayesiano Normale-Normale, e riflettere criticamente sul risultato.</p>
<p>Assumiamo una deviazione standard nota <span class="math inline">\(\sigma = 15\)</span> per i punteggi QI (questa è una semplificazione, poiché la variabilità delle medie nazionali potrebbe essere diversa dalla variabilità individuale).</p>
<p>I dati di QI medio per <span class="math inline">\(n=80\)</span> nazioni sono forniti di seguito:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 19%">
<col style="width: 5%">
</colgroup>
<thead><tr class="header">
<th>Paese</th>
<th>IQ</th>
<th>Paese</th>
<th>IQ</th>
<th>Paese</th>
<th>IQ</th>
<th>Paese</th>
<th>IQ</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Argentina</td>
<td>96</td>
<td>Australia</td>
<td>98</td>
<td>Austria</td>
<td>102</td>
<td>Barbados</td>
<td>78</td>
</tr>
<tr class="even">
<td>Belgium</td>
<td>100</td>
<td>Brazil</td>
<td>87</td>
<td>Bulgaria</td>
<td>93</td>
<td>Canada</td>
<td>97</td>
</tr>
<tr class="odd">
<td>China</td>
<td>100</td>
<td>Congo (Br.)</td>
<td>73</td>
<td>Congo (Zr.)</td>
<td>65</td>
<td>Croatia</td>
<td>90</td>
</tr>
<tr class="even">
<td>Cuba</td>
<td>85</td>
<td>Czech Repub.</td>
<td>97</td>
<td>Denmark</td>
<td>98</td>
<td>Ecuador</td>
<td>80</td>
</tr>
<tr class="odd">
<td>Egypt</td>
<td>83</td>
<td>Eq. Guinea</td>
<td>59</td>
<td>Ethiopia</td>
<td>63</td>
<td>Fiji</td>
<td>84</td>
</tr>
<tr class="even">
<td>Finland</td>
<td>97</td>
<td>France</td>
<td>98</td>
<td>Germany</td>
<td>102</td>
<td>Ghana</td>
<td>71</td>
</tr>
<tr class="odd">
<td>Greece</td>
<td>92</td>
<td>Guatemala</td>
<td>79</td>
<td>Guinea</td>
<td>66</td>
<td>Hong Kong</td>
<td>107</td>
</tr>
<tr class="even">
<td>Hungary</td>
<td>99</td>
<td>India</td>
<td>81</td>
<td>Indonesia</td>
<td>89</td>
<td>Iran</td>
<td>84</td>
</tr>
<tr class="odd">
<td>Iraq</td>
<td>87</td>
<td>Ireland</td>
<td>93</td>
<td>Israel</td>
<td>94</td>
<td>Italy</td>
<td>102</td>
</tr>
<tr class="even">
<td>Jamaica</td>
<td>72</td>
<td>Japan</td>
<td>105</td>
<td>Kenya</td>
<td>72</td>
<td>Korea (S.)</td>
<td>106</td>
</tr>
<tr class="odd">
<td>Lebanon</td>
<td>86</td>
<td>Malaysia</td>
<td>92</td>
<td>Marshall I.</td>
<td>84</td>
<td>Mexico</td>
<td>87</td>
</tr>
<tr class="even">
<td>Morocco</td>
<td>85</td>
<td>Nepal</td>
<td>78</td>
<td>Netherlands</td>
<td>102</td>
<td>New Zealand</td>
<td>100</td>
</tr>
<tr class="odd">
<td>Nigeria</td>
<td>67</td>
<td>Norway</td>
<td>98</td>
<td>Peru</td>
<td>90</td>
<td>Philippines</td>
<td>86</td>
</tr>
<tr class="even">
<td>Poland</td>
<td>99</td>
<td>Portugal</td>
<td>95</td>
<td>Puerto Rico</td>
<td>84</td>
<td>Qatar</td>
<td>78</td>
</tr>
<tr class="odd">
<td>Romania</td>
<td>94</td>
<td>Russia</td>
<td>96</td>
<td>Samoa</td>
<td>87</td>
<td>Sierra Leone</td>
<td>64</td>
</tr>
<tr class="even">
<td>Singapore</td>
<td>103</td>
<td>Slovakia</td>
<td>96</td>
<td>Slovenia</td>
<td>95</td>
<td>South Africa</td>
<td>72</td>
</tr>
<tr class="odd">
<td>Spain</td>
<td>97</td>
<td>Sudan</td>
<td>72</td>
<td>Suriname</td>
<td>89</td>
<td>Sweden</td>
<td>101</td>
</tr>
<tr class="even">
<td>Switzerland</td>
<td>101</td>
<td>Taiwan</td>
<td>104</td>
<td>Tanzania</td>
<td>72</td>
<td>Thailand</td>
<td>91</td>
</tr>
<tr class="odd">
<td>Tonga</td>
<td>87</td>
<td>Turkey</td>
<td>90</td>
<td>Uganda</td>
<td>73</td>
<td>U.K.</td>
<td>100</td>
</tr>
<tr class="even">
<td>U.S.</td>
<td>98</td>
<td>Uruguay</td>
<td>96</td>
<td>Zambia</td>
<td>77</td>
<td>Zimbabwe</td>
<td>66</td>
</tr>
</tbody>
</table>
<p>Impostazione del Modello Bayesiano:</p>
<ol type="1">
<li>Prior per <span class="math inline">\(\mu\)</span>: Stabiliamo una prior basata sulla standardizzazione tipica dei test QI:</li>
</ol>
<ul>
<li>
<span class="math inline">\(\mu_0 = 100\)</span> (media a priori)</li>
<li>
<span class="math inline">\(\sigma_0 = 15\)</span> (deviazione standard a priori, che riflette una certa incertezza sulla media globale, o la stessa scala della <span class="math inline">\(\sigma\)</span> individuale). Quindi, <span class="math inline">\(\mu \sim \mathcal{N}(100, 15^2)\)</span>.</li>
</ul>
<ol start="2" type="1">
<li>Verosimiglianza: Ogni QI nazionale <span class="math inline">\(y_i\)</span> è considerato come un’osservazione della media “vera” <span class="math inline">\(\mu\)</span> con varianza <span class="math inline">\(\sigma^2 = 15^2\)</span>. La media campionaria dei QI nazionali sarà <span class="math inline">\(\bar{y}\)</span>.</li>
</ol>
<p>(Nota: Questa è una semplificazione. Idealmente, ogni <span class="math inline">\(y_i\)</span> è già una media, e dovremmo considerare la sua precisione <span class="math inline">\(N_i/\sigma^2\)</span> se <span class="math inline">\(N_i\)</span> fosse la dimensione del campione per quella nazione. Qui, trattiamo ogni media nazionale come un singolo dato <span class="math inline">\(y_i\)</span> proveniente da <span class="math inline">\(\mathcal{N}(\mu, \sigma^2)\)</span>).</p>
<p>Implementiamo le informazioni necessarie in R.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Dati IQ delle 80 nazioni (valori aggregati per paese)</span></span>
<span><span class="va">iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">96</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">85</span>, <span class="fl">83</span>, <span class="fl">97</span>, <span class="fl">92</span>, <span class="fl">99</span>, <span class="fl">87</span>, <span class="fl">72</span>, <span class="fl">86</span>, <span class="fl">85</span>, <span class="fl">67</span>, <span class="fl">99</span>, <span class="fl">94</span>, <span class="fl">103</span>, <span class="fl">97</span>, <span class="fl">101</span>, </span>
<span>  <span class="fl">87</span>, <span class="fl">98</span>, <span class="fl">87</span>, <span class="fl">73</span>, <span class="fl">97</span>, <span class="fl">59</span>, <span class="fl">98</span>, <span class="fl">79</span>, <span class="fl">81</span>, <span class="fl">93</span>, <span class="fl">105</span>, <span class="fl">92</span>, <span class="fl">78</span>, <span class="fl">98</span>, <span class="fl">95</span>, <span class="fl">96</span>, <span class="fl">72</span>, <span class="fl">104</span>, </span>
<span>  <span class="fl">90</span>, <span class="fl">96</span>, <span class="fl">98</span>, <span class="fl">102</span>, <span class="fl">78</span>, <span class="fl">90</span>, <span class="fl">63</span>, <span class="fl">84</span>, <span class="fl">84</span>, <span class="fl">107</span>, <span class="fl">86</span>, <span class="fl">102</span>, <span class="fl">106</span>, <span class="fl">94</span>, <span class="fl">102</span>, <span class="fl">72</span>, <span class="fl">101</span>, </span>
<span>  <span class="fl">89</span>, <span class="fl">72</span>, <span class="fl">101</span>, <span class="fl">91</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">66</span>, <span class="fl">107</span>, <span class="fl">86</span>, <span class="fl">78</span>, <span class="fl">84</span>, <span class="fl">78</span>, <span class="fl">64</span>, <span class="fl">72</span>, <span class="fl">101</span>, <span class="fl">91</span>, <span class="fl">100</span>, </span>
<span>  <span class="fl">67</span>, <span class="fl">86</span></span>
<span><span class="op">)</span> <span class="co"># Dati da Lynn e Vanhanen (2001) come presentati in Gill (2015)</span></span>
<span></span>
<span><span class="co"># Numero di osservazioni (nazioni)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Media campionaria dei QI nazionali</span></span>
<span><span class="va">y_bar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">iq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Deviazione standard assunta nota (per la "popolazione" da cui provengono le medie nazionali)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="co"># Parametri a priori</span></span>
<span><span class="va">mu_0</span> <span class="op">&lt;-</span> <span class="fl">100</span>    <span class="co"># Media a priori</span></span>
<span><span class="va">sigma_0</span> <span class="op">&lt;-</span> <span class="fl">15</span>  <span class="co"># Dev. std. a priori</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Numero di nazioni (n):"</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Numero di nazioni (n): 72</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"\nMedia campionaria dei QI nazionali (y_bar):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y_bar</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Media campionaria dei QI nazionali (y_bar): 89.21</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Calcolo dei parametri a posteriori:</strong></p>
<p>Utilizziamo le formule derivate precedentemente:</p>
<p><span class="math display">\[\mu_n = \frac{\frac{1}{\sigma_0^2}\mu_0 + \frac{n}{\sigma^2}\bar{y}}{\frac {1}{\sigma_0^2} + \frac{n}{\sigma^2}}
\]</span></p>
<p><span class="math display">\[
\sigma_n^2 = \frac{1}{\frac {1}{\sigma_0^2}+ \frac{n}{\sigma^2}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Precisioni</span></span>
<span><span class="va">prec_prior_iq</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">sigma_0</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">prec_data_iq</span>  <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">/</span> <span class="va">sigma</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># Parametri posteriori</span></span>
<span><span class="va">mu_p_iq</span>     <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mu_0</span> <span class="op">*</span> <span class="va">prec_prior_iq</span> <span class="op">+</span> <span class="va">y_bar</span> <span class="op">*</span> <span class="va">prec_data_iq</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">prec_prior_iq</span> <span class="op">+</span> <span class="va">prec_data_iq</span><span class="op">)</span></span>
<span><span class="va">sigma_p_sq_iq</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="va">prec_prior_iq</span> <span class="op">+</span> <span class="va">prec_data_iq</span><span class="op">)</span></span>
<span><span class="va">sigma_p_iq</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma_p_sq_iq</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Media a posteriori (mu_n):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mu_p_iq</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Media a posteriori (mu_n): 89.36</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"\nVarianza a posteriori (sigma_n^2):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sigma_p_sq_iq</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Varianza a posteriori (sigma_n^2): 3.08</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"\nDeviazione standard a posteriori (sigma_n):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sigma_p_iq</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviazione standard a posteriori (sigma_n): 1.76</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Generiamo una rappresentazione grafica della distribuzione a posteriori della media del IQ sulla base dei dati osservati, avendo assunto <code>mu_0</code> = 100 e <code>sigma_0</code> = 15 per la distribuzione a priori.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Definizione dei valori sull'asse x per il grafico della posteriori</span></span>
<span><span class="va">x_qi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">mu_p_iq</span> <span class="op">-</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">sigma_p_iq</span>, <span class="va">mu_p_iq</span> <span class="op">+</span> <span class="fl">4</span> <span class="op">*</span> <span class="va">sigma_p_iq</span>, length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo della densità di probabilità per la posteriori</span></span>
<span><span class="va">pdf_qi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x_qi</span>, mean <span class="op">=</span> <span class="va">mu_p_iq</span>, sd <span class="op">=</span> <span class="va">sigma_p_iq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creazione del grafico</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_qi</span>, pdf <span class="op">=</span> <span class="va">pdf_qi</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">pdf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkslateblue"</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_area</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkslateblue"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Media 'Globale' del Quoziente di Intelligenza (μ)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità di Probabilità"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Distribuzione a Posteriori del QI Medio Globale"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Posteriori: N("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mu_p_iq</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sigma_p_sq_iq</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-qi-posterior" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-qi-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="a35_other_conjugate_families_files/figure-html/fig-qi-posterior-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-qi-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;J.2: Distribuzione a posteriori per la media ‘globale’ del QI (μ), basata sui dati di 80 nazioni.
</figcaption></figure>
</div>
</div>
</div>
<p>Per completezza, visualizziamo anche prior, likelihood e posterior:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mu_grid_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mu_0</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma_0</span>, <span class="va">y_bar</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">mu_p_iq</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma_p_iq</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mu_0</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma_0</span>, <span class="va">y_bar</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="va">mu_p_iq</span> <span class="op">+</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">sigma_p_iq</span><span class="op">)</span>,</span>
<span>  length.out <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">prior_dens_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid_iq</span>, mean <span class="op">=</span> <span class="va">mu_0</span>, sd <span class="op">=</span> <span class="va">sigma_0</span><span class="op">)</span></span>
<span><span class="va">lik_dens_raw_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid_iq</span>, mean <span class="op">=</span> <span class="va">y_bar</span>, sd <span class="op">=</span> <span class="va">sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="co"># SD della media campionaria</span></span>
<span><span class="va">lik_dens_scaled_iq</span> <span class="op">&lt;-</span> <span class="va">lik_dens_raw_iq</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">prior_dens_iq</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lik_dens_raw_iq</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="co"># Scalata</span></span>
<span><span class="va">post_dens_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">mu_grid_iq</span>, mean <span class="op">=</span> <span class="va">mu_p_iq</span>, sd <span class="op">=</span> <span class="va">sigma_p_iq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_iq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  mu <span class="op">=</span> <span class="va">mu_grid_iq</span>,</span>
<span>  Prior <span class="op">=</span> <span class="va">prior_dens_iq</span>,</span>
<span>  Likelihood_scaled <span class="op">=</span> <span class="va">lik_dens_scaled_iq</span>,</span>
<span>  Posterior <span class="op">=</span> <span class="va">post_dens_iq</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_long_iq</span> <span class="op">&lt;-</span> <span class="fu">pivot_longer</span><span class="op">(</span><span class="va">df_iq</span>, <span class="op">-</span><span class="va">mu</span>, names_to <span class="op">=</span> <span class="st">"Distribuzione"</span>, values_to <span class="op">=</span> <span class="st">"Densita"</span><span class="op">)</span></span>
<span><span class="va">df_long_iq</span><span class="op">$</span><span class="va">Distribuzione</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df_long_iq</span><span class="op">$</span><span class="va">Distribuzione</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Prior"</span>, <span class="st">"Likelihood_scaled"</span>, <span class="st">"Posterior"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A Priori"</span>, <span class="st">"Verosimiglianza (riscalata)"</span>, <span class="st">"A Posteriori"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_long_iq</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mu</span>, y <span class="op">=</span> <span class="va">Densita</span>, colour <span class="op">=</span> <span class="va">Distribuzione</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Media QI "</span>, <span class="va">mu</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Aggiornamento Bayesiano per il QI Medio 'Globale'"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"Prior: N("</span>, <span class="va">mu_0</span>, <span class="st">", "</span>, <span class="va">sigma_0</span><span class="op">^</span><span class="fl">2</span>, <span class="st">"), "</span>,</span>
<span>      <span class="st">"Verosimiglianza (per μ): N("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">y_bar</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"), "</span>,</span>
<span>      <span class="st">"Posteriori: N("</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">mu_p_iq</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">", "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">sigma_p_sq_iq</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">")"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"A Priori"</span> <span class="op">=</span> <span class="st">"dodgerblue"</span>,</span>
<span>    <span class="st">"Verosimiglianza (riscalata)"</span> <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>    <span class="st">"A Posteriori"</span> <span class="op">=</span> <span class="st">"orangered"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="a35_other_conjugate_families_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Discussione critica dei risultati</strong></p>
<p>L’analisi bayesiana ha prodotto una media a posteriori per il QI “globale” di <span class="math inline">\(\mu_n \approx 89.36\)</span>, con una deviazione standard a posteriori molto piccola (<span class="math inline">\(\sigma_n \approx 1.66\)</span>). Questo valore è notevolmente inferiore alla media standard di 100.</p>
<p>Tuttavia, è cruciale interpretare questo risultato con estrema cautela, considerando diversi fattori limitanti e criticità:</p>
<ul>
<li>
<strong>Effetto di Aggregazione (Ecological Fallacy):</strong> La media a posteriori è calcolata aggregando i dati QI medi di 80 nazioni. Questa media aggregata potrebbe non riflettere accuratamente la distribuzione del QI a livello individuale all’interno delle singole nazioni, né la vera distribuzione “globale” se si potessero testare tutti gli individui. Le differenze significative tra le nazioni (in termini di medie, varianze, e contesti socio-culturali) vengono “appiattite” in un unico valore, potenzialmente mascherando eterogeneità importanti.</li>
<li>
<strong>Dati Non Ponderati:</strong> L’analisi tratta ogni nazione come un’singola osservazione, indipendentemente dalla sua popolazione. Nazioni con popolazioni molto diverse contribuiscono allo stesso modo alla stima della media <span class="math inline">\(\bar{y}\)</span>. Una media ponderata per la popolazione potrebbe fornire un quadro diverso, sebbene anch’esso soggetto a critiche.</li>
<li>
<strong>Contesto e Fattori Concomitanti:</strong> La deviazione dalla media standard di 100 potrebbe riflettere non solo (o non principalmente) differenze “reali” nell’intelligenza media, ma anche enormi disparità nei contesti sanitari, educativi, socio-economici e politici in cui i test sono stati (eventualmente) somministrati o i dati raccolti. Fattori come l’accesso all’istruzione di qualità, la nutrizione, la salute pubblica, e l’esposizione a stimoli cognitivi variano drasticamente tra le nazioni e possono influenzare significativamente i punteggi medi.</li>
<li>
<strong>Bias Culturale dei Test:</strong> I test del QI sono stati storicamente sviluppati e standardizzati in contesti culturali specifici (principalmente occidentali, industrializzati). La loro applicabilità e validità cross-culturale è oggetto di un acceso dibattito. È possibile che i test stessi presentino bias culturali che portano a sottostimare le capacità cognitive in contesti culturali diversi da quello di origine, influenzando così le medie nazionali riportate.</li>
<li>
<strong>Qualità e Origine dei Dati:</strong> I dati originali di Lynn e Vanhanen sono stati oggetto di numerose critiche metodologiche riguardanti la raccolta, la comparabilità e la qualità dei punteggi QI tra diverse nazioni. Utilizzare questi dati senza un esame approfondito delle loro limitazioni può portare a conclusioni fuorvianti.</li>
<li>
<strong>Assunzione di <span class="math inline">\(\sigma\)</span> Nota e Uguale:</strong> L’assunzione che <span class="math inline">\(\sigma=15\)</span> sia la deviazione standard rilevante per le medie nazionali è una forte semplificazione. La variabilità tra le medie nazionali potrebbe essere diversa dalla variabilità individuale all’interno di una popolazione di riferimento.</li>
</ul>
<p>In conclusione, sebbene il modello Normale-Normale fornisca una stima quantitativa (<span class="math inline">\(\mu_n \approx 89.36\)</span>), le profonde questioni metodologiche, concettuali ed etiche legate ai dati sul QI internazionale rendono problematica un’interpretazione diretta di questo valore come “vera” media globale dell’intelligenza. Questo esempio serve più come illustrazione meccanica dell’aggiornamento bayesiano che come un’affermazione sostanziale sul QI globale. Un’analisi seria richiederebbe modelli gerarchici più complessi, una discussione approfondita della validità dei dati e una considerazione attenta dei fattori contestuali.</p>
</div>
</div>
</div>
</section></section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>Nei capitoli precedenti abbiamo visto come il concetto di <em>coniugazione</em> renda particolarmente semplice l’aggiornamento bayesiano. L’esempio Beta–Binomiale ci ha permesso di osservare in modo diretto come i parametri della distribuzione vengano modificati dai dati senza cambiare la forma della distribuzione stessa.</p>
<p>In questa appendice presentiamo altri casi di famiglie coniugate, meno immediati ma ugualmente interessanti. L’obiettivo non è memorizzare formule o cataloghi di distribuzioni, ma cogliere un principio generale: <em>in alcune situazioni fortunate, i calcoli bayesiani diventano particolarmente trasparenti, perché il posterior appartiene alla stessa famiglia della prior</em>.</p>
<p>Dal punto di vista della ricerca psicologica, non è indispensabile padroneggiare tutti questi casi. Nella pratica, la maggior parte dei modelli che incontreremo non ammetterà una forma coniugata, e dovremo ricorrere a metodi computazionali generali come il campionamento MCMC. Tuttavia, conoscere queste famiglie ha due vantaggi didattici:</p>
<ul>
<li>permette di consolidare l’intuizione su come i dati aggiornano i parametri, in contesti diversi da quello binomiale;</li>
<li>aiuta a riconoscere situazioni in cui i calcoli possono essere svolti senza simulazioni, facilitando l’analisi.</li>
</ul>
<p>Se è la prima volta che affronti questi argomenti, puoi leggere questa sezione in modo rapido, come un approfondimento facoltativo. Nei capitoli successivi torneremo a concentrarci sui metodi computazionali, che costituiscono lo strumento essenziale per affrontare i problemi psicologici reali.</p>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Riprendi i dati della SWLS che sono stati utilizzati nell’esercizio del <span class="quarto-unresolved-ref">?sec-gauss-grid</span>. Trova la media e la deviazione standard della distribuzione a posteriori usando il metodo delle distribuzioni coniugate. Confronta i risultati con quelli ottenuti con il metodo basato su griglia.</p>
<p><strong>Consegna:</strong> Carica il file .qmd, convertito in PDF, su Moodle.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Per risolvere questo esercizio con il <em>metodo delle distribuzioni coniugate</em>, assumiamo che i dati provengano da una distribuzione normale con deviazione standard nota e media da stimare. Nel caso di una <em>verosimiglianza gaussiana</em> con prior gaussiano, la distribuzione a posteriori sarà ancora una distribuzione normale. Questo approccio è analitico e ci permette di ottenere la media e la deviazione standard della distribuzione a posteriori senza dover ricorrere a metodi numerici come la discretizzazione della griglia.</p>
<p><strong>Passaggi per il calcolo della distribuzione a posteriori</strong></p>
<ol type="1">
<li>
<strong>Definiamo i dati osservati</strong>:
<ul>
<li>La media campionaria: <span class="math inline">\(\bar{x}\)</span>
</li>
<li>La deviazione standard nota dei dati: <span class="math inline">\(\sigma\)</span>
</li>
<li>Il numero di osservazioni: <span class="math inline">\(n\)</span>
</li>
</ul>
</li>
<li>
<strong>Scegliamo un prior gaussiano molto diffuso</strong>:
<ul>
<li>Media a priori: <span class="math inline">\(\mu_0\)</span>
</li>
<li>Deviazione standard a priori molto grande: <span class="math inline">\(\sigma_0\)</span>
</li>
</ul>
</li>
<li>
<strong>Calcoliamo la media e la varianza della distribuzione a posteriori</strong>:
<ul>
<li>
<p>La media a posteriori è:</p>
<p><span class="math display">\[
\mu_{\text{post}} = \frac{\sigma^2_0 \bar{x} + \sigma^2 n \mu_0}{\sigma^2_0 + \sigma^2 n}
\]</span></p>
</li>
<li>
<p>La varianza a posteriori è:</p>
<p><span class="math display">\[
\sigma^2_{\text{post}} = \frac{\sigma^2_0 \sigma^2}{\sigma^2_0 + \sigma^2 n}
\]</span></p>
</li>
</ul>
</li>
</ol>
<p><strong>Implementazione in R</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Caricamento librerie necessarie</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dati SWLS</span></span>
<span><span class="va">swls_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  soddisfazione <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">5.1</span>, <span class="fl">4.7</span>, <span class="fl">4.3</span>, <span class="fl">5.5</span>, <span class="fl">4.9</span>, <span class="fl">4.8</span>, <span class="fl">5.0</span>, <span class="fl">4.6</span>, <span class="fl">4.4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parametri comuni per entrambi i metodi</span></span>
<span><span class="va">sigma_conosciuta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">$</span><span class="va">soddisfazione</span><span class="op">)</span>  <span class="co"># Usando la deviazione standard campionaria</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">)</span></span>
<span><span class="va">mean_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">$</span><span class="va">soddisfazione</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Deviazione standard campionaria:"</span>, <span class="va">sigma_conosciuta</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Media campionaria:"</span>, <span class="va">mean_x</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Metodo 1: Griglia ----</span></span>
<span><span class="co"># Definizione della griglia più fine e centrata intorno alla media campionaria</span></span>
<span><span class="va">mu_griglia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">mean_x</span> <span class="op">-</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma_conosciuta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span>
<span>                 <span class="va">mean_x</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="va">sigma_conosciuta</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, </span>
<span>                 length.out <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo della verosimiglianza</span></span>
<span><span class="va">log_likelihood</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mu_griglia</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">mu_griglia</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Utilizzo della log-likelihood per evitare problemi numerici</span></span>
<span>  <span class="va">log_likelihood</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">$</span><span class="va">soddisfazione</span>, </span>
<span>                                mean <span class="op">=</span> <span class="va">mu_griglia</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                                sd <span class="op">=</span> <span class="va">sigma_conosciuta</span>, </span>
<span>                                log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Prior uniforme (in scala logaritmica)</span></span>
<span><span class="va">log_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">mu_griglia</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcolo della posteriori</span></span>
<span><span class="va">log_posterior</span> <span class="op">&lt;-</span> <span class="va">log_likelihood</span> <span class="op">+</span> <span class="va">log_prior</span></span>
<span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log_posterior</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">log_posterior</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="va">posterior</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Campionamento e calcolo statistiche</span></span>
<span><span class="va">samples_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">mu_griglia</span>, size <span class="op">=</span> <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">posterior</span><span class="op">)</span></span>
<span><span class="va">mean_post_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">samples_grid</span><span class="op">)</span></span>
<span><span class="va">sd_post_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">samples_grid</span><span class="op">)</span></span>
<span><span class="va">ci_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">samples_grid</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.03</span>, <span class="fl">0.97</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Metodo 2: Soluzione analitica ----</span></span>
<span><span class="co"># Prior poco informativo ma non improprio</span></span>
<span><span class="va">mu_prior</span> <span class="op">&lt;-</span> <span class="va">mean_x</span></span>
<span><span class="va">sigma_prior</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Calcolo posteriori</span></span>
<span><span class="va">mu_post_analytic</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sigma_prior</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">mean_x</span> <span class="op">+</span> <span class="va">sigma_conosciuta</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">mu_prior</span><span class="op">/</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                    <span class="op">(</span><span class="va">sigma_prior</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sigma_conosciuta</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">sigma_post_analytic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">sigma_prior</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">sigma_conosciuta</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">n</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                           <span class="op">(</span><span class="va">sigma_prior</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">sigma_conosciuta</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confronto risultati</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  Metodo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Griglia"</span>, <span class="st">"Analitico"</span><span class="op">)</span>,</span>
<span>  `Media Posteriori` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">mean_post_grid</span>, <span class="va">mu_post_analytic</span><span class="op">)</span>,</span>
<span>  `Dev. Std. Posteriori` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sd_post_grid</span>, <span class="va">sigma_post_analytic</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">results</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Interpretazione dei risultati</strong></p>
<ul>
<li>La <strong>media a posteriori</strong> rappresenta la miglior stima aggiornata della media della popolazione dopo aver osservato i dati.</li>
<li>La <strong>deviazione standard a posteriori</strong> ci dice quanto è incerta la nostra stima della media dopo aver integrato i dati e il prior.</li>
</ul>
<p>Siccome abbiamo scelto un prior molto diffuso (<span class="math inline">\(\sigma_0 = 10\)</span>), il risultato ottenuto è molto vicino a quello ottenuto con il metodo della griglia, dove il prior uniforme aveva un impatto minimo sulla distribuzione a posteriori.</p>
<p>Questa implementazione analitica permette di ottenere il risultato in modo efficiente senza necessità di metodi numerici approssimati.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] mice_3.18.0           pillar_1.11.0         tinytable_0.13.0     </span></span>
<span><span class="co">#&gt;  [4] patchwork_1.3.2       ggdist_3.3.3          tidybayes_3.0.7      </span></span>
<span><span class="co">#&gt;  [7] bayesplot_1.14.0      ggplot2_3.5.2         reliabilitydiag_0.2.1</span></span>
<span><span class="co">#&gt; [10] priorsense_1.1.1      posterior_1.6.1       loo_2.8.0            </span></span>
<span><span class="co">#&gt; [13] rstan_2.32.7          StanHeaders_2.32.10   brms_2.22.0          </span></span>
<span><span class="co">#&gt; [16] Rcpp_1.1.0            sessioninfo_1.2.3     conflicted_1.2.0     </span></span>
<span><span class="co">#&gt; [19] janitor_2.2.1         matrixStats_1.5.0     modelr_0.1.11        </span></span>
<span><span class="co">#&gt; [22] tibble_3.3.0          dplyr_1.1.4           tidyr_1.3.1          </span></span>
<span><span class="co">#&gt; [25] rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Rdpack_2.6.4          gridExtra_2.3         inline_0.3.21        </span></span>
<span><span class="co">#&gt;  [4] sandwich_3.1-1        rlang_1.1.6           magrittr_2.0.3       </span></span>
<span><span class="co">#&gt;  [7] multcomp_1.4-28       snakecase_0.11.1      compiler_4.5.1       </span></span>
<span><span class="co">#&gt; [10] systemfonts_1.2.3     vctrs_0.6.5           stringr_1.5.1        </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3       shape_1.4.6.1         arrayhelpers_1.1-0   </span></span>
<span><span class="co">#&gt; [16] fastmap_1.2.0         backports_1.5.0       labeling_0.4.3       </span></span>
<span><span class="co">#&gt; [19] rmarkdown_2.29        nloptr_2.2.1          ragg_1.5.0           </span></span>
<span><span class="co">#&gt; [22] purrr_1.1.0           jomo_2.7-6            xfun_0.53            </span></span>
<span><span class="co">#&gt; [25] glmnet_4.1-10         cachem_1.1.0          jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [28] pan_1.9               broom_1.0.9           parallel_4.5.1       </span></span>
<span><span class="co">#&gt; [31] R6_2.6.1              stringi_1.8.7         RColorBrewer_1.1-3   </span></span>
<span><span class="co">#&gt; [34] rpart_4.1.24          boot_1.3-32           lubridate_1.9.4      </span></span>
<span><span class="co">#&gt; [37] estimability_1.5.1    iterators_1.0.14      knitr_1.50           </span></span>
<span><span class="co">#&gt; [40] zoo_1.8-14            pacman_0.5.1          nnet_7.3-20          </span></span>
<span><span class="co">#&gt; [43] Matrix_1.7-4          splines_4.5.1         timechange_0.3.0     </span></span>
<span><span class="co">#&gt; [46] tidyselect_1.2.1      abind_1.4-8           yaml_2.3.10          </span></span>
<span><span class="co">#&gt; [49] codetools_0.2-20      curl_7.0.0            pkgbuild_1.4.8       </span></span>
<span><span class="co">#&gt; [52] lattice_0.22-7        withr_3.0.2           bridgesampling_1.1-2 </span></span>
<span><span class="co">#&gt; [55] coda_0.19-4.1         evaluate_1.0.5        survival_3.8-3       </span></span>
<span><span class="co">#&gt; [58] RcppParallel_5.1.11-1 tensorA_0.36.2.1      checkmate_2.3.3      </span></span>
<span><span class="co">#&gt; [61] foreach_1.5.2         stats4_4.5.1          reformulas_0.4.1     </span></span>
<span><span class="co">#&gt; [64] distributional_0.5.0  generics_0.1.4        rprojroot_2.1.1      </span></span>
<span><span class="co">#&gt; [67] rstantools_2.5.0      scales_1.4.0          minqa_1.2.8          </span></span>
<span><span class="co">#&gt; [70] xtable_1.8-4          glue_1.8.0            emmeans_1.11.2-8     </span></span>
<span><span class="co">#&gt; [73] tools_4.5.1           lme4_1.1-37           mvtnorm_1.3-3        </span></span>
<span><span class="co">#&gt; [76] grid_4.5.1            rbibutils_2.3         QuickJSR_1.8.0       </span></span>
<span><span class="co">#&gt; [79] colorspace_2.1-1      nlme_3.1-168          cli_3.6.5            </span></span>
<span><span class="co">#&gt; [82] textshaping_1.0.3     svUnit_1.0.8          Brobdingnag_1.2-9    </span></span>
<span><span class="co">#&gt; [85] V8_7.0.0              gtable_0.3.6          digest_0.6.37        </span></span>
<span><span class="co">#&gt; [88] TH.data_1.1-4         htmlwidgets_1.6.4     farver_2.1.2         </span></span>
<span><span class="co">#&gt; [91] memoise_2.0.1         htmltools_0.5.8.1     lifecycle_1.0.4      </span></span>
<span><span class="co">#&gt; [94] mitml_0.4-5           MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-gill2015bayesian" class="csl-entry" role="listitem">
Gill, J. (2015). <em>Bayesian methods: A social and behavioral sciences approach</em> (3rd Edition). Chapman; Hall/CRC.
</div>
<div id="ref-Johnson2022bayesrules" class="csl-entry" role="listitem">
Johnson, A. A., Ott, M., &amp; Dogucu, M. (2022). <em><span>Bayes Rules! An Introduction to Bayesian Modeling with R</span></em>. CRC Press.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/utet-companion\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/appendix/a15_calculus.html" class="pagination-link" aria-label="Per liberarvi dai terrori preliminari">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="pagination-link" aria-label="Modello coniugato Gamma-Poisson">
        <span class="nav-page-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Metodi bayesiani in psicologia — Companion site</strong>.<br>
Materiali di accompagnamento e approfondimento al manuale UTET.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/utet-companion/blob/main/chapters/appendix/a35_other_conjugate_families.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-companion/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>