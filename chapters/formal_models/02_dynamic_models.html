<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>46&nbsp; Estensioni – Metodi bayesiani in psicologia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/formal_models/03_rescorla_wagner.html" rel="next">
<link href="../../chapters/formal_models/01_dynamic_models.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/formal_models/introduction_sec.html">Modelli</a></li><li class="breadcrumb-item"><a href="../../chapters/formal_models/02_dynamic_models.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Estensioni</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Metodi bayesiani in psicologia</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/utet-companion/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Struttura del companion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefazione</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">56</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#modello-gerarchico" id="toc-modello-gerarchico" class="nav-link active" data-scroll-target="#modello-gerarchico"><span class="header-section-number">46.1</span> Modello gerarchico</a></li>
  <li><a href="#differenze-tra-gruppi" id="toc-differenze-tra-gruppi" class="nav-link" data-scroll-target="#differenze-tra-gruppi"><span class="header-section-number">46.2</span> Differenze tra gruppi</a></li>
  <li><a href="#confronto-tra-modelli" id="toc-confronto-tra-modelli" class="nav-link" data-scroll-target="#confronto-tra-modelli"><span class="header-section-number">46.3</span> Confronto tra modelli</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/utet-companion/blob/main/chapters/formal_models/02_dynamic_models.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-companion/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/formal_models/introduction_sec.html">Modelli</a></li><li class="breadcrumb-item"><a href="../../chapters/formal_models/02_dynamic_models.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Estensioni</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-formal-models-developments" class="quarto-section-identifier"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Estensioni</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="epigraph">
<blockquote class="blockquote">
<p>“People change over time. … describing and explaining change over time must focus on dynamics in response to environmental cues and competing internal states. That is, we must include time and change over time in our models.”</p>
<p>– <strong>Wilt, J.</strong>, It’s about time: Emphasizing temporal dynamics in [personality] (2003)</p>
</blockquote>
</div>
<section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>Sulla scia di <span class="citation" data-cites="knight2023tutorial">Knight et al. (<a href="#ref-knight2023tutorial" role="doc-biblioref">2023</a>)</span>, in questo capitolo estendiamo il modello presentato in precedenza lungo tre direzioni complementari. Partiamo dal <em>livello individuale</em> (<em>person-level</em>), in cui stimiamo per ciascun partecipante i propri parametri <span class="math inline">\((\alpha_i, \beta_i)\)</span>. Questo passaggio consente di mappare l’eterogeneità interindividuale (sensibilità al feedback e deriva motivazionale), ma lascia le stime dei singoli <em>isolate</em> le une dalle altre.</p>
<p>Per superare questo limite introduciamo la versione <em>gerarchica (multilevel)</em>: i parametri dei singoli sono considerati <em>estratti</em> da distribuzioni di popolazione (es. normali) descritte da iper-parametri. In questo modo le informazioni vengono condivise tra individui, con il tipico effetto di <em>shrinkage</em> che stabilizza le stime, soprattutto quando i dati per soggetto sono pochi o rumorosi.</p>
<p>Infine, consideriamo il caso dei <em>gruppi noti</em> (es. <em>approach</em> vs <em>avoidance</em>), stimando iper-parametri separati per ciascuna condizione. Questo permette di quantificare differenze sistematiche <em>a livello di popolazione</em> tra condizioni sperimentali, oltre alle differenze tra individui. Valuteremo i modelli con criteri <em>predittivi</em> (ELPD tramite <em>LOO-CV</em>), così da bilanciare in modo esplicito <em>complessità</em> e <em>capacità di generalizzazione</em>.</p>
<section id="panoramica-del-capitolo" class="level3 unnumbered unlisted"><h3 class="unnumbered unlisted anchored" data-anchor-id="panoramica-del-capitolo">Panoramica del capitolo</h3>
<ul>
<li>
<em>Modello a livello individuale</em>: stima di <span class="math inline">\(\alpha_i\)</span> e <span class="math inline">\(\beta_i\)</span> per ogni soggetto.</li>
<li>
<em>Modello gerarchico</em>: parametri individuali estratti da distribuzioni di popolazione → <em>shrinkage</em> e maggiore robustezza.</li>
<li>
<em>Gruppi noti</em>: iper-parametri specifici per condizione (<em>approach</em> vs <em>avoidance</em>).</li>
<li>
<em>Confronto predittivo</em>: ELPD e <em>LOO-CV</em> per scegliere il modello.</li>
<li>
<em>Implicazioni psicologiche</em>: quando e perché la gerarchia migliora l’inferenza.</li>
</ul>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/cmdstanr/">cmdstanr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/">bayesplot</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/">tidybayes</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/">posterior</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/loo/">loo</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/">conflicted</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">loo</span><span class="fu">::</span><span class="va"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html">conflicts_prefer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="modello-a-livello-individuale" class="level3" data-number="46.0.1"><h3 data-number="46.0.1" class="anchored" data-anchor-id="modello-a-livello-individuale">
<span class="header-section-number">46.0.1</span> Modello a livello individuale</h3>
<p>Il modello <em>sample-level</em> stima un unico insieme di parametri <span class="math inline">\((\alpha, \beta)\)</span> per l’intero campione, ignorando le differenze individuali. Per cogliere questa eterogeneità, è possibile introdurre il <em>modello a livello individuale</em> (<em>person-level</em>), che stima parametri distinti <span class="math inline">\((\alpha_i, \beta_i)\)</span> per ogni partecipante <span class="math inline">\(i\)</span>.</p>
<p>In questa formulazione:</p>
<ul>
<li>ogni individuo possiede il proprio tasso di apprendimento <span class="math inline">\(\alpha_i\)</span> e la propria deriva motivazionale <span class="math inline">\(\beta_i\)</span>;</li>
<li>il parametro <span class="math inline">\(\sigma\)</span>, che cattura la variabilità residua (rumore decisionale), rimane comune a tutti i soggetti.</li>
</ul>
<p>Questo approccio consente di:</p>
<ul>
<li>mappare la variabilità interindividuale nei processi di aggiornamento degli obiettivi;</li>
<li>identificare profili comportamentali distinti (es. soggetti molto reattivi al feedback vs.&nbsp;poco adattivi);</li>
<li>evitare l’assunzione – spesso irrealistica – che tutti i partecipanti rispondano allo stesso modo.</li>
</ul>
<p>Tuttavia, il modello a livello individuale non incorpora alcun meccanismo di “condivisione dell’informazione” tra i soggettii, ma ogni partecipante viene modellato in modo indipendente dagli altri. Questa caratteristica lo distingue dal modello gerarchico (o multilevel), in cui i parametri individuali sono considerati provenienti da una distribuzione di gruppo, il che migliora la robustezza delle stime, soprattutto quando i dati sono limitati o rumorosi.</p>
</section><section id="preparazione-dei-dati" class="level3" data-number="46.0.2"><h3 data-number="46.0.2" class="anchored" data-anchor-id="preparazione-dei-dati">
<span class="header-section-number">46.0.2</span> Preparazione dei dati</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Caricamento del dataset</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="http://gesistsa.github.io/rio/reference/import.html">import</a></span><span class="op">(</span><span class="st">"data/goal_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ordina i dati per soggetto e per trial</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">subject</span>, <span class="va">trial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (Opzionale) Verifica che l'ordinamento sia corretto</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    600 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ subject    : int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ condition  : chr  "approach" "approach" "approach" "approach" ...</span></span>
<span><span class="co">#&gt;  $ goal       : int  2 2 2 4 4 2 2 4 2 4 ...</span></span>
<span><span class="co">#&gt;  $ performance: int  0 2 2 4 2 0 4 2 4 4 ...</span></span>
<span><span class="co">#&gt;  $ trial      : int  1 2 3 4 5 6 7 8 9 10 ...</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span>  <span class="co"># restituisce il numero di trial per soggetto</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 </span></span>
<span><span class="co">#&gt; 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 </span></span>
<span><span class="co">#&gt; 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 </span></span>
<span><span class="co">#&gt; 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 </span></span>
<span><span class="co">#&gt; 53 54 55 56 57 58 59 60 </span></span>
<span><span class="co">#&gt; 10 10 10 10 10 10 10 10</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1) Ordina per soggetto e trial</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">subject</span>, <span class="va">trial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Salva scale originali (per eventuale back-transform)</span></span>
<span><span class="va">goal_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">goal</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>; <span class="va">goal_sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">goal</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">perf_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">performance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>; <span class="va">perf_sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">performance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Standardizza</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    goal_z <span class="op">=</span> <span class="op">(</span><span class="va">goal</span> <span class="op">-</span> <span class="va">goal_mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">goal_sd</span>,</span>
<span>    perf_z <span class="op">=</span> <span class="op">(</span><span class="va">performance</span> <span class="op">-</span> <span class="va">perf_mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">perf_sd</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 4) Lista per Stan (condition è opzionale qui: non usata nel baseline)</span></span>
<span><span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  subject       <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">subject</span>,</span>
<span>  trial         <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">trial</span>,</span>
<span>  observed_goal <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">goal_z</span>,</span>
<span>  performance   <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">perf_z</span>,</span>
<span>  Nsubj         <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span>,</span>
<span>  Ntotal        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">stan_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 6</span></span>
<span><span class="co">#&gt;  $ subject      : int [1:600] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ trial        : int [1:600] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ observed_goal: num [1:600] -2 -2 -2 -1.07 -1.07 ...</span></span>
<span><span class="co">#&gt;  $ performance  : num [1:600] -2.89 -1.99 -1.99 -1.1 -1.99 ...</span></span>
<span><span class="co">#&gt;  $ Nsubj        : int 60</span></span>
<span><span class="co">#&gt;  $ Ntotal       : int 600</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="definizione-del-modello-stan" class="level3" data-number="46.0.3"><h3 data-number="46.0.3" class="anchored" data-anchor-id="definizione-del-modello-stan">
<span class="header-section-number">46.0.3</span> Definizione del modello Stan</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stancode</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=1&gt; Ntotal;                 // es. 600</span></span>
<span><span class="st">  int&lt;lower=1&gt; Nsubj;                  // es. 60</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; subject;  // indice soggetto (1..Nsubj)</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; trial;    // 1..T per ciascun soggetto (ordinati)</span></span>
<span><span class="st">  vector[Ntotal] observed_goal;        // Z-score</span></span>
<span><span class="st">  vector[Ntotal] performance;          // Z-score</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  vector[Nsubj] alpha;                 // guadagno per soggetto</span></span>
<span><span class="st">  vector[Nsubj] beta;                  // drift per soggetto</span></span>
<span><span class="st">  real&lt;lower=1e-6&gt; sigma;              // dev. std residua (comune)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">transformed parameters {</span></span>
<span><span class="st">  vector[Ntotal] ghat;                 // traiettoria predetta</span></span>
<span><span class="st"></span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    if (trial[i] == 1) {</span></span>
<span><span class="st">      // reset a inizio soggetto: primo stato = prima osservazione</span></span>
<span><span class="st">      ghat[i] = observed_goal[i];</span></span>
<span><span class="st">    } else {</span></span>
<span><span class="st">      int s = subject[i];</span></span>
<span><span class="st">      // ricorsione: usa predizione e performance del trial precedente (stesso soggetto se i dati sono ordinati)</span></span>
<span><span class="st">      ghat[i] = ghat[i - 1]</span></span>
<span><span class="st">                + alpha[s] * (performance[i - 1] - ghat[i - 1])</span></span>
<span><span class="st">                + beta[s];</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  // Priors semplici coerenti con z-score</span></span>
<span><span class="st">  alpha ~ normal(0, 1);</span></span>
<span><span class="st">  beta  ~ normal(0, 1);</span></span>
<span><span class="st">  sigma ~ normal(0, 1);   // half-normal(1) per via del lower bound</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Likelihood</span></span>
<span><span class="st">  observed_goal ~ normal(ghat, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">generated quantities {</span></span>
<span><span class="st">  vector[Ntotal] yrep;</span></span>
<span><span class="st">  vector[Ntotal] log_lik;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    yrep[i]   = normal_rng(ghat[i], sigma);</span></span>
<span><span class="st">    log_lik[i] = normal_lpdf(observed_goal[i] | ghat[i], sigma);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Questo modello presuppone che i dati siano <em>ordinati per soggetto e per trial</em>, altrimenti la dinamica <code>i - 1</code> non corrisponde al trial precedente dello stesso soggetto.</p>
<p>Esaminiamo in dettaglio cosa significano <code>alpha[subject[i]]</code> e <code>beta[subject[i]]</code>. Nel modello Stan, ogni trial <code>i</code> è associato a un certo soggetto. Questa informazione è contenuta nel vettore:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">array</span>[Ntotal] <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">1</span>&gt; subject;</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_data</span><span class="op">$</span><span class="va">subject</span></span>
<span><span class="co">#&gt;   [1]  1  1  1  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  3  3  3  3  3</span></span>
<span><span class="co">#&gt;  [26]  3  3  3  3  3  4  4  4  4  4  4  4  4  4  4  5  5  5  5  5  5  5  5  5  5</span></span>
<span><span class="co">#&gt;  [51]  6  6  6  6  6  6  6  6  6  6  7  7  7  7  7  7  7  7  7  7  8  8  8  8  8</span></span>
<span><span class="co">#&gt;  [76]  8  8  8  8  8  9  9  9  9  9  9  9  9  9  9 10 10 10 10 10 10 10 10 10 10</span></span>
<span><span class="co">#&gt; [101] 11 11 11 11 11 11 11 11 11 11 12 12 12 12 12 12 12 12 12 12 13 13 13 13 13</span></span>
<span><span class="co">#&gt; [126] 13 13 13 13 13 14 14 14 14 14 14 14 14 14 14 15 15 15 15 15 15 15 15 15 15</span></span>
<span><span class="co">#&gt; [151] 16 16 16 16 16 16 16 16 16 16 17 17 17 17 17 17 17 17 17 17 18 18 18 18 18</span></span>
<span><span class="co">#&gt; [176] 18 18 18 18 18 19 19 19 19 19 19 19 19 19 19 20 20 20 20 20 20 20 20 20 20</span></span>
<span><span class="co">#&gt; [201] 21 21 21 21 21 21 21 21 21 21 22 22 22 22 22 22 22 22 22 22 23 23 23 23 23</span></span>
<span><span class="co">#&gt; [226] 23 23 23 23 23 24 24 24 24 24 24 24 24 24 24 25 25 25 25 25 25 25 25 25 25</span></span>
<span><span class="co">#&gt; [251] 26 26 26 26 26 26 26 26 26 26 27 27 27 27 27 27 27 27 27 27 28 28 28 28 28</span></span>
<span><span class="co">#&gt; [276] 28 28 28 28 28 29 29 29 29 29 29 29 29 29 29 30 30 30 30 30 30 30 30 30 30</span></span>
<span><span class="co">#&gt; [301] 31 31 31 31 31 31 31 31 31 31 32 32 32 32 32 32 32 32 32 32 33 33 33 33 33</span></span>
<span><span class="co">#&gt; [326] 33 33 33 33 33 34 34 34 34 34 34 34 34 34 34 35 35 35 35 35 35 35 35 35 35</span></span>
<span><span class="co">#&gt; [351] 36 36 36 36 36 36 36 36 36 36 37 37 37 37 37 37 37 37 37 37 38 38 38 38 38</span></span>
<span><span class="co">#&gt; [376] 38 38 38 38 38 39 39 39 39 39 39 39 39 39 39 40 40 40 40 40 40 40 40 40 40</span></span>
<span><span class="co">#&gt; [401] 41 41 41 41 41 41 41 41 41 41 42 42 42 42 42 42 42 42 42 42 43 43 43 43 43</span></span>
<span><span class="co">#&gt; [426] 43 43 43 43 43 44 44 44 44 44 44 44 44 44 44 45 45 45 45 45 45 45 45 45 45</span></span>
<span><span class="co">#&gt; [451] 46 46 46 46 46 46 46 46 46 46 47 47 47 47 47 47 47 47 47 47 48 48 48 48 48</span></span>
<span><span class="co">#&gt; [476] 48 48 48 48 48 49 49 49 49 49 49 49 49 49 49 50 50 50 50 50 50 50 50 50 50</span></span>
<span><span class="co">#&gt; [501] 51 51 51 51 51 51 51 51 51 51 52 52 52 52 52 52 52 52 52 52 53 53 53 53 53</span></span>
<span><span class="co">#&gt; [526] 53 53 53 53 53 54 54 54 54 54 54 54 54 54 54 55 55 55 55 55 55 55 55 55 55</span></span>
<span><span class="co">#&gt; [551] 56 56 56 56 56 56 56 56 56 56 57 57 57 57 57 57 57 57 57 57 58 58 58 58 58</span></span>
<span><span class="co">#&gt; [576] 58 58 58 58 58 59 59 59 59 59 59 59 59 59 59 60 60 60 60 60 60 60 60 60 60</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ogni elemento <code>subject[i]</code> ci dice <em>a quale soggetto appartiene il trial <code>i</code></em>, usando un numero intero da <code>1</code> a <code>Nsubj</code>. Quindi se <code>subject[137] == 24</code>, significa che il 137-esimo trial è del soggetto 24.</p>
<p>Ora, se abbiamo un vettore di parametri specifici per ogni soggetto</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dt">vector</span>[Nsubj] alpha;</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="dt">vector</span>[Nsubj] beta;</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>allora</p>
<ul>
<li>
<code>alpha[subject[i]]</code> significa: prendi il valore del parametro <code>alpha</code> associato al soggetto a cui appartiene il trial <code>i</code>;</li>
<li>lo stesso vale per <code>beta[subject[i]]</code>.</li>
</ul>
<p>Per esempio, supponiamo</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>subject = [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>alpha = [<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span>]  <span class="co">// Tre soggetti: 1, 2, 3</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>allora</p>
<ul>
<li>
<code>alpha[subject[4]] = alpha[2] = 0.8</code>, perché il 4° trial è del soggetto 2.</li>
<li>
<code>beta[subject[6]] = beta[3] = ...</code>, perché il 6° trial è del soggetto 3.</li>
</ul>
<p>In sintesi, la sintassi <code>alpha[subject[i]]</code> (e <code>beta[subject[i]]</code>) indica: “Nel trial <code>i</code>, usa il valore del parametro <code>alpha</code> (o <code>beta</code>) del soggetto indicato da <code>subject[i]</code>”. È un modo compatto per associare ogni osservazione ai parametri della persona corrispondente.</p>
</section><section id="compilazione-ed-esecuzione-del-modello" class="level3" data-number="46.0.4"><h3 data-number="46.0.4" class="anchored" data-anchor-id="compilazione-ed-esecuzione-del-modello">
<span class="header-section-number">46.0.4</span> Compilazione ed esecuzione del modello</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stanmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html">cmdstan_model</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/write_stan_file.html">write_stan_file</a></span><span class="op">(</span><span class="va">stancode</span><span class="op">)</span>,</span>
<span>  compile <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="va">stanmod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">4790</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="analisi-dei-risultati" class="level3" data-number="46.0.5"><h3 data-number="46.0.5" class="anchored" data-anchor-id="analisi-dei-risultati">
<span class="header-section-number">46.0.5</span> Analisi dei risultati</h3>
<p>Questo modello genera un insieme di campioni posteriori per i parametri <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>, uno per ciascun partecipante.</p>
<p>Estrazione dei campioni in formato “draws_matrix” (per summary tabellari):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">standraws</span> <span class="op">&lt;-</span> <span class="va">fit1</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>format <span class="op">=</span> <span class="st">"draws_matrix"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Statistiche descrittive compatte per <span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta_i\)</span> e <span class="math inline">\(\sigma\)</span>: media, mediana e intervalli credibili al 95% (2.5% - 97.5%):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">standraws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/subset_draws.html">subset_draws</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span></span>
<span>    <span class="va">mean</span>,</span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 121 × 5</span></span>
<span><span class="co">#&gt;    variable   mean `2.5%` `50%` `97.5%`</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 alpha[1]  0.662  0.161 0.683   1.022</span></span>
<span><span class="co">#&gt;  2 alpha[2]  0.181 -0.265 0.178   0.595</span></span>
<span><span class="co">#&gt;  3 alpha[3]  0.167 -0.251 0.186   0.507</span></span>
<span><span class="co">#&gt;  4 alpha[4]  0.300 -0.515 0.303   0.950</span></span>
<span><span class="co">#&gt;  5 alpha[5]  0.400  0.056 0.399   0.744</span></span>
<span><span class="co">#&gt;  6 alpha[6]  0.586 -0.001 0.613   1.043</span></span>
<span><span class="co">#&gt;  7 alpha[7]  0.408  0.121 0.406   0.750</span></span>
<span><span class="co">#&gt;  8 alpha[8]  0.119 -0.077 0.109   0.343</span></span>
<span><span class="co">#&gt;  9 alpha[9]  0.487  0.009 0.487   0.927</span></span>
<span><span class="co">#&gt; 10 alpha[10] 0.811  0.440 0.811   1.109</span></span>
<span><span class="co">#&gt; # ℹ 111 more rows</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Diagnostica rapida (Rhat ed ESS):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Se qualche Rhat &gt; 1.01 o ESS basso, considerare run più lunghi o reparametrizzazioni</span></span>
<span><span class="va">fit1</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span>variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">variable</span>, <span class="va">rhat</span>, <span class="va">ess_bulk</span>, <span class="va">ess_tail</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">rhat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 121 × 4</span></span>
<span><span class="co">#&gt;    variable   rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 alpha[34] 1.177   14.956   10.927</span></span>
<span><span class="co">#&gt;  2 beta[47]  1.168   15.789   17.071</span></span>
<span><span class="co">#&gt;  3 beta[34]  1.168   15.618   11.197</span></span>
<span><span class="co">#&gt;  4 alpha[47] 1.163   16.778   17.192</span></span>
<span><span class="co">#&gt;  5 beta[46]  1.157   17.028   18.453</span></span>
<span><span class="co">#&gt;  6 beta[56]  1.141   19.034   26.829</span></span>
<span><span class="co">#&gt;  7 alpha[56] 1.141   19.378   43.006</span></span>
<span><span class="co">#&gt;  8 beta[40]  1.124   21.218   71.730</span></span>
<span><span class="co">#&gt;  9 beta[32]  1.122   20.397   22.425</span></span>
<span><span class="co">#&gt; 10 beta[26]  1.120   20.658   27.604</span></span>
<span><span class="co">#&gt; # ℹ 111 more rows</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estrazione “tidy” dei parametri livello-persona con <code><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">tidybayes::spread_draws</a></code>. Questo produce le colonne: <code>.draw, subject, alpha, beta</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">posteriors_person</span> <span class="op">=</span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">alpha</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span>, <span class="va">beta</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcolo della media e dell’intervallo credibile al 95% per ciascun soggetto:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo media e intervallo credibile al 95% per ciascun soggetto</span></span>
<span><span class="va">CIs_person</span> <span class="op">&lt;-</span> <span class="va">posteriors_person</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      lower <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>      mean  <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,</span>
<span>      upper <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span>, .names <span class="op">=</span> <span class="st">"{.col}_{.fn}"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">alpha_mean</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>alpha_order <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">beta_mean</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>beta_order <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Grafico 1: CI al 95% per <span class="math inline">\(\alpha_i\)</span>, ordinati per <code>alpha_mean</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_person_alpha</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">alpha_order</span>,x<span class="op">=</span><span class="va">alpha_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">alpha_order</span>,xmin<span class="op">=</span><span class="va">alpha_lower</span>,xmax<span class="op">=</span><span class="va">alpha_upper</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span> ,y<span class="op">=</span><span class="st">"Subject"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Grafico 2: CI al 95% per <span class="math inline">\(\beta_i\)</span>, ordinati per <code>beta_mean</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_person_beta</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">beta_order</span>, x <span class="op">=</span> <span class="va">beta_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">beta_order</span>, xmin <span class="op">=</span> <span class="va">beta_lower</span>, xmax <span class="op">=</span> <span class="va">beta_upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Subject"</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Grafico 3: Dispersione bivariata (<code>alpha_mean</code> vs <code>beta_mean</code>) + croci di CI 95%. Le barre (verticali e orizzontali) danno il colpo d’occhio sulla (co)variabilità individuale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_person_alphabeta</span> <span class="op">=</span> <span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">alpha_mean</span>,y<span class="op">=</span><span class="va">beta_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">alpha_mean</span>,ymin<span class="op">=</span><span class="va">beta_lower</span>,ymax<span class="op">=</span><span class="va">beta_upper</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"red"</span>,alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">beta_mean</span>,xmin<span class="op">=</span><span class="va">alpha_lower</span>,xmax<span class="op">=</span><span class="va">alpha_upper</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"red"</span>,alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span> ,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>I grafici mostrano una marcata eterogeneità tra i partecipanti nei parametri <span class="math inline">\(\alpha\)</span> (tasso di apprendimento) e <span class="math inline">\(\beta\)</span> (drift motivazionale), con intervalli credibili al 95% calcolati per ciascun <span class="math inline">\(\alpha_i\)</span> e <span class="math inline">\(\beta_i\)</span>.</p>
<ul>
<li>
<strong>Per <span class="math inline">\(\alpha\)</span></strong>: i partecipanti mostrano valori distribuiti lungo quasi tutto l’intervallo [0,1]. Alcuni soggetti hanno <span class="math inline">\(\alpha\)</span> molto vicino a 0 (poca sensibilità al feedback), mentre altri si avvicinano a 1 (forte aggiornamento in risposta all’errore). L’ampiezza degli intervalli credibili varia, ma nella maggior parte dei casi suggerisce stime sufficientemente informative.</li>
</ul>
<p><strong>Per <span class="math inline">\(\beta\)</span></strong>: i valori si distribuiscono attorno a 0, ma con differenze individuali marcate: alcuni soggetti mostrano un drift positivo (tendenza ad aumentare sistematicamente gli obiettivi), altri un drift negativo (tendenza a ridurli). Gli intervalli credibili confermano questa eterogeneità.</p>
<p>Il punto chiave è che questa variabilità <em>non può essere colta dal modello sample-level</em>. Quest’ultimo, stimando un unico <span class="math inline">\(\alpha\)</span> e un unico <span class="math inline">\(\beta\)</span> comuni a tutti, restituisce una sorta di “media” del comportamento dei partecipanti. In pratica:</p>
<ul>
<li>un soggetto con <span class="math inline">\(\alpha \approx 0\)</span> e uno con <span class="math inline">\(\alpha \approx 0.9\)</span> verrebbero descritti dallo stesso parametro <span class="math inline">\(\alpha\)</span>, che potrebbe cadere a metà strada ma non rappresenta bene né l’uno né l’altro;</li>
<li>analogamente, le derive motivazionali individuali <span class="math inline">\(\beta\)</span> (positive, negative o vicine a zero) verrebbero tutte appiattite su un valore medio.</li>
</ul>
<p>I grafici dimostrano quindi l’utilità del modello a livello individuale: esso permette di mappare differenze sostanziali tra soggetti, che nel modello a livello di campione vengono perse.</p>
<p>In sintesi:</p>
<ul>
<li>il modello <em>sample-level</em> offre una descrizione parsimoniosa, ma rischia di mascherare differenze psicologicamente importanti;</li>
<li>il modello <em>person-level</em> mostra che i partecipanti non solo differiscono nel grado di apprendimento dal feedback (<span class="math inline">\(\alpha\)</span>), ma anche nella direzione e nell’intensità della deriva motivazionale (<span class="math inline">\(\beta\)</span>);</li>
<li>questa eterogeneità costituisce un’informazione preziosa per comprendere i profili comportamentali individuali, impossibile da cogliere con un modello che assume parametri omogenei per tutto il campione.</li>
</ul></section></section><section id="modello-gerarchico" class="level2" data-number="46.1"><h2 data-number="46.1" class="anchored" data-anchor-id="modello-gerarchico">
<span class="header-section-number">46.1</span> Modello gerarchico</h2>
<p>Stimare i parametri per ogni partecipante separatamente (come nel modello a livello individuale) permette di rappresentare le differenze individuali, ma presenta un limite cruciale: le stime rimangono isolate. Analizzare i dati “persona per persona” equivale a condurre un’analisi indipendente per ciascun soggetto, senza “riutilizzare” le informazioni presenti negli altri individui. Ciò riduce il potere statistico, aumenta la variabilità delle stime quando i dati per soggetto sono pochi e rende più difficile trarre conclusioni a livello di popolazione.</p>
<p>In molti contesti, però, l’interesse del ricercatore non è solo quello di descrivere le differenze tra gli individui, ma anche di cogliere le regolarità comuni alla popolazione. Per questo motivo, i modelli gerarchici bayesiani (o multilevel) offrono una soluzione particolarmente efficace (Turner et al., 2013; Vincent, 2016; Kruschke &amp; Vanpaemel, 2015).</p>
<p>L’idea di fondo è semplice:</p>
<ul>
<li>i parametri individuali (es. <span class="math inline">\(\alpha_s, \beta_s\)</span>) sono trattati come <em>variabili casuali</em>, non come quantità del tutto indipendenti;</li>
<li>ciascuno di essi è estratto da una distribuzione a livello di popolazione, descritta da iper-parametri (<span class="math inline">\(\alpha_{\text{mean}}, \alpha_{\text{sd}}\)</span>, ecc.);</li>
<li>in questo modo, le stime individuali sono “informate” sia dai dati del singolo soggetto sia dalla tendenza generale osservata nel campione (Lewandowsky &amp; Farrell, 2011).</li>
</ul>
<p>Il risultato è una <em>regolarizzazione</em>: i valori estremi vengono attenuati verso la media di popolazione (<em>shrinkage</em>), riducendo il rischio che stime instabili o rumorose abbiano troppo peso. Si ottengono così inferenze più robuste e interpretabili, specialmente in campioni piccoli o con dati per soggetto limitati (Boehm et al., 2018; Rouder &amp; Lu, 2005).</p>
<section id="definizione-del-modello-stan-1" class="level3" data-number="46.1.1"><h3 data-number="46.1.1" class="anchored" data-anchor-id="definizione-del-modello-stan-1">
<span class="header-section-number">46.1.1</span> Definizione del modello Stan</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stancode</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=1&gt; Ntotal;</span></span>
<span><span class="st">  int&lt;lower=1&gt; Nsubj;</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; subject;</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; trial;</span></span>
<span><span class="st">  vector[Ntotal] observed_goal;   // z-score</span></span>
<span><span class="st">  vector[Ntotal] performance;     // z-score</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  // Iper-parametri di popolazione</span></span>
<span><span class="st">  real alpha_mean;</span></span>
<span><span class="st">  real&lt;lower=0&gt; alpha_sd;</span></span>
<span><span class="st">  real beta_mean;</span></span>
<span><span class="st">  real&lt;lower=0&gt; beta_sd;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Non-centrato: fattori standard per i soggetti</span></span>
<span><span class="st">  vector[Nsubj] alpha_raw;</span></span>
<span><span class="st">  vector[Nsubj] beta_raw;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  real&lt;lower=1e-6&gt; sigma;</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">transformed parameters {</span></span>
<span><span class="st">  // Ricostruzione parametri individuali</span></span>
<span><span class="st">  vector[Nsubj] alpha_unconstrained = alpha_mean + alpha_sd * alpha_raw;</span></span>
<span><span class="st">  vector[Nsubj] beta  = beta_mean  + beta_sd  * beta_raw;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Vincolo morbido su alpha per stabilità</span></span>
<span><span class="st">  vector[Nsubj] alpha = 0.95 * tanh(alpha_unconstrained);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  vector[Ntotal] ghat;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    if (trial[i] == 1) {</span></span>
<span><span class="st">      ghat[i] = observed_goal[i];</span></span>
<span><span class="st">    } else {</span></span>
<span><span class="st">      int s = subject[i];</span></span>
<span><span class="st">      ghat[i] = ghat[i - 1]</span></span>
<span><span class="st">                + alpha[s] * (performance[i - 1] - ghat[i - 1])</span></span>
<span><span class="st">                + beta[s];</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  // Iper-priori debolmente informativi (coerenti con z-score)</span></span>
<span><span class="st">  alpha_mean ~ normal(0, 0.5);</span></span>
<span><span class="st">  alpha_sd   ~ exponential(1);</span></span>
<span><span class="st">  beta_mean  ~ normal(0, 0.5);</span></span>
<span><span class="st">  beta_sd    ~ exponential(1);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  alpha_raw  ~ normal(0, 1);</span></span>
<span><span class="st">  beta_raw   ~ normal(0, 1);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  sigma ~ student_t(3, 0, 0.5);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Likelihood</span></span>
<span><span class="st">  observed_goal ~ normal(ghat, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">generated quantities {</span></span>
<span><span class="st">  vector[Ntotal] yrep;</span></span>
<span><span class="st">  vector[Ntotal] log_lik;</span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    yrep[i]    = normal_rng(ghat[i], sigma);</span></span>
<span><span class="st">    log_lik[i] = normal_lpdf(observed_goal[i] | ghat[i], sigma);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="differenza-chiave-rispetto-al-modello-precedente" class="level3" data-number="46.1.2"><h3 data-number="46.1.2" class="anchored" data-anchor-id="differenza-chiave-rispetto-al-modello-precedente">
<span class="header-section-number">46.1.2</span> Differenza chiave rispetto al modello precedente</h3>
<p>Nel <em>Person-Level Model</em> i parametri individuali sono stimati in modo indipendente; qui, invece, valgono relazioni del tipo:</p>
<p><span class="math display">\[
\alpha_s \sim \mathcal{N}(\alpha_{\text{mean}}, \alpha_{\text{sd}}), \quad
\beta_s \sim \mathcal{N}(\beta_{\text{mean}}, \beta_{\text{sd}})
\]</span></p>
<p>Questa struttura gerarchica introduce un livello di vincolo che collega i soggetti tra loro. Il vantaggio è duplice:</p>
<ol type="1">
<li>si mantengono le differenze individuali;</li>
<li>si sfrutta la somiglianza tra soggetti per ottenere stime più stabili e inferenze a livello di popolazione.</li>
</ol></section><section id="compilazione-ed-esecuzione" class="level3" data-number="46.1.3"><h3 data-number="46.1.3" class="anchored" data-anchor-id="compilazione-ed-esecuzione">
<span class="header-section-number">46.1.3</span> Compilazione ed esecuzione</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stanmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html">cmdstan_model</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/write_stan_file.html">write_stan_file</a></span><span class="op">(</span><span class="va">stancode</span><span class="op">)</span>,</span>
<span>  compile <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va">stanmod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">4790</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.995</span>,  <span class="co"># riduce divergenze</span></span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="analisi-dei-risultati-1" class="level3" data-number="46.1.4"><h3 data-number="46.1.4" class="anchored" data-anchor-id="analisi-dei-risultati-1">
<span class="header-section-number">46.1.4</span> Analisi dei risultati</h3>
<p>Eseguiamo l’analisi dei risultati seguendo lo schema usato sopra.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estrazione dei campioni posteriori come matrice </span></span>
<span><span class="va">standraws</span> <span class="op">&lt;-</span> <span class="va">fit2</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>format <span class="op">=</span> <span class="st">"draws_matrix"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Statistiche descrittive aggregate</span></span>
<span><span class="va">standraws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/subset_draws.html">subset_draws</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"sigma"</span>, <span class="st">"alpha_mean"</span>, <span class="st">"beta_mean"</span>, <span class="st">"alpha_sd"</span>, <span class="st">"beta_sd"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span></span>
<span>    <span class="va">mean</span>,</span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 125 × 5</span></span>
<span><span class="co">#&gt;    variable   mean `2.5%` `50%` `97.5%`</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 alpha[1]  0.576  0.292 0.587   0.795</span></span>
<span><span class="co">#&gt;  2 alpha[2]  0.385  0.059 0.393   0.664</span></span>
<span><span class="co">#&gt;  3 alpha[3]  0.320  0.019 0.328   0.582</span></span>
<span><span class="co">#&gt;  4 alpha[4]  0.490  0.145 0.505   0.749</span></span>
<span><span class="co">#&gt;  5 alpha[5]  0.367  0.096 0.371   0.621</span></span>
<span><span class="co">#&gt;  6 alpha[6]  0.552  0.257 0.563   0.775</span></span>
<span><span class="co">#&gt;  7 alpha[7]  0.467  0.215 0.471   0.704</span></span>
<span><span class="co">#&gt;  8 alpha[8]  0.221  0.015 0.216   0.459</span></span>
<span><span class="co">#&gt;  9 alpha[9]  0.510  0.209 0.520   0.754</span></span>
<span><span class="co">#&gt; 10 alpha[10] 0.637  0.425 0.644   0.812</span></span>
<span><span class="co">#&gt; # ℹ 115 more rows</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Estrai le draw per i parametri individuali (alpha e beta per ciascun soggetto)</span></span>
<span><span class="va">posteriors_person</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">alpha</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span>, <span class="va">beta</span><span class="op">[</span><span class="va">subject</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo degli intervalli credibili per ciascun soggetto</span></span>
<span><span class="va">CIs_person</span> <span class="op">&lt;-</span> <span class="va">posteriors_person</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      lower <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>      mean  <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,</span>
<span>      upper <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span>, .names <span class="op">=</span> <span class="st">"{.col}_{.fn}"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">alpha_mean</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>alpha_order <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">beta_mean</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>beta_order <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Grafico: intervalli credibili per alpha</span></span>
<span><span class="va">plot_person_alpha</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">alpha_order</span>, x <span class="op">=</span> <span class="va">alpha_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">alpha_order</span>, xmin <span class="op">=</span> <span class="va">alpha_lower</span>, xmax <span class="op">=</span> <span class="va">alpha_upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Soggetto"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Grafico: intervalli credibili per beta</span></span>
<span><span class="va">plot_person_beta</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">beta_order</span>, x <span class="op">=</span> <span class="va">beta_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">beta_order</span>, xmin <span class="op">=</span> <span class="va">beta_lower</span>, xmax <span class="op">=</span> <span class="va">beta_upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>, y <span class="op">=</span> <span class="st">"Soggetto"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Grafico: relazione tra alpha e beta per ciascun soggetto</span></span>
<span><span class="va">plot_person_alphabeta</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">CIs_person</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha_mean</span>, y <span class="op">=</span> <span class="va">beta_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">alpha_mean</span>, ymin <span class="op">=</span> <span class="va">beta_lower</span>, ymax <span class="op">=</span> <span class="va">beta_upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">beta_mean</span>, xmin <span class="op">=</span> <span class="va">alpha_lower</span>, xmax <span class="op">=</span> <span class="va">alpha_upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Infine, calcoliamo le stime a posteriori degli iper-parametri:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Riassunto per alpha_mean e beta_mean con intervallo al 95%</span></span>
<span><span class="va">standraws</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/subset_draws.html">subset_draws</a></span><span class="op">(</span>variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha_mean"</span>, <span class="st">"beta_mean"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_summary.html">summarise_draws</a></span><span class="op">(</span></span>
<span>    <span class="va">mean</span>,</span>
<span>    <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 4</span></span>
<span><span class="co">#&gt;   variable    mean `2.5%` `97.5%`</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 alpha_mean 0.621  0.521   0.732</span></span>
<span><span class="co">#&gt; 2 beta_mean  0.114  0.049   0.176</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione" class="level4" data-number="46.1.4.1"><h4 data-number="46.1.4.1" class="anchored" data-anchor-id="interpretazione">
<span class="header-section-number">46.1.4.1</span> Interpretazione</h4>
<p>Il modello gerarchico bayesiano fornisce inferenze a <em>due livelli</em>:</p>
<ul>
<li>
<strong>Livello individuale</strong>: parametri <span class="math inline">\(\alpha_s\)</span> e <span class="math inline">\(\beta_s\)</span> per ciascun partecipante, con i relativi intervalli credibili.</li>
<li>
<strong>Livello di popolazione</strong>: distribuzioni a priori/posteriori degli iper-parametri <span class="math inline">\(\alpha_{\text{mean}}, \alpha_{\text{sd}}, \beta_{\text{mean}}, \beta_{\text{sd}}\)</span>, più il parametro residuo <span class="math inline">\(\sigma\)</span>.</li>
</ul>
<p>I grafici per <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span> mostrano chiaramente l’eterogeneità interindividuale, mentre gli iper-parametri descrivono la tendenza generale.</p>
<p>Rispetto a un modello puramente individuale, gli intervalli credibili delle stime soggettive risultano <em>meno dispersi e più regolari</em>. Questo fenomeno è noto come <em>shrinkage</em>: le stime dei singoli soggetti sono “attirate” verso la media della popolazione, riducendo l’impatto dei dati rumorosi o scarsi.</p>
<p>Nel grafico bivariato, lo shrinkage si traduce in una distribuzione più compatta dei punti attorno al centro della distribuzione collettiva. L’effetto principale è una maggiore <em>robustezza</em> delle inferenze: le stime estreme vengono mitigate, la variabilità non plausibile è penalizzata e la capacità di generalizzare a nuovi dati risulta rafforzata (Boehm et al., 2018).</p>
</section></section></section><section id="differenze-tra-gruppi" class="level2" data-number="46.2"><h2 data-number="46.2" class="anchored" data-anchor-id="differenze-tra-gruppi">
<span class="header-section-number">46.2</span> Differenze tra gruppi</h2>
<p>In questo terzo modello estendiamo la struttura gerarchica introducendo le <em>condizioni sperimentali</em> (<em>approach</em> vs <em>avoidance</em>). L’idea è che i parametri individuali <span class="math inline">\(\alpha_s\)</span> e <span class="math inline">\(\beta_s\)</span> non siano estratti da un’unica distribuzione comune, ma da <em>distribuzioni diverse a seconda del gruppo</em> di appartenenza del soggetto.</p>
<p>In questo modo possiamo stimare, per ciascuna condizione, una media e una deviazione standard a livello di popolazione:</p>
<ul>
<li>
<span class="math inline">\(\alpha_{\text{mean},c}, \alpha_{\text{sd},c}\)</span>,</li>
<li>
<span class="math inline">\(\beta_{\text{mean},c}, \beta_{\text{sd},c}\)</span> con <span class="math inline">\(c \in \{1,2\}\)</span>.</li>
</ul>
<section id="preparazione-dei-dati-1" class="level3" data-number="46.2.1"><h3 data-number="46.2.1" class="anchored" data-anchor-id="preparazione-dei-dati-1">
<span class="header-section-number">46.2.1</span> Preparazione dei dati</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 1) Ordina per soggetto e trial</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">subject</span>, <span class="va">trial</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Codifica la condizione come intero (1 = approach, 2 = avoidance)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cond_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verifica che ogni soggetto appartenga a una sola condizione</span></span>
<span><span class="va">chk</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span> <span class="fu">distinct</span><span class="op">(</span><span class="va">subject</span>, <span class="va">cond_id</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">count</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">chk</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>  <span class="co"># se fallisce, il design non è between-subject</span></span>
<span></span>
<span><span class="co"># 3) Standardizza goal e performance su tutto il dataset</span></span>
<span><span class="va">goal_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">goal</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>; <span class="va">goal_sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">goal</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">perf_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">performance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>; <span class="va">perf_sd</span> <span class="op">&lt;-</span> <span class="fu">sd</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">performance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    goal_z <span class="op">=</span> <span class="op">(</span><span class="va">goal</span> <span class="op">-</span> <span class="va">goal_mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">goal_sd</span>,</span>
<span>    perf_z <span class="op">=</span> <span class="op">(</span><span class="va">performance</span> <span class="op">-</span> <span class="va">perf_mean</span><span class="op">)</span> <span class="op">/</span> <span class="va">perf_sd</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># 4) Vettore che assegna a ciascun soggetto la sua condizione</span></span>
<span><span class="va">subjects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">subject</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">subj_cond</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>cond <span class="op">=</span> <span class="fu">first</span><span class="op">(</span><span class="va">cond_id</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">cond</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 5) Lista per Stan</span></span>
<span><span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  Ntotal        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,</span>
<span>  Nsubj         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">subjects</span><span class="op">)</span>,</span>
<span>  C             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">cond_id</span><span class="op">)</span><span class="op">)</span>,   <span class="co"># numero condizioni</span></span>
<span>  subject       <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">subject</span>,</span>
<span>  trial         <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">trial</span>,</span>
<span>  observed_goal <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">goal_z</span>,</span>
<span>  performance   <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">perf_z</span>,</span>
<span>  subj_cond     <span class="op">=</span> <span class="va">subj_cond</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">stan_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 8</span></span>
<span><span class="co">#&gt;  $ Ntotal       : int 600</span></span>
<span><span class="co">#&gt;  $ Nsubj        : int 60</span></span>
<span><span class="co">#&gt;  $ C            : int 2</span></span>
<span><span class="co">#&gt;  $ subject      : int [1:600] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ trial        : int [1:600] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ observed_goal: num [1:600] -2 -2 -2 -1.07 -1.07 ...</span></span>
<span><span class="co">#&gt;  $ performance  : num [1:600] -2.89 -1.99 -1.99 -1.1 -1.99 ...</span></span>
<span><span class="co">#&gt;  $ subj_cond    : int [1:60] 1 2 2 1 2 1 2 1 2 1 ...</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="definizione-del-modello-stan-2" class="level3" data-number="46.2.2"><h3 data-number="46.2.2" class="anchored" data-anchor-id="definizione-del-modello-stan-2">
<span class="header-section-number">46.2.2</span> Definizione del modello Stan</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stancode</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">// Modello gerarchico con iper-parametri specifici per condizione</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=1&gt; Ntotal;</span></span>
<span><span class="st">  int&lt;lower=1&gt; Nsubj;</span></span>
<span><span class="st">  int&lt;lower=1&gt; C;                            // numero condizioni</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; subject;        // 1..Nsubj</span></span>
<span><span class="st">  array[Ntotal] int&lt;lower=1&gt; trial;          // 1..T all'interno di soggetto</span></span>
<span><span class="st">  vector[Ntotal] observed_goal;              // z-score</span></span>
<span><span class="st">  vector[Ntotal] performance;                // z-score</span></span>
<span><span class="st">  array[Nsubj] int&lt;lower=1, upper=C&gt; subj_cond; // condizione per soggetto</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  // Iper-parametri per condizione</span></span>
<span><span class="st">  vector[C] alpha_mean;</span></span>
<span><span class="st">  vector&lt;lower=0&gt;[C] alpha_sd;</span></span>
<span><span class="st">  vector[C] beta_mean;</span></span>
<span><span class="st">  vector&lt;lower=0&gt;[C] beta_sd;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Non-centrato: fattori standard per soggetti</span></span>
<span><span class="st">  vector[Nsubj] alpha_raw;</span></span>
<span><span class="st">  vector[Nsubj] beta_raw;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  real&lt;lower=1e-6&gt; sigma;</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">transformed parameters {</span></span>
<span><span class="st">  vector[Nsubj] alpha_uncon;</span></span>
<span><span class="st">  vector[Nsubj] beta;</span></span>
<span><span class="st">  vector[Nsubj] alpha;           </span></span>
<span><span class="st">  vector[Ntotal] ghat;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Ricostruzione dei parametri individuali in base alla condizione</span></span>
<span><span class="st">  for (s in 1:Nsubj) {</span></span>
<span><span class="st">    int c = subj_cond[s];</span></span>
<span><span class="st">    alpha_uncon[s] = alpha_mean[c] + alpha_sd[c] * alpha_raw[s];</span></span>
<span><span class="st">    beta[s]        = beta_mean[c]  + beta_sd[c]  * beta_raw[s];</span></span>
<span><span class="st">    alpha[s]       = 0.95 * tanh(alpha_uncon[s]); // vincolo di stabilità</span></span>
<span><span class="st">  }</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Dinamica</span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    if (trial[i] == 1) {</span></span>
<span><span class="st">      ghat[i] = observed_goal[i];</span></span>
<span><span class="st">    } else {</span></span>
<span><span class="st">      int s = subject[i];</span></span>
<span><span class="st">      ghat[i] = ghat[i - 1]</span></span>
<span><span class="st">                + alpha[s] * (performance[i - 1] - ghat[i - 1])</span></span>
<span><span class="st">                + beta[s];</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  // Iper-priori debolmente informativi</span></span>
<span><span class="st">  alpha_mean ~ normal(0, 0.5);</span></span>
<span><span class="st">  alpha_sd   ~ exponential(1);</span></span>
<span><span class="st">  beta_mean  ~ normal(0, 0.5);</span></span>
<span><span class="st">  beta_sd    ~ exponential(1);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  alpha_raw  ~ normal(0, 1);</span></span>
<span><span class="st">  beta_raw   ~ normal(0, 1);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  sigma ~ student_t(3, 0, 0.5);</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Likelihood</span></span>
<span><span class="st">  observed_goal ~ normal(ghat, sigma);</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">generated quantities {</span></span>
<span><span class="st">  vector[Ntotal] yrep;</span></span>
<span><span class="st">  vector[Ntotal] log_lik;</span></span>
<span><span class="st">  for (i in 1:Ntotal) {</span></span>
<span><span class="st">    yrep[i]    = normal_rng(ghat[i], sigma);</span></span>
<span><span class="st">    log_lik[i] = normal_lpdf(observed_goal[i] | ghat[i], sigma);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="come-funziona-la-distinzione-tra-gruppi" class="level3" data-number="46.2.3"><h3 data-number="46.2.3" class="anchored" data-anchor-id="come-funziona-la-distinzione-tra-gruppi">
<span class="header-section-number">46.2.3</span> Come funziona la distinzione tra gruppi</h3>
<ol type="1">
<li><p><strong>Assegnazione condizione</strong> Nel blocco <code>data</code>, il vettore <code>subj_cond</code> assegna a ciascun soggetto il numero della condizione (1 = <em>approach</em>, 2 = <em>avoidance</em>).</p></li>
<li>
<p><strong>Parametri di gruppo</strong> Gli iper-parametri <code>alpha_mean[c]</code>, <code>alpha_sd[c]</code>, <code>beta_mean[c]</code>, <code>beta_sd[c]</code> sono specifici per condizione. Ad esempio:</p>
<ul>
<li>
<code>alpha_mean[1]</code> = media di <span class="math inline">\(\alpha\)</span> per il gruppo <em>approach</em>
</li>
<li>
<code>alpha_mean[2]</code> = media di <span class="math inline">\(\alpha\)</span> per il gruppo <em>avoidance</em>
</li>
</ul>
</li>
<li><p><strong>Parametri individuali</strong> In <code>transformed parameters</code>, i parametri dei singoli soggetti vengono generati in base alla condizione di appartenenza. Così, i soggetti <em>approach</em> e quelli <em>avoidance</em> condividono rispettivamente due diverse distribuzioni di partenza.</p></li>
</ol>
<p>In sintesi, il modello permette di stimare non solo le differenze tra individui, ma anche <em>le differenze sistematiche tra condizioni sperimentali</em>.</p>
</section><section id="compilazione-ed-esecuzione-1" class="level3" data-number="46.2.4"><h3 data-number="46.2.4" class="anchored" data-anchor-id="compilazione-ed-esecuzione-1">
<span class="header-section-number">46.2.4</span> Compilazione ed esecuzione</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stanmod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html">cmdstan_model</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/write_stan_file.html">write_stan_file</a></span><span class="op">(</span><span class="va">stancode</span><span class="op">)</span>, compile <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="va">stanmod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.999</span>,   <span class="co"># ↑ riduce divergenze</span></span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="risultati" class="level3" data-number="46.2.5"><h3 data-number="46.2.5" class="anchored" data-anchor-id="risultati">
<span class="header-section-number">46.2.5</span> Risultati</h3>
<section id="ispezione-rapida-delle-variabili-opzionale" class="level4" data-number="46.2.5.1"><h4 data-number="46.2.5.1" class="anchored" data-anchor-id="ispezione-rapida-delle-variabili-opzionale">
<span class="header-section-number">46.2.5.1</span> Ispezione rapida delle variabili (opzionale)</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_df.html">as_draws_df</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>   <span class="co"># oppure: fit3$draws(format = "df")</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"alpha_mean|beta_mean|alpha\\[|beta\\["</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1] "alpha_mean[1]" "alpha_mean[2]" "beta_mean[1]"  "beta_mean[2]" </span></span>
<span><span class="co">#&gt;   [5] "beta[1]"       "beta[2]"       "beta[3]"       "beta[4]"      </span></span>
<span><span class="co">#&gt;   [9] "beta[5]"       "beta[6]"       "beta[7]"       "beta[8]"      </span></span>
<span><span class="co">#&gt;  [13] "beta[9]"       "beta[10]"      "beta[11]"      "beta[12]"     </span></span>
<span><span class="co">#&gt;  [17] "beta[13]"      "beta[14]"      "beta[15]"      "beta[16]"     </span></span>
<span><span class="co">#&gt;  [21] "beta[17]"      "beta[18]"      "beta[19]"      "beta[20]"     </span></span>
<span><span class="co">#&gt;  [25] "beta[21]"      "beta[22]"      "beta[23]"      "beta[24]"     </span></span>
<span><span class="co">#&gt;  [29] "beta[25]"      "beta[26]"      "beta[27]"      "beta[28]"     </span></span>
<span><span class="co">#&gt;  [33] "beta[29]"      "beta[30]"      "beta[31]"      "beta[32]"     </span></span>
<span><span class="co">#&gt;  [37] "beta[33]"      "beta[34]"      "beta[35]"      "beta[36]"     </span></span>
<span><span class="co">#&gt;  [41] "beta[37]"      "beta[38]"      "beta[39]"      "beta[40]"     </span></span>
<span><span class="co">#&gt;  [45] "beta[41]"      "beta[42]"      "beta[43]"      "beta[44]"     </span></span>
<span><span class="co">#&gt;  [49] "beta[45]"      "beta[46]"      "beta[47]"      "beta[48]"     </span></span>
<span><span class="co">#&gt;  [53] "beta[49]"      "beta[50]"      "beta[51]"      "beta[52]"     </span></span>
<span><span class="co">#&gt;  [57] "beta[53]"      "beta[54]"      "beta[55]"      "beta[56]"     </span></span>
<span><span class="co">#&gt;  [61] "beta[57]"      "beta[58]"      "beta[59]"      "beta[60]"     </span></span>
<span><span class="co">#&gt;  [65] "alpha[1]"      "alpha[2]"      "alpha[3]"      "alpha[4]"     </span></span>
<span><span class="co">#&gt;  [69] "alpha[5]"      "alpha[6]"      "alpha[7]"      "alpha[8]"     </span></span>
<span><span class="co">#&gt;  [73] "alpha[9]"      "alpha[10]"     "alpha[11]"     "alpha[12]"    </span></span>
<span><span class="co">#&gt;  [77] "alpha[13]"     "alpha[14]"     "alpha[15]"     "alpha[16]"    </span></span>
<span><span class="co">#&gt;  [81] "alpha[17]"     "alpha[18]"     "alpha[19]"     "alpha[20]"    </span></span>
<span><span class="co">#&gt;  [85] "alpha[21]"     "alpha[22]"     "alpha[23]"     "alpha[24]"    </span></span>
<span><span class="co">#&gt;  [89] "alpha[25]"     "alpha[26]"     "alpha[27]"     "alpha[28]"    </span></span>
<span><span class="co">#&gt;  [93] "alpha[29]"     "alpha[30]"     "alpha[31]"     "alpha[32]"    </span></span>
<span><span class="co">#&gt;  [97] "alpha[33]"     "alpha[34]"     "alpha[35]"     "alpha[36]"    </span></span>
<span><span class="co">#&gt; [101] "alpha[37]"     "alpha[38]"     "alpha[39]"     "alpha[40]"    </span></span>
<span><span class="co">#&gt; [105] "alpha[41]"     "alpha[42]"     "alpha[43]"     "alpha[44]"    </span></span>
<span><span class="co">#&gt; [109] "alpha[45]"     "alpha[46]"     "alpha[47]"     "alpha[48]"    </span></span>
<span><span class="co">#&gt; [113] "alpha[49]"     "alpha[50]"     "alpha[51]"     "alpha[52]"    </span></span>
<span><span class="co">#&gt; [117] "alpha[53]"     "alpha[54]"     "alpha[55]"     "alpha[56]"    </span></span>
<span><span class="co">#&gt; [121] "alpha[57]"     "alpha[58]"     "alpha[59]"     "alpha[60]"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="differenze-tra-condizioni-sugli-iper-parametri" class="level4" data-number="46.2.5.2"><h4 data-number="46.2.5.2" class="anchored" data-anchor-id="differenze-tra-condizioni-sugli-iper-parametri">
<span class="header-section-number">46.2.5.2</span> Differenze tra condizioni sugli iper-parametri</h4>
<p>L’obiettivo è verificare se i parametri di popolazione <em><span class="math inline">\(\alpha\)</span></em> (tasso di aggiornamento) e <em><span class="math inline">\(\beta\)</span></em> (drift/tendenza) differiscono tra le due condizioni sperimentali (<em>approach</em> vs <em>avoidance</em>). Per rispondere a questa domanda procediamo in quattro passaggi:<br>
1. recuperiamo le etichette delle condizioni dal dataset;<br>
2. calcoliamo il contrasto tra condizioni (<span class="math inline">\(\Delta =\)</span> condizione<span class="math inline">\(_2\)</span> − condizione<span class="math inline">\(_1\)</span>);<br>
3. stimiamo la media della differenza, il 95% CrI e la probabilità a posteriori che la differenza sia negativa;<br>
4. visualizziamo i risultati per facilitarne l’interpretazione.</p>
<section id="step-1.-etichette-di-condizione" class="level5" data-number="46.2.5.2.1"><h5 data-number="46.2.5.2.1" class="anchored" data-anchor-id="step-1.-etichette-di-condizione">
<span class="header-section-number">46.2.5.2.1</span> Step 1. Etichette di condizione</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cond_labels</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">cond_id</span>, <span class="va">condition</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">cond_id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">condition</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cond_labels</span></span>
<span><span class="co">#&gt; [1] "approach"  "avoidance"</span></span>
<span><span class="co"># Esempio: c("approach", "avoidance")</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-2.-contrasto-su-α-media-per-condizione" class="level5" data-number="46.2.5.2.2"><h5 data-number="46.2.5.2.2" class="anchored" data-anchor-id="step-2.-contrasto-su-α-media-per-condizione">
<span class="header-section-number">46.2.5.2.2</span> Step 2. Contrasto su α (media per condizione)</h5>
<p>Calcoliamo <span class="math inline">\(\Delta_\alpha = \alpha_{\text{avoidance}} - \alpha_{\text{approach}}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">delta_alpha</span> <span class="op">&lt;-</span> <span class="va">fit3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">alpha_mean</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cond</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="va">cond_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">cond</span>, values_from <span class="op">=</span> <span class="va">alpha_mean</span>, names_prefix <span class="op">=</span> <span class="st">"alpha_mean_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>delta_alpha_mean <span class="op">=</span> <span class="va">alpha_mean_avoidance</span> <span class="op">-</span> <span class="va">alpha_mean_approach</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delta_alpha</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">delta_alpha_mean</span><span class="op">)</span>,</span>
<span>    low95  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">delta_alpha_mean</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    upp95  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">delta_alpha_mean</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    p_lt0  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">delta_alpha_mean</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;     mean  low95   upp95 p_lt0</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 -0.247 -0.481 -0.0349 0.989</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-3.-contrasto-su-β-media-per-condizione" class="level5" data-number="46.2.5.2.3"><h5 data-number="46.2.5.2.3" class="anchored" data-anchor-id="step-3.-contrasto-su-β-media-per-condizione">
<span class="header-section-number">46.2.5.2.3</span> Step 3. Contrasto su β (media per condizione)</h5>
<p>In modo analogo, calcoliamo <span class="math inline">\(\Delta_\beta = \beta_{\text{avoidance}} - \beta_{\text{approach}}\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">delta_beta</span> <span class="op">&lt;-</span> <span class="va">fit3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">beta_mean</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cond</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="va">cond_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">cond</span>, values_from <span class="op">=</span> <span class="va">beta_mean</span>, names_prefix <span class="op">=</span> <span class="st">"beta_mean_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>delta_beta_mean <span class="op">=</span> <span class="va">beta_mean_avoidance</span> <span class="op">-</span> <span class="va">beta_mean_approach</span><span class="op">)</span></span>
<span></span>
<span><span class="va">delta_beta</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    mean   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">delta_beta_mean</span><span class="op">)</span>,</span>
<span>    low95  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">delta_beta_mean</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    upp95  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">delta_beta_mean</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    p_lt0  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">delta_beta_mean</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 × 4</span></span>
<span><span class="co">#&gt;     mean  low95   upp95 p_lt0</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 -0.126 -0.251 0.00152 0.974</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="step-4.-visualizzazione-delle-posterior" class="level5" data-number="46.2.5.2.4"><h5 data-number="46.2.5.2.4" class="anchored" data-anchor-id="step-4.-visualizzazione-delle-posterior">
<span class="header-section-number">46.2.5.2.4</span> Step 4. Visualizzazione delle posterior</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">post_alpha</span> <span class="op">&lt;-</span> <span class="va">fit3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">alpha_mean</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>parameter <span class="op">=</span> <span class="st">"alpha_mean"</span>,</span>
<span>         condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cond</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="va">cond_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>value <span class="op">=</span> <span class="va">alpha_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">post_beta</span> <span class="op">&lt;-</span> <span class="va">fit3</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">beta_mean</span><span class="op">[</span><span class="va">cond</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>parameter <span class="op">=</span> <span class="st">"beta_mean"</span>,</span>
<span>         condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cond</span>, levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, labels <span class="op">=</span> <span class="va">cond_labels</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>value <span class="op">=</span> <span class="va">beta_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="va">posterior_both</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">post_alpha</span>, <span class="va">post_beta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">posterior_both</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">parameter</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Posterior mean"</span>, y <span class="op">=</span> <span class="st">"Density"</span>, fill <span class="op">=</span> <span class="st">"Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="risultati-numerici" class="level5" data-number="46.2.5.2.5"><h5 data-number="46.2.5.2.5" class="anchored" data-anchor-id="risultati-numerici">
<span class="header-section-number">46.2.5.2.5</span> Risultati numerici</h5>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prob_delta_alpha_neg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[1]`</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">prob_delta_beta_neg</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[1]`</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"P(delta_alpha_mean &lt; 0):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_delta_alpha_neg</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(delta_alpha_mean &lt; 0): 0.989</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"P(delta_beta_mean &lt; 0):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">prob_delta_beta_neg</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; P(delta_beta_mean &lt; 0): 0.974</span></span>
<span></span>
<span><span class="va">summary_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha_mean"</span>, <span class="st">"beta_mean"</span><span class="op">)</span>,</span>
<span>  delta_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[1]`</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[1]`</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  lower_95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[1]`</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[1]`</span>, <span class="fl">0.025</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  upper_95 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`alpha_mean[1]`</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[2]`</span> <span class="op">-</span> <span class="va">draws_df</span><span class="op">$</span><span class="va">`beta_mean[1]`</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  prob_below_0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prob_delta_alpha_neg</span>, <span class="va">prob_delta_beta_neg</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">summary_df</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   parameter  delta_mean lower_95 upper_95 prob_below_0</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 alpha_mean     -0.247   -0.481 -0.0349         0.989</span></span>
<span><span class="co">#&gt; 2 beta_mean      -0.126   -0.251  0.00152        0.974</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">summary_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">parameter</span>, y <span class="op">=</span> <span class="va">delta_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_errorbar</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower_95</span>, ymax <span class="op">=</span> <span class="va">upper_95</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Parametro"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Differenza media\n(cond2 - cond1)"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02_dynamic_models_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="interpretazione-dei-risultati" class="level5" data-number="46.2.5.2.6"><h5 data-number="46.2.5.2.6" class="anchored" data-anchor-id="interpretazione-dei-risultati">
<span class="header-section-number">46.2.5.2.6</span> Interpretazione dei risultati</h5>
<ul>
<li><p><strong><span class="math inline">\(\Delta_\alpha\)</span> (avoidance − approach)</strong> Media = −0.247; CrI 95% = [−0.481, −0.035]; <span class="math inline">\(P(\Delta&lt;0) = 0.989\)</span>. → Evidenza forte che l’aggiornamento (<span class="math inline">\(\alpha\)</span>) è più basso in <em>avoidance</em>. L’effetto è moderato (≈0.25 SD).</p></li>
<li><p><strong><span class="math inline">\(\Delta_\beta\)</span> (avoidance − approach)</strong> Media = −0.126; CrI 95% = [−0.251, 0.002]; <span class="math inline">\(P(\Delta&lt;0) = 0.974\)</span>. → La probabilità che <span class="math inline">\(\beta\)</span> sia più basso in <em>avoidance</em> è elevata, ma l’intervallo credibile include lo zero. Evidenza suggestiva ma non conclusiva.</p></li>
</ul></section><section id="significato-sostantivo" class="level5" data-number="46.2.5.2.7"><h5 data-number="46.2.5.2.7" class="anchored" data-anchor-id="significato-sostantivo">
<span class="header-section-number">46.2.5.2.7</span> Significato sostantivo</h5>
<ul>
<li>In <em>avoidance</em>, i partecipanti <em>aggiornano più lentamente</em> le loro credenze (α più basso).</li>
<li>Anche la tendenza (β) appare più bassa, ma con incertezza residua.</li>
</ul>
<p>Questi risultati indicano che la manipolazione sperimentale ha un impatto soprattutto sulla velocità di apprendimento, mentre l’effetto sulla componente di drift resta da confermare con più dati o modelli più sensibili.</p>
</section></section></section></section><section id="confronto-tra-modelli" class="level2" data-number="46.3"><h2 data-number="46.3" class="anchored" data-anchor-id="confronto-tra-modelli">
<span class="header-section-number">46.3</span> Confronto tra modelli</h2>
<p>Per valutare quale modello descriva meglio i dati abbiamo utilizzato la cross-validazione leave-one-out (LOO-CV), che stima la expected log predictive density (ELPD). Un ELPD più alto indica predizioni più accurate.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">log_lik1</span> <span class="op">&lt;-</span> <span class="va">fit1</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span>
<span><span class="va">log_lik2</span> <span class="op">&lt;-</span> <span class="va">fit2</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span>
<span><span class="va">log_lik3</span> <span class="op">&lt;-</span> <span class="va">fit3</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span>variables <span class="op">=</span> <span class="st">"log_lik"</span>, format <span class="op">=</span> <span class="st">"matrix"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calcola LOO per ciascun modello</span></span>
<span><span class="va">loo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">log_lik1</span><span class="op">)</span></span>
<span><span class="va">loo2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">log_lik2</span><span class="op">)</span></span>
<span><span class="va">loo3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo.html">loo</a></span><span class="op">(</span><span class="va">log_lik3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Confronto tra i modelli</span></span>
<span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/loo/reference/loo_compare.html">loo_compare</a></span><span class="op">(</span><span class="va">loo1</span>, <span class="va">loo2</span>, <span class="va">loo3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">)</span></span>
<span><span class="co">#&gt;        elpd_diff se_diff</span></span>
<span><span class="co">#&gt; model3   0.0       0.0  </span></span>
<span><span class="co">#&gt; model2  -4.7       3.9  </span></span>
<span><span class="co">#&gt; model1 -23.2       7.6</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il modello <em>gerarchico con condizione (Model 3)</em> ottiene la predizione migliore. Tuttavia, il confronto con il <em>modello gerarchico senza condizione (Model 2)</em> mostra una differenza di ELPD pari a −4.7, con un errore standard di 3.9. Questa differenza è <em>piccola rispetto all’incertezza della stima</em>, quindi non possiamo affermare con sicurezza che includere la condizione migliori la predizione, anche se la tendenza è in quella direzione.</p>
<p>Diverso il discorso per il <em>modello non gerarchico (Model 1)</em>: la perdita di ELPD rispetto a Model 3 è molto ampia (−23.3, con SE = 7.6). In questo caso la differenza è sufficientemente grande da concludere che Model 1 produce predizioni nettamente peggiori.</p>
<section id="cosa-impariamo" class="level4" data-number="46.3.0.1"><h4 data-number="46.3.0.1" class="anchored" data-anchor-id="cosa-impariamo">
<span class="header-section-number">46.3.0.1</span> Cosa impariamo</h4>
<ol type="1">
<li><p><em>La gerarchia è cruciale</em>: i modelli gerarchici (Model 2 e 3) descrivono i dati molto meglio del modello non gerarchico. Questo conferma l’importanza di “condividere informazione” tra soggetti per ottenere stime più stabili e predizioni più accurate.</p></li>
<li><p><em>L’effetto della condizione è plausibile, ma non certo</em>: il modello con condizione (Model 3) tende a comportarsi meglio, ma il vantaggio rispetto al modello gerarchico semplice (Model 2) non è statisticamente robusto. Questo risultato è coerente con le stime dei parametri: la differenza tra condizioni sembra più marcata per <span class="math inline">\(\alpha\)</span>, meno per <span class="math inline">\(\beta\)</span>.</p></li>
<li>
<p><em>Scelta del modello</em>:</p>
<ul>
<li>se l’obiettivo principale è la parsimonia, Model 2 è già soddisfacente;</li>
<li>se vogliamo testare esplicitamente l’effetto della condizione, Model 3 è preferibile, anche se il guadagno predittivo rimane incerto.</li>
</ul>
</li>
</ol></section></section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>In questo capitolo abbiamo seguito un percorso <em>dal singolo al collettivo</em>, aumentando la struttura del modello in modo controllato:</p>
<ol type="1">
<li><p><strong>Person-level</strong>: stime soggetto-specifiche di <span class="math inline">\((\alpha_i, \beta_i)\)</span> rivelano una marcata <em>eterogeneità</em> tra individui (diversa velocità di aggiornamento e diversa deriva). Il prezzo da pagare è l’assenza di condivisione dell’informazione: le stime restano fragili quando i dati per soggetto sono scarsi.</p></li>
<li><p><strong>Gerarchico</strong>: trattando i parametri individuali come <em>variabili casuali</em> provenienti da distribuzioni di popolazione, otteniamo inferenze più <em>stabili</em> e <em>generalizzabili</em>. Lo <em>shrinkage</em> attenua gli estremi non supportati dai dati, migliora le stime dei singoli e fornisce contemporaneamente un <em>quadro di popolazione</em>.</p></li>
<li><p><strong>Gruppi noti</strong>: introducendo iper-parametri per condizione, isoliamo differenze <em>sistematiche</em> tra gruppi a livello di popolazione. I risultati indicano effetti credibili soprattutto su <span class="math inline">\(\alpha\)</span> (velocità di aggiornamento), con evidenza più incerta su <span class="math inline">\(\beta\)</span>, coerentemente con l’idea che la manipolazione sperimentale incida primariamente sui processi di apprendimento.</p></li>
</ol>
<p>Sul piano <em>predittivo</em>, il confronto tramite <em>ELPD/LOO-CV</em> mostra che la <em>gerarchia</em> è cruciale: i modelli multilevel predicono i dati sensibilmente meglio del modello non gerarchico. Il vantaggio del modello con <em>condizione</em> rispetto al gerarchico semplice è orientato nella direzione attesa ma di <em>entità modesta</em> rispetto all’incertezza della stima: utile quando l’obiettivo è testare l’effetto sperimentale, meno decisivo se si privilegia la parsimonia.</p>
<p>Tre messaggi metodologici:</p>
<ul>
<li>
<strong>Progettare la struttura</strong>: scegliere un livello di complessità che rifletta la dipendenza naturale dei dati (tra individui e tra condizioni), evitando sia l’eccesso di libertà sia il vincolo eccessivo.</li>
<li>
<strong>Inferenza come integrazione</strong>: combinare informazione individuale e di popolazione produce stime più affidabili e interpretazioni più chiare.</li>
<li>
<strong>Valutazione predittiva</strong>: selezionare i modelli con criteri out-of-sample (ELPD/LOO) allinea la scelta del modello all’obiettivo della <em>generalizzazione</em>.</li>
</ul>
<p>In sintesi, passare da person-level a <em>gerarchie con gruppi noti</em> non è solo un affinamento tecnico: è un cambiamento concettuale verso modelli che <em>rappresentano la popolazione</em>, rispettano l’eterogeneità e quantificano con rigore le differenze tra condizioni. Questo impianto pone basi solide per ulteriori estensioni (p.es. <em>mixture</em> per identificare sottogruppi latenti, strutture più ricche di dipendenza temporale), mantenendo come bussola la <em>capacità predittiva</em> e la <em>coerenza psicologica</em> delle ipotesi.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] cmdstanr_0.9.0        pillar_1.11.0         tinytable_0.13.0     </span></span>
<span><span class="co">#&gt;  [4] patchwork_1.3.2       ggdist_3.3.3          tidybayes_3.0.7      </span></span>
<span><span class="co">#&gt;  [7] bayesplot_1.14.0      ggplot2_3.5.2         reliabilitydiag_0.2.1</span></span>
<span><span class="co">#&gt; [10] priorsense_1.1.1      posterior_1.6.1       loo_2.8.0            </span></span>
<span><span class="co">#&gt; [13] rstan_2.32.7          StanHeaders_2.32.10   brms_2.22.0          </span></span>
<span><span class="co">#&gt; [16] Rcpp_1.1.0            sessioninfo_1.2.3     conflicted_1.2.0     </span></span>
<span><span class="co">#&gt; [19] janitor_2.2.1         matrixStats_1.5.0     modelr_0.1.11        </span></span>
<span><span class="co">#&gt; [22] tibble_3.3.0          dplyr_1.1.4           tidyr_1.3.1          </span></span>
<span><span class="co">#&gt; [25] rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        systemfonts_1.2.3    </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5           stringr_1.5.1         pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt; [13] arrayhelpers_1.1-0    fastmap_1.2.0         backports_1.5.0      </span></span>
<span><span class="co">#&gt; [16] labeling_0.4.3        utf8_1.2.6            rmarkdown_2.29       </span></span>
<span><span class="co">#&gt; [19] ps_1.9.1              ragg_1.5.0            purrr_1.1.0          </span></span>
<span><span class="co">#&gt; [22] xfun_0.53             cachem_1.1.0          jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [25] broom_1.0.9           parallel_4.5.1        R6_2.6.1             </span></span>
<span><span class="co">#&gt; [28] stringi_1.8.7         RColorBrewer_1.1-3    lubridate_1.9.4      </span></span>
<span><span class="co">#&gt; [31] estimability_1.5.1    knitr_1.50            zoo_1.8-14           </span></span>
<span><span class="co">#&gt; [34] R.utils_2.13.0        Matrix_1.7-4          splines_4.5.1        </span></span>
<span><span class="co">#&gt; [37] timechange_0.3.0      tidyselect_1.2.1      abind_1.4-8          </span></span>
<span><span class="co">#&gt; [40] yaml_2.3.10           codetools_0.2-20      curl_7.0.0           </span></span>
<span><span class="co">#&gt; [43] processx_3.8.6        pkgbuild_1.4.8        lattice_0.22-7       </span></span>
<span><span class="co">#&gt; [46] withr_3.0.2           bridgesampling_1.1-2  coda_0.19-4.1        </span></span>
<span><span class="co">#&gt; [49] evaluate_1.0.5        survival_3.8-3        RcppParallel_5.1.11-1</span></span>
<span><span class="co">#&gt; [52] tensorA_0.36.2.1      checkmate_2.3.3       stats4_4.5.1         </span></span>
<span><span class="co">#&gt; [55] distributional_0.5.0  generics_0.1.4        rprojroot_2.1.1      </span></span>
<span><span class="co">#&gt; [58] rstantools_2.5.0      scales_1.4.0          xtable_1.8-4         </span></span>
<span><span class="co">#&gt; [61] glue_1.8.0            emmeans_1.11.2-8      tools_4.5.1          </span></span>
<span><span class="co">#&gt; [64] data.table_1.17.8     mvtnorm_1.3-3         grid_4.5.1           </span></span>
<span><span class="co">#&gt; [67] QuickJSR_1.8.0        colorspace_2.1-1      nlme_3.1-168         </span></span>
<span><span class="co">#&gt; [70] cli_3.6.5             textshaping_1.0.3     svUnit_1.0.8         </span></span>
<span><span class="co">#&gt; [73] Brobdingnag_1.2-9     V8_7.0.0              gtable_0.3.6         </span></span>
<span><span class="co">#&gt; [76] R.methodsS3_1.8.2     digest_0.6.37         TH.data_1.1-4        </span></span>
<span><span class="co">#&gt; [79] htmlwidgets_1.6.4     farver_2.1.2          R.oo_1.27.1          </span></span>
<span><span class="co">#&gt; [82] memoise_2.0.1         htmltools_0.5.8.1     lifecycle_1.0.4      </span></span>
<span><span class="co">#&gt; [85] MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-knight2023tutorial" class="csl-entry" role="listitem">
Knight, E., Neal, A., Palada, H., &amp; Ballard, T. (2023). A Tutorial on Bayesian Modeling of Change Across Time, Individuals, and Groups. <em>Computational Brain &amp; Behavior</em>, <em>6</em>(4), 697–718.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/utet-companion\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/formal_models/01_dynamic_models.html" class="pagination-link" aria-label="Il modello di revisione degli obiettivi">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="pagination-link" aria-label="Il modello di Rescorla–Wagner">
        <span class="nav-page-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Metodi bayesiani in psicologia — Companion site</strong>.<br>
Materiali di accompagnamento e approfondimento al manuale UTET.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/utet-companion/blob/main/chapters/formal_models/02_dynamic_models.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-companion/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>