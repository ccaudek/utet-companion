<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>46&nbsp; Il modello di Rescorla–Wagner – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/formal_models/04_study_method.html" rel="next">
<link href="../../chapters/formal_models/02_dynamic_models.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/formal_models/introduction_sec.html">Modelli</a></li><li class="breadcrumb-item"><a href="../../chapters/formal_models/03_rescorla_wagner.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#il-modello-di-rescorlawagner" id="toc-il-modello-di-rescorlawagner" class="nav-link active" data-scroll-target="#il-modello-di-rescorlawagner"><span class="header-section-number">46.1</span> Il Modello di Rescorla–Wagner</a></li>
  <li><a href="#simulazione" id="toc-simulazione" class="nav-link" data-scroll-target="#simulazione"><span class="header-section-number">46.2</span> Simulazione</a></li>
  <li><a href="#stima-bayesiana-con-stan" id="toc-stima-bayesiana-con-stan" class="nav-link" data-scroll-target="#stima-bayesiana-con-stan"><span class="header-section-number">46.3</span> Stima Bayesiana con Stan</a></li>
  <li><a href="#interpretazione-dei-risultati" id="toc-interpretazione-dei-risultati" class="nav-link" data-scroll-target="#interpretazione-dei-risultati"><span class="header-section-number">46.4</span> Interpretazione dei risultati</a></li>
  <li><a href="#dal-parametro-allo-stile-cognitivo" id="toc-dal-parametro-allo-stile-cognitivo" class="nav-link" data-scroll-target="#dal-parametro-allo-stile-cognitivo"><span class="header-section-number">46.5</span> Dal parametro allo stile cognitivo</a></li>
  <li><a href="#contextual-bandits-e-compiti-food-vs.-neutral" id="toc-contextual-bandits-e-compiti-food-vs.-neutral" class="nav-link" data-scroll-target="#contextual-bandits-e-compiti-food-vs.-neutral"><span class="header-section-number">46.6</span> Contextual Bandits e compiti <em>food</em> vs.&nbsp;<em>neutral</em></a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/formal_models/03_rescorla_wagner.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/formal_models/introduction_sec.html">Modelli</a></li><li class="breadcrumb-item"><a href="../../chapters/formal_models/03_rescorla_wagner.html"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-dynamic-models-rescorla-wagner" class="quarto-section-identifier"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>Questo capitolo introduce il <em>modello di Rescorla–Wagner (RW)</em> con <em>regola di scelta Softmax</em> <span class="citation" data-cites="rescorla1972theory">(<a href="#ref-rescorla1972theory" role="doc-biblioref">Rescorla &amp; Wagner, 1972</a>)</span>, come naturale estensione del modello di revisione degli obiettivi discusso nel capitolo precedente. Nel modello precedente l’aggiornamento era un <em>termine additivo</em> guidato da una discrepanza osservata; qui l’aggiornamento diventa esplicitamente <em>guidato dall’errore di predizione del rinforzo</em> (<em>reward prediction error</em>, RPE), ossia la differenza tra rinforzo ottenuto e rinforzo atteso. Questa formulazione è più <em>psicologicamente plausibile</em> e allineata all’evidenza in psicologia e neuroscienze: <em>si impara proporzionalmente a quanto l’esito sorprende le aspettative</em>.</p>
<p>Accanto al livello di <em>apprendimento</em> (aggiornamento dei valori associativi <span class="math inline">\(Q\)</span>), introduciamo il livello <em>decisionale</em>: le scelte non sono deterministiche, ma riflettono un compromesso fra <em>sfruttamento</em> dell’opzione migliore ed <em>esplorazione</em> di alternative. Con due opzioni, la Softmax si riduce a una <em>logistica della differenza</em> <span class="math inline">\(Q_B-Q_A\)</span>, modulata dal parametro di <em>inverse temperature</em> <span class="math inline">\(\tau\)</span>: valori alti di <span class="math inline">\(\tau\)</span> rendono le scelte più coerenti con <span class="math inline">\(Q\)</span>, valori bassi più esplorative.</p>
<p>Questa distinzione <em>apprendimento–decisione</em> è cruciale: consente di <em>separare</em> il meccanismo che aggiorna le aspettative (parametro <span class="math inline">\(lr\)</span>) dal meccanismo che le traduce in <em>probabilità di scelta</em> (parametro <span class="math inline">\(\tau\)</span>). Nei paragrafi successivi mostreremo come <em>simulare</em> dati (es. <em>probabilistic reversal learning</em>), <em>stimare</em> i parametri con <em>Stan</em> e <em>interpretare</em> i profili individuali e di gruppo.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
</section><section id="il-modello-di-rescorlawagner" class="level2" data-number="46.1"><h2 data-number="46.1" class="anchored" data-anchor-id="il-modello-di-rescorlawagner">
<span class="header-section-number">46.1</span> Il Modello di Rescorla–Wagner</h2>
<p>Il modello di <em>Rescorla–Wagner (RW)</em> è uno dei modelli più influenti nello studio dell’apprendimento associativo. Esso descrive come gli individui aggiornino le proprie aspettative in base all’esperienza, introducendo un meccanismo semplice ma potente che spiega fenomeni come acquisizione, estinzione e <em>blocking</em>.</p>
<p>L’idea di fondo è che l’apprendimento si realizzi attraverso l’aggiornamento della <em>forza associativa</em> <span class="math inline">\(Q_t(s)\)</span> di uno stimolo <span class="math inline">\(s\)</span> al tempo <span class="math inline">\(t\)</span>, in funzione della discrepanza tra ciò che ci si aspettava e ciò che si è effettivamente osservato.</p>
<section id="aggiornamento-delle-aspettative" class="level3" data-number="46.1.1"><h3 data-number="46.1.1" class="anchored" data-anchor-id="aggiornamento-delle-aspettative">
<span class="header-section-number">46.1.1</span> Aggiornamento delle aspettative</h3>
<p>Dopo ogni prova, la stima del valore viene modificata secondo la regola:</p>
<p><span class="math display">\[
Q_{t+1}(s) \;=\; Q_t(s) \;+\; \alpha \, \delta_t ,
\]</span> dove</p>
<p><span class="math display">\[
\delta_t \;=\; R_t - Q_t(s)
\]</span> è l’<em>errore di previsione</em> (<em>prediction error</em>), cioè la differenza tra la ricompensa ottenuta <span class="math inline">\(R_t\)</span> e l’aspettativa precedente <span class="math inline">\(Q_t(s)\)</span>.</p>
<ul>
<li>Se <span class="math inline">\(\delta_t &gt; 0\)</span>: la ricompensa è stata migliore del previsto → l’associazione si rafforza.</li>
<li>Se <span class="math inline">\(\delta_t &lt; 0\)</span>: la ricompensa è stata peggiore del previsto → l’associazione si indebolisce.</li>
<li>Se <span class="math inline">\(\delta_t = 0\)</span>: ciò che si è osservato coincide con l’attesa → nessun aggiornamento.</li>
</ul>
<p>Il parametro $ $ rappresenta il tasso di apprendimento (qui lo indichiamo con <code>lr</code>). Con <code>lr</code> alto l’aggiornamento è rapido; con <code>lr</code> basso è lento e più “conservativo”.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Variante (facoltativa): tassi distinti per PE positivo/negativo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Variante (facoltativa): tassi distinti per PE positivo/negativo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In alcune applicazioni si usano due tassi distinti <span class="math inline">\(\alpha^+\)</span> e <span class="math inline">\(\alpha^-\)</span> per apprendere diversamente da buone e cattive notizie. Questa distinzione consente di modellare la diversa sensibilità di individui o gruppi alle ricompense inattese rispetto alle punizioni o ai premi. Nel presente tutorial adottiamo <strong>un unico <code>lr</code></strong> per semplicità e coerenza con il codice Stan.</p>
</div>
</div>
</div>
</section><section id="dalla-valutazione-alla-decisione" class="level3" data-number="46.1.2"><h3 data-number="46.1.2" class="anchored" data-anchor-id="dalla-valutazione-alla-decisione">
<span class="header-section-number">46.1.2</span> Dalla valutazione alla decisione</h3>
<p>Avere valori <span class="math inline">\(Q_t(A)\)</span> e <span class="math inline">\(Q_t(B)\)</span> diversi non implica che la scelta sia sempre deterministica. Gli individui possono alternare tra <em>sfruttamento</em> (scegliere l’opzione con valore atteso maggiore) ed <em>esplorazione</em> (provare opzioni alternative).</p>
<p>Con due opzioni (A, B), la scelta è modellata come logistica della differenza di valore:</p>
<p><span class="math display">\[
P(\text{scegliere B}) = \text{inv\_logit}\!\big(\tau \,[Q_t(B)-Q_t(A)]\big).
\]</span> All’aumentare di <span class="math inline">\(\tau\)</span>, anche piccole differenze <span class="math inline">\(Q_t(B)-Q_t(A)\)</span> producono scelte quasi deterministiche; con <span class="math inline">\(\tau\)</span> bassa il comportamento è più esplorativo.</p>
<p>In sintesi, il modello di Rescorla–Wagner fornisce una descrizione formale e compatta di come gli individui apprendono in modo flessibile dalle proprie esperienze, adattando le aspettative e le decisioni in risposta ai cambiamenti dell’ambiente.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Approfondimento: esplorazione vs. sfruttamento (logit a 2 opzioni)">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Approfondimento: esplorazione vs.&nbsp;sfruttamento (logit a 2 opzioni)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Con due opzioni, la <em>Softmax</em> si riduce a una <em>logistica</em> sulla differenza di valore. Useremo quindi <span class="math inline">\(\Delta Q = Q_B - Q_A\)</span> e modelleremo la probabilità di scegliere <em>B</em> come</p>
<p><span class="math display">\[
P(B) = \text{inv\_logit}\big(\tau \,\Delta Q\big),
\]</span> dove <span class="math inline">\(\tau&gt;0\)</span> (<em>inverse temperature</em>) regola il compromesso esplorazione–sfruttamento:</p>
<ul>
<li>
<em><span class="math inline">\(\tau\)</span> basso</em> → comportamento <em>esplorativo</em>: anche differenze modeste non portano scelte deterministiche.</li>
<li>
<em><span class="math inline">\(\tau\)</span> alto</em> → comportamento di <em>sfruttamento</em>: piccole differenze in <span class="math inline">\(\Delta Q\)</span> bastano per preferenze quasi certe.</li>
</ul>
<p>Nel grafico seguente mostriamo la relazione tra <span class="math inline">\(\Delta Q\)</span> e <span class="math inline">\(P(B)\)</span> per due valori di <span class="math inline">\(\tau\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Differenze di valore (coerenti con Q in [0,1] → ΔQ in [-1, 1])</span></span>
<span><span class="va">dq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">201</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logit a 2 opzioni (equivalente alla Softmax con K=2)</span></span>
<span><span class="va">p_choose_B</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dq</span>, <span class="va">tau</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">tau</span> <span class="op">*</span> <span class="va">dq</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  dq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">dq</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  prob_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">p_choose_B</span><span class="op">(</span><span class="va">dq</span>, tau <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>             <span class="fu">p_choose_B</span><span class="op">(</span><span class="va">dq</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"τ = 0.5 (alta esplorazione)"</span>,</span>
<span>                     <span class="st">"τ = 5 (alto sfruttamento)"</span><span class="op">)</span>,</span>
<span>                   each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">dq</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dq</span>, y <span class="op">=</span> <span class="va">prob_B</span>, color <span class="op">=</span> <span class="va">tau</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">Delta</span><span class="op">*</span><span class="va">Q</span><span class="op">[</span><span class="va">B</span><span class="op">-</span><span class="va">A</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Probabilità di scegliere B"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_rescorla_wagner_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>Lettura del grafico</strong></p>
<ul>
<li>
<p>Se <span class="math inline">\(\Delta Q = 0.5\)</span>:</p>
<ul>
<li>con <span class="math inline">\(\tau = 0.5\)</span>, <span class="math inline">\(P(B) \approx \text{inv\_logit}(0.25) \approx 0.56\)</span> → decisione ancora esplorativa;</li>
<li>con <span class="math inline">\(\tau = 5\)</span>, <span class="math inline">\(P(B) \approx \text{inv\_logit}(2.5) \approx 0.92\)</span> → prevale lo sfruttamento.</li>
</ul>
</li>
<li>
<p>Se <span class="math inline">\(\Delta Q = 1\)</span>:</p>
<ul>
<li>con <span class="math inline">\(\tau = 0.5\)</span>, <span class="math inline">\(P(B) \approx \text{inv\_logit}(0.5) \approx 0.62\)</span>;</li>
<li>con <span class="math inline">\(\tau = 5\)</span>, <span class="math inline">\(P(B) \approx \text{inv\_logit}(5) \approx 0.993\)</span>, scelta quasi deterministica.</li>
</ul>
</li>
</ul>
<p>Questo esempio mostra come <span class="math inline">\(\tau\)</span> controlli la transizione tra esplorazione e sfruttamento nel <em>caso binario</em> (logit), coerente con il modello Stan usato nel tutorial.</p>
</div>
</div>
</div>
</section><section id="identificabilità-e-scaling" class="level3" data-number="46.1.3"><h3 data-number="46.1.3" class="anchored" data-anchor-id="identificabilità-e-scaling">
<span class="header-section-number">46.1.3</span> Identificabilità e scaling</h3>
<p>Nella funzione Softmax conta solo la <em>differenza</em> tra i valori <span class="math inline">\(Q\)</span>. Se aggiungiamo la stessa costante <span class="math inline">\(c\)</span> a entrambi (cioè <span class="math inline">\(Q_t(s) + c\)</span>), le probabilità di scelta non cambiano.</p>
<p>Per questo motivo:</p>
<ul>
<li>si inizializzano di solito i valori in modo simmetrico (ad esempio <span class="math inline">\(Q_0(A) = Q_0(B) = 0.5\)</span>);<br>
</li>
<li>si mantengono i rinforzi nel range <span class="math inline">\(\{0,1\}\)</span>;<br>
</li>
<li>oppure si fissa un valore iniziale di riferimento, o si pongono vincoli su <span class="math inline">\(\beta\)</span>.</li>
</ul>
<p>Queste scelte servono solo a rendere il modello <em>ben definito</em>, senza influenzare il comportamento osservato.</p>
<p>Nel presente tutorial il rinforzo è codificato come <span class="math inline">\(R_t \in \{0,1\}\)</span>. In questo caso i valori <span class="math inline">\(Q\)</span> convergono a stime di probabilità di ricompensa e risultano naturalmente in <span class="math inline">\([0,1]\)</span>. Con codifiche <span class="math inline">\(\{-1,+1\}\)</span>, i <span class="math inline">\(Q\)</span> convergono a valori attesi in <span class="math inline">\([-1,+1]\)</span> e occorre tenerne conto nell’interpretazione.</p>
</section></section><section id="simulazione" class="level2" data-number="46.2"><h2 data-number="46.2" class="anchored" data-anchor-id="simulazione">
<span class="header-section-number">46.2</span> Simulazione</h2>
<p>Simuliamo i dati in un compito di <em>Probabilistic Reversal Learning</em> (PRL). In questo compito il partecipante deve scegliere ripetutamente tra due stimoli:</p>
<ul>
<li>uno <em>ricco</em>, con probabilità di ricompensa <span class="math inline">\(p=0.7\)</span>;</li>
<li>uno <em>povero</em>, con probabilità <span class="math inline">\(1-p=0.3\)</span>.</li>
</ul>
<p>A metà esperimento le probabilità vengono invertite (<em>reversal</em>): lo stimolo che prima era ricco diventa povero e viceversa. Il partecipante deve quindi adattarsi al cambiamento per massimizzare le ricompense.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulatore PRL (RW + logit) allineato al modello Stan (choice in 0/1)</span></span>
<span><span class="va">simulate_prl_rw_binary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">n_trials</span>        <span class="op">=</span> <span class="fl">160</span>,</span>
<span>  <span class="va">p_reward_rich</span>   <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  <span class="va">reversal_trial</span>  <span class="op">=</span> <span class="fl">80</span>,            <span class="co"># se NULL, nessun reversal</span></span>
<span>  <span class="va">lr</span>              <span class="op">=</span> <span class="fl">0.15</span>,          <span class="co"># learning rate unico</span></span>
<span>  <span class="va">tau</span>             <span class="op">=</span> <span class="fl">2</span>,             <span class="co"># inverse temperature (decision noise)</span></span>
<span>  <span class="va">Q0</span>              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">0.0</span>, B <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>,</span>
<span>  <span class="va">seed</span>            <span class="op">=</span> <span class="fl">1234</span></span>
<span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Q0</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Q0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>  <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">Q0</span></span>
<span></span>
<span>  <span class="va">choice</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="va">n_trials</span><span class="op">)</span>   <span class="co"># 0 = A, 1 = B</span></span>
<span>  <span class="va">reward</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="va">n_trials</span><span class="op">)</span>   <span class="co"># 0/1</span></span>
<span>  <span class="va">rich_is_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep.int</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="va">n_trials</span><span class="op">)</span> <span class="co"># 1 = A ricco, 0 = B ricco (inizio A ricco)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">reversal_trial</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rich_is_A</span><span class="op">[</span><span class="op">(</span><span class="va">reversal_trial</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n_trials</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0L</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">Q_A</span> <span class="op">&lt;-</span> <span class="va">Q_B</span> <span class="op">&lt;-</span> <span class="va">pB_seq</span> <span class="op">&lt;-</span> <span class="va">pe_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">n_trials</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n_trials</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># probabilità di scegliere B (softmax logit a due opzioni)</span></span>
<span>    <span class="va">pB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html">plogis</a></span><span class="op">(</span><span class="va">tau</span> <span class="op">*</span> <span class="op">(</span><span class="va">Q</span><span class="op">[</span><span class="st">"B"</span><span class="op">]</span> <span class="op">-</span> <span class="va">Q</span><span class="op">[</span><span class="st">"A"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">choice</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">pB</span><span class="op">)</span>   <span class="co"># 1=B, 0=A</span></span>
<span></span>
<span>    <span class="va">a_idx</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">choice</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1L</span><span class="op">)</span> <span class="fl">2L</span> <span class="kw">else</span> <span class="fl">1L</span></span>
<span></span>
<span>    <span class="co"># probabilità di ricompensa per l’opzione scelta</span></span>
<span>    <span class="va">chosen_is_rich</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">choice</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0L</span> <span class="op">&amp;&amp;</span> <span class="va">rich_is_A</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">||</span>  </span>
<span>                      <span class="op">(</span><span class="va">choice</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">&amp;&amp;</span> <span class="va">rich_is_A</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0L</span><span class="op">)</span></span>
<span>    <span class="va">pr</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">chosen_is_rich</span><span class="op">)</span> <span class="va">p_reward_rich</span> <span class="kw">else</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_reward_rich</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">reward</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">pr</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># prediction error e aggiornamento RW</span></span>
<span>    <span class="va">pe</span> <span class="op">&lt;-</span> <span class="va">reward</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">-</span> <span class="va">Q</span><span class="op">[</span><span class="va">a_idx</span><span class="op">]</span></span>
<span>    <span class="va">Q</span><span class="op">[</span><span class="va">a_idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span><span class="va">a_idx</span><span class="op">]</span> <span class="op">+</span> <span class="va">lr</span> <span class="op">*</span> <span class="va">pe</span></span>
<span></span>
<span>    <span class="va">Q_A</span><span class="op">[</span><span class="va">t</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span><span class="st">"A"</span><span class="op">]</span></span>
<span>    <span class="va">Q_B</span><span class="op">[</span><span class="va">t</span><span class="op">]</span>   <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span><span class="st">"B"</span><span class="op">]</span></span>
<span>    <span class="va">pB_seq</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pB</span></span>
<span>    <span class="va">pe_seq</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pe</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    trial     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n_trials</span><span class="op">)</span>,</span>
<span>    choice    <span class="op">=</span> <span class="va">choice</span>,    <span class="co"># 0=A, 1=B</span></span>
<span>    reward    <span class="op">=</span> <span class="va">reward</span>,    <span class="co"># 0/1</span></span>
<span>    rich_is_A <span class="op">=</span> <span class="va">rich_is_A</span>, <span class="co"># 0/1</span></span>
<span>    Q_A <span class="op">=</span> <span class="va">Q_A</span>, Q_B <span class="op">=</span> <span class="va">Q_B</span>, pB <span class="op">=</span> <span class="va">pB_seq</span>, pe <span class="op">=</span> <span class="va">pe_seq</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu">simulate_prl_rw_binary</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Nota.</em> La probabilità simulata coincide con quella dello Stan: <span class="math inline">\(P(B)=\text{inv\_logit}\!\big(\tau [Q(B)-Q(A)]\big)\)</span>. Anche l’aggiornamento usa <strong>lo stesso</strong> <code>lr</code>.</p>
<p>Visualizziamo l’evoluzione dei valori associativi <span class="math inline">\(Q\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_rescorla_wagner_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<section id="interpretazione-del-grafico" class="level3" data-number="46.2.1"><h3 data-number="46.2.1" class="anchored" data-anchor-id="interpretazione-del-grafico">
<span class="header-section-number">46.2.1</span> Interpretazione del grafico</h3>
<p>Nella <em>prima fase</em> (trial 1–80), lo stimolo ricco (linea blu) riceve più ricompense e quindi accumula un valore <span class="math inline">\(Q\)</span> più alto rispetto allo stimolo povero (linea verde).</p>
<p>Al momento del <em>reversal</em> (linea verticale tratteggiata), le probabilità si invertono. Lo stimolo blu smette di essere vantaggioso e il suo valore <span class="math inline">\(Q\)</span> scende, mentre lo stimolo verde cresce.</p>
<p>Questo andamento riflette il principio base del modello di <em>Rescorla–Wagner</em>:</p>
<ul>
<li>i valori associativi <span class="math inline">\(Q\)</span> non sono fissi,</li>
<li>vengono aggiornati <em>trial per trial</em> con una regola di apprendimento molto semplice:</li>
</ul>
<p><span class="math display">\[
Q_{\text{nuovo}} = Q_{\text{vecchio}} + lr \times (reward - Q_{\text{vecchio}}).
\]</span> Il termine <span class="math inline">\(reward - Q_{\text{vecchio}}\)</span> è il <em>prediction error</em> (PE): la differenza tra ciò che si è osservato e ciò che ci si aspettava.</p>
<ul>
<li><p>Se il feedback è migliore del previsto (PE&gt;0), il valore <span class="math inline">\(Q\)</span> aumenta.</p></li>
<li><p>Se è peggiore del previsto (PE&lt;0), il valore diminuisce.</p></li>
<li><p>Il <em>learning rate</em> <code>lr</code> regola di quanto il valore cambia a ogni prova.</p></li>
<li>
<p>Il parametro <code>tau</code> controlla invece quanto le scelte sono “guidate” dai valori Q:</p>
<ul>
<li>se <code>tau</code> è grande → scelte più deterministiche (si sceglie quasi sempre lo stimolo con Q maggiore);</li>
<li>se <code>tau</code> è piccolo → scelte più esplorative o rumorose.</li>
</ul>
</li>
</ul></section></section><section id="stima-bayesiana-con-stan" class="level2" data-number="46.3"><h2 data-number="46.3" class="anchored" data-anchor-id="stima-bayesiana-con-stan">
<span class="header-section-number">46.3</span> Stima Bayesiana con Stan</h2>
<p>Nella simulazione conoscevamo i parametri generativi (<code>lr=0.15</code>, <code>tau=2</code>). Nella realtà, però, abbiamo <em>solo i dati osservati</em>:</p>
<ul>
<li>per ogni trial sappiamo quale scelta è stata fatta (<code>choice=0</code> per A, <code>choice=1</code> per B),</li>
<li>e se il feedback è stato positivo o negativo (<code>reward=1</code> oppure <code>0</code>).</li>
</ul>
<p>I valori interni <span class="math inline">\(Q\)</span> e i parametri del modello non sono osservabili: dobbiamo <em>inferirli</em>.</p>
<p>L’ipotesi è che i dati derivino da un processo di tipo <em>Rescorla–Wagner con regola di scelta logistica</em>. L’obiettivo è quindi stimare, a partire dai soli dati:</p>
<ul>
<li>il <em>learning rate</em> <code>lr</code>, che regola la velocità di aggiornamento dei valori;</li>
<li>l’<em>inverse temperature</em> <code>tau</code>, che controlla quanto le scelte sono coerenti con i valori Q.</li>
</ul>
<section id="codice-stan" class="level3" data-number="46.3.1"><h3 data-number="46.3.1" class="anchored" data-anchor-id="codice-stan">
<span class="header-section-number">46.3.1</span> Codice Stan</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stancode_rw</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">data {</span></span>
<span><span class="st">  int&lt;lower=1&gt; nTrials;                   // numero di prove</span></span>
<span><span class="st">  array[nTrials] int&lt;lower=0,upper=1&gt; choice; // scelte osservate (0=A, 1=B)</span></span>
<span><span class="st">  array[nTrials] real&lt;lower=0,upper=1&gt; reward; // ricompense osservate (0/1)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">transformed data {</span></span>
<span><span class="st">  vector[2] initV = rep_vector(0.0, 2);   // valori Q iniziali</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">parameters {</span></span>
<span><span class="st">  real&lt;lower=0,upper=1&gt; lr;   // learning rate</span></span>
<span><span class="st">  real&lt;lower=0,upper=3&gt; tau;  // inverse temperature (softmax / decision noise)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">model {</span></span>
<span><span class="st">  vector[2] v = initV;        // valori Q correnti</span></span>
<span><span class="st">  real pe;                    // prediction error</span></span>
<span><span class="st">  real p;                     // probabilità di scelta =1 (stimolo B)</span></span>
<span><span class="st"></span></span>
<span><span class="st">  // Priors deboli ma informative</span></span>
<span><span class="st">  lr ~ beta(2, 10);           // learning rate vicino a valori piccoli</span></span>
<span><span class="st">  tau ~ lognormal(log(2), 0.5); // inverse temperature positiva</span></span>
<span><span class="st"></span></span>
<span><span class="st">  for (t in 1:nTrials) {</span></span>
<span><span class="st">    // Probabilità di scegliere B: logit della differenza Q_B - Q_A</span></span>
<span><span class="st">    p = inv_logit(tau * (v[2] - v[1]));</span></span>
<span><span class="st">    choice[t] ~ bernoulli(p);</span></span>
<span><span class="st"></span></span>
<span><span class="st">    // Prediction error e aggiornamento</span></span>
<span><span class="st">    int a = choice[t] + 1;     // 0→1 (A), 1→2 (B)</span></span>
<span><span class="st">    pe = reward[t] - v[a];</span></span>
<span><span class="st">    v[a] += lr * pe;</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">"</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I prior scelti sono debolmente informativi ma coerenti con compiti PRL tipici (apprendimento moderato e scelte non eccessivamente rumorose). Possono essere resi più o meno conservativi in base al compito.</p>
</section><section id="commento-al-codice-stan" class="level3" data-number="46.3.2"><h3 data-number="46.3.2" class="anchored" data-anchor-id="commento-al-codice-stan">
<span class="header-section-number">46.3.2</span> Commento al codice Stan</h3>
<ol type="1">
<li><p><strong>Inizializzazione.</strong> All’inizio i due valori <span class="math inline">\(Q[1]\)</span> e <span class="math inline">\(Q[2]\)</span> (per A e B) sono fissati a 0. Rappresentano l’aspettativa iniziale: “nessuna preferenza”.</p></li>
<li>
<p><strong>Probabilità della scelta.</strong> Al trial <span class="math inline">\(t\)</span>, confrontiamo i due valori:</p>
<p><span class="math display">\[
p(B) = \text{inv\_logit}\big(\tau \cdot (Q_B - Q_A)\big).
\]</span></p>
<p>Questo significa che se <span class="math inline">\(Q_B &gt; Q_A\)</span>, aumenta la probabilità di scegliere B. Il parametro <code>tau</code> regola la “determinazione”:</p>
<ul>
<li>se <code>tau</code> è grande, basta una piccola differenza tra i due Q per portare a scelte quasi certe;</li>
<li>se <code>tau</code> è piccolo, anche differenze grandi lasciano spazio all’esplorazione.</li>
</ul>
</li>
<li><p><strong>Valutazione della scelta osservata.</strong> La riga <code>choice[t] ~ bernoulli(p)</code> confronta la scelta osservata con la probabilità prevista. Questa è la <em>verosimiglianza</em>: se la scelta osservata è coerente con i Q correnti, il modello “ottiene credito”; se è incoerente, viene “penalizzato”.</p></li>
<li>
<p><strong>Osservazione dell’esito e prediction error.</strong> Dopo aver osservato il feedback, calcoliamo:</p>
<p><span class="math display">\[
PE = reward[t] - Q[\text{scelta}],
\]</span></p>
<p>ossia la differenza tra il risultato ricevuto e quello atteso.</p>
</li>
<li>
<p><strong>Aggiornamento dei valori.</strong> Solo il Q corrispondente all’opzione scelta viene aggiornato:</p>
<p><span class="math display">\[
Q_{\text{nuovo}} = Q_{\text{vecchio}} + lr \cdot PE.
\]</span></p>
<ul>
<li>Se il feedback è migliore del previsto (PE&gt;0), il valore cresce.</li>
<li>Se è peggiore del previsto (PE&lt;0), il valore diminuisce.</li>
<li>Il learning rate <code>lr</code> determina di quanto cambia il valore a ogni trial.</li>
</ul>
</li>
</ol></section><section id="esempio-intuitivo" class="level3" data-number="46.3.3"><h3 data-number="46.3.3" class="anchored" data-anchor-id="esempio-intuitivo">
<span class="header-section-number">46.3.3</span> Esempio intuitivo</h3>
<p>Immagina di avere <span class="math inline">\(Q_A = 0.6\)</span>, <span class="math inline">\(Q_B = 0.3\)</span> e <code>tau=2</code>. La differenza <span class="math inline">\(Q_B - Q_A = -0.3\)</span>. Il logit vale <span class="math inline">\(-0.6\)</span>, e quindi:</p>
<p><span class="math display">\[
p(B) = \text{inv\_logit}(-0.6) \approx 0.35.
\]</span> Quindi, il modello si aspetta che A venga scelto nel 65% dei casi.</p>
<p>Se il soggetto sceglie effettivamente A, la verosimiglianza è alta. Se sceglie B, è possibile ma meno probabile: il modello aggiorna i valori interni in base al feedback ricevuto.</p>
<p>In questo tutorial useremo i dati simulati in precedenza:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  nTrials <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span>,</span>
<span>  choice  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">choice</span><span class="op">)</span>,</span>
<span>  reward  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">sim</span><span class="op">$</span><span class="va">reward</span><span class="op">)</span>   <span class="co"># 0/1 come real per coerenza con &lt;lower=0,upper=1&gt;</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">stan_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ nTrials: int 160</span></span>
<span><span class="co">#&gt;  $ choice : int [1:160] 0 1 1 0 1 1 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ reward : num [1:160] 1 0 0 1 0 0 0 0 1 1 ...</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compiliamo il modello e eseguiamo il campionamento:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod_rw</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html">cmdstan_model</a></span><span class="op">(</span><span class="fu">write_stan_file</span><span class="op">(</span><span class="va">stancode_rw</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit_rw</span> <span class="op">&lt;-</span> <span class="va">mod_rw</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_data</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  iter_sampling <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">200</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Eseguiamo le diagnostiche di campionamento:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_rw</span><span class="op">$</span><span class="fu">cmdstan_diagnose</span><span class="op">(</span><span class="op">)</span>  <span class="co"># controlli rapidi cmdstan</span></span>
<span><span class="co">#&gt; Checking sampler transitions treedepth.</span></span>
<span><span class="co">#&gt; Treedepth satisfactory for all transitions.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking sampler transitions for divergences.</span></span>
<span><span class="co">#&gt; No divergent transitions found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking E-BFMI - sampler transitions HMC potential energy.</span></span>
<span><span class="co">#&gt; E-BFMI satisfactory.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank-normalized split effective sample size satisfactory for all parameters.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rank-normalized split R-hat values satisfactory for all parameters.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Processing complete, no problems detected.</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esaminiamo la distribuzione a posteriori dei parametri:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit_rw</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lr"</span>,<span class="st">"tau"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 10</span></span>
<span><span class="co">#&gt;   variable  mean median    sd   mad    q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 lr       0.155  0.149 0.045 0.043 0.091 0.236 1.001 7735.557 7858.989</span></span>
<span><span class="co">#&gt; 2 tau      2.407  2.435 0.350 0.382 1.790 2.927 1.000 6866.231 4320.660</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="interpretazione-dei-risultati" class="level2" data-number="46.4"><h2 data-number="46.4" class="anchored" data-anchor-id="interpretazione-dei-risultati">
<span class="header-section-number">46.4</span> Interpretazione dei risultati</h2>
<p>Le distribuzioni a posteriori stimano quanto bene il modello è riuscito a recuperare i parametri generativi usati nella simulazione (<code>lr = 0.15</code>, <code>tau = 2</code>).</p>
<ul>
<li>
<p><code>lr</code> (learning rate) regola la rapidità con cui il soggetto aggiorna le proprie aspettative dopo ogni feedback.</p>
<ul>
<li>Valori alti → aggiornamenti rapidi: anche un singolo feedback può cambiare molto la stima del valore associato a uno stimolo.</li>
<li>Valori bassi → aggiornamenti lenti: il soggetto “conserva” più a lungo le esperienze passate, adattandosi solo gradualmente ai cambiamenti.</li>
</ul>
</li>
<li>
<p><code>tau</code> (inverse temperature) controlla la coerenza delle scelte rispetto ai valori <span class="math inline">\(Q\)</span>.</p>
<ul>
<li>Con <code>tau</code> alto → le scelte sono quasi deterministiche: basta una piccola differenza tra <span class="math inline">\(Q_A\)</span> e <span class="math inline">\(Q_B\)</span> per indurre una preferenza netta.</li>
<li>Con <code>tau</code> basso → il comportamento appare più esplorativo o rumoroso: anche se uno stimolo ha un valore più alto, non sempre viene scelto.</li>
</ul>
</li>
</ul>
<p>Nei grafici delle distribuzioni posteriori:</p>
<ul>
<li>le <em>linee tratteggiate</em> rappresentano i valori “veri” usati per simulare i dati,</li>
<li>le <em>distribuzioni stimate</em> mostrano l’incertezza del modello sulle possibili soluzioni.</li>
</ul>
<p>Quando la distribuzione è ben centrata sulla linea tratteggiata e piuttosto stretta, significa che il modello ha recuperato bene il parametro. Distribuzioni più larghe o spostate indicano maggiore incertezza o possibili <em>trade-off</em> tra parametri (ad esempio: un <code>lr</code> leggermente diverso può essere compensato da un <code>tau</code> più basso o più alto producendo previsioni simili).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">draws_df</span> <span class="op">&lt;-</span> <span class="va">fit_rw</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lr"</span>,<span class="st">"tau"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">as_draws_df</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>lr <span class="op">=</span> <span class="st">"#5d5349"</span>, tau <span class="op">=</span> <span class="st">"#4682B4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_post</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">draws</span>, <span class="va">param</span>, <span class="va">col</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">draws</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">param</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, bins <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                   fill <span class="op">=</span> <span class="va">col</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>color <span class="op">=</span> <span class="va">col</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="va">param</span>, y <span class="op">=</span> <span class="st">"Densità"</span>, title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Posterior di"</span>, <span class="va">param</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p_lr</span>  <span class="op">&lt;-</span> <span class="fu">plot_post</span><span class="op">(</span><span class="va">draws_df</span>, <span class="st">"lr"</span>,  <span class="va">cols</span><span class="op">[</span><span class="st">"lr"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p_tau</span> <span class="op">&lt;-</span> <span class="fu">plot_post</span><span class="op">(</span><span class="va">draws_df</span>, <span class="st">"tau"</span>, <span class="va">cols</span><span class="op">[</span><span class="st">"tau"</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">true_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>lr <span class="op">=</span> <span class="fl">0.15</span>, tau <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p_lr</span>  <span class="op">+</span> <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">true_vals</span><span class="op">[</span><span class="st">"lr"</span><span class="op">]</span>,  linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_rescorla_wagner_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p_tau</span> <span class="op">+</span> <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">true_vals</span><span class="op">[</span><span class="st">"tau"</span><span class="op">]</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_rescorla_wagner_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Attenzione ai possibili <em>trade-off</em>: in dataset brevi o con scarsa esplorazione, combinazioni diverse di <code>lr</code> e <code>tau</code> possono produrre predizioni simili (identificabilità parziale). Conviene sempre ispezionare tracce, R-hat, ESS e, se possibile, condurre <em>posterior predictive checks</em>.</p>
</section><section id="dal-parametro-allo-stile-cognitivo" class="level2" data-number="46.5"><h2 data-number="46.5" class="anchored" data-anchor-id="dal-parametro-allo-stile-cognitivo">
<span class="header-section-number">46.5</span> Dal parametro allo stile cognitivo</h2>
<p>I parametri del modello non sono soltanto numeri: possono essere interpretati come <em>indicatori di stili di apprendimento e decisione</em>.</p>
<ul>
<li>
<p><strong>Learning rate (<code>lr</code>)</strong></p>
<ul>
<li>Un soggetto con <code>lr</code> alto è molto sensibile ai singoli feedback: aggiorna le proprie aspettative in modo rapido e può adattarsi velocemente a un <em>reversal</em>. <em>Esempio</em>: basta un paio di esiti negativi perché abbandoni l’opzione che prima sembrava migliore.</li>
<li>Un soggetto con <code>lr</code> basso aggiorna più lentamente: dà più peso all’esperienza accumulata e tende a mantenere le proprie scelte anche di fronte a segnali contrari. <em>Esempio</em>: continua a scegliere lo stimolo “vecchio ricco” anche dopo alcuni esiti negativi, adattandosi solo gradualmente.</li>
</ul>
</li>
<li>
<p><strong>Inverse temperature (<code>tau</code>)</strong></p>
<ul>
<li>Un soggetto con <code>tau</code> alto si comporta in modo <em>deterministico</em>: sceglie quasi sempre l’opzione con il valore Q più alto. Questo corrisponde a uno stile “sfruttatore” (<em>exploiter</em>), focalizzato sul massimizzare subito i guadagni.</li>
<li>Un soggetto con <code>tau</code> basso mostra un comportamento più <em>esplorativo o rumoroso</em>: anche se una delle due opzioni è chiaramente più vantaggiosa, di tanto in tanto sceglie l’altra. Questo stile può sembrare “incoerente”, ma in certi contesti favorisce l’esplorazione di alternative.</li>
</ul>
</li>
</ul>
<section id="messaggio-chiave" class="level3" data-number="46.5.1"><h3 data-number="46.5.1" class="anchored" data-anchor-id="messaggio-chiave">
<span class="header-section-number">46.5.1</span> Messaggio chiave</h3>
<p>L’approccio bayesiano permette di stimare, per ogni individuo, un profilo fatto di <em>apprendimento</em> (quanto velocemente aggiorna le proprie aspettative) e <em>decisione</em> (quanto coerentemente agisce in base a quelle aspettative).</p>
<p>Differenze sistematiche nei parametri tra <em>gruppi sperimentali</em> (es. stimoli emozionanti vs.&nbsp;neutri) o tra <em>popolazioni cliniche e di controllo</em> possono rivelare <em>stili cognitivi distintivi</em>:</p>
<ul>
<li>difficoltà nell’adattarsi a nuovi feedback (lr basso),</li>
<li>oppure scelte troppo rigide o troppo esplorative (tau troppo alto o troppo basso).</li>
</ul>
<p>In questo modo, un modello computazionale semplice come il Rescorla–Wagner con regola logistica non solo descrive i dati, ma fornisce anche una <em>chiave di lettura psicologica</em> dei processi sottostanti.</p>
</section></section><section id="contextual-bandits-e-compiti-food-vs.-neutral" class="level2" data-number="46.6"><h2 data-number="46.6" class="anchored" data-anchor-id="contextual-bandits-e-compiti-food-vs.-neutral">
<span class="header-section-number">46.6</span> Contextual Bandits e compiti <em>food</em> vs.&nbsp;<em>neutral</em>
</h2>
<p>Il modello di Rescorla–Wagner con regola logistica, come visto nel tutorial, assume due parametri stabili per tutto il compito:</p>
<ul>
<li>
<code>lr</code>, che regola la velocità con cui i valori <span class="math inline">\(Q\)</span> vengono aggiornati,</li>
<li>
<code>tau</code>, che governa la coerenza delle scelte rispetto a tali valori.</li>
</ul>
<p>La famiglia dei <em>banditi contestuali</em> rappresenta un’estensione naturale: i parametri non sono più fissi, ma possono <em>variare in funzione del contesto</em>. In pratica, lo stesso schema RW + logit viene applicato separatamente a diverse condizioni sperimentali (es. stimoli <em>food</em> vs.&nbsp;stimoli <em>neutral</em>, per un campione di pazienti anoressiche) o a diversi gruppi di partecipanti (es. clinici vs.&nbsp;controlli).</p>
<p>Questa estensione è stata applicata con successo nello studio dei disturbi alimentari. Analisi recenti hanno mostrato che i <em>deficit di apprendimento</em> in anoressia nervosa non sono globali, ma <em>specifici del contesto alimentare</em>:</p>
<ul>
<li>di fronte a stimoli legati al cibo, le persone con anoressia tendono a mostrare un <em>learning rate più basso</em>, cioè aggiornano le aspettative più lentamente;</li>
<li>negli stessi compiti con stimoli neutri, invece, i parametri risultano simili a quelli dei controlli <span class="citation" data-cites="colpizzi2025food">(<a href="#ref-colpizzi2025food" role="doc-biblioref">Colpizzi et al., 2025</a>)</span>.</li>
</ul>
<p>Questa evidenza suggerisce che la vulnerabilità non consista in un deficit generale dei processi di apprendimento, ma in un’alterazione <em>selettiva e contestuale</em>, che contribuisce al mantenimento del disturbo.</p>
<p>Formalmente, per il contesto <span class="math inline">\(c \in \{\text{food},\text{neutral}\}\)</span> si stima: <span class="math display">\[
P_c(B_t)=\text{inv\_logit}\!\big(\tau_c [Q_{c,t}(B)-Q_{c,t}(A)]\big),
\]</span> <span class="math display">\[
Q_{c,t+1}(s)=Q_{c,t}(s)+lr_c \,[R_{c,t}-Q_{c,t}(s)].
\]</span> Il confronto tra <span class="math inline">\(lr_{\text{food}}\)</span> e <span class="math inline">\(lr_{\text{neutral}}\)</span> (e analogamente per <span class="math inline">\(\tau\)</span>) quantifica le differenze contestuali.</p>
<section id="limiti-e-varianti-minime" class="level3" data-number="46.6.1"><h3 data-number="46.6.1" class="anchored" data-anchor-id="limiti-e-varianti-minime">
<span class="header-section-number">46.6.1</span> Limiti e varianti minime</h3>
<p>Il modello di <em>Rescorla–Wagner</em> estende la semplice dinamica di aggiornamento introducendo un <em>livello decisionale</em>, che trasforma i valori appresi (<em>Q-values</em>) in probabilità di scelta. Questo ci permette di distinguere due componenti fondamentali del comportamento:</p>
<ol type="1">
<li>
<p><strong>Apprendimento dagli esiti</strong> (<em>learning</em>), controllato dal parametro <code>lr</code> (<em>learning rate</em>), che determina quanto rapidamente il soggetto aggiorna le proprie aspettative in base all’errore di predizione (la differenza tra quanto atteso e quanto effettivamente ottenuto).</p>
<ul>
<li>Un valore basso di <code>lr</code> corrisponde a un apprendimento più lento e stabile, ma meno reattivo ai cambiamenti.</li>
<li>Un valore alto di <code>lr</code> corrisponde a un adattamento veloce, ma a una maggiore sensibilità al rumore.</li>
</ul>
</li>
<li>
<p><strong>Politica decisionale</strong> (<em>decision policy</em>), governata dal parametro <code>tau</code> (<em>inverse temperature</em>), che regola la coerenza tra le scelte e i valori appresi.</p>
<ul>
<li>
<code>tau</code> alto: scelte deterministiche e coerenti con l’opzione migliore (alto sfruttamento).</li>
<li>
<code>tau</code> basso: comportamento più esplorativo e meno prevedibile.</li>
</ul>
</li>
</ol>
<p>Questa distinzione è cruciale in ambito clinico. In uno studio sull’anoressia nervosa e l’apprendimento, ad esempio, abbiamo osservato che le difficoltà non sono generalizzate, ma <em>specifiche del contesto alimentare</em>: le pazienti presentano un tasso di apprendimento ridotto (<code>lr</code> più basso) quando gli stimoli sono legati al cibo, mentre il loro comportamento è simile a quello dei controlli in contesti neutri <span class="citation" data-cites="colpizzi2025food">(<a href="#ref-colpizzi2025food" role="doc-biblioref">Colpizzi et al., 2025</a>)</span>.</p>
<p>Il modello RW offre quindi un’analisi più ricca della semplice prestazione media:</p>
<ul>
<li>consente di identificare differenze nei <em>meccanismi di apprendimento</em> (<code>lr</code>) tra diverse condizioni;</li>
<li>permette di verificare se a queste diffeerenze si associano anche differenze nello <em>stile decisionale</em> (<code>tau</code>).</li>
</ul>
<p>Per uno psicologo, questo si traduce in due vantaggi concreti:</p>
<ul>
<li>
<strong>Chiarezza teorica:</strong> permette di formulare ipotesi precise e separate sui processi di apprendimento e sulle strategie decisionali, andando oltre le semplici misure di accuratezza.</li>
<li>
<strong>Rilevanza clinica:</strong> distinguere un deficit nell’apprendimento da uno nella scelta ha implicazioni dirette per la progettazione di interventi mirati (es., potenziare la sensibilità al feedback o riequilibrare l’esplorazione e lo sfruttamento).</li>
</ul>
<p>In sintesi, il modello Rescorla-Wagner non è solo uno strumento computazionale: è un <em>ponte fra comportamento osservato e processi mentali</em>, fondamentale per isolare deficit contestuali specifici e comprendere come le strategie decisionali varino tra individui e gruppi clinici.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] cmdstanr_0.9.0        pillar_1.11.0         tinytable_0.13.0     </span></span>
<span><span class="co">#&gt;  [4] patchwork_1.3.2       ggdist_3.3.3          tidybayes_3.0.7      </span></span>
<span><span class="co">#&gt;  [7] bayesplot_1.14.0      ggplot2_3.5.2         reliabilitydiag_0.2.1</span></span>
<span><span class="co">#&gt; [10] priorsense_1.1.1      posterior_1.6.1       loo_2.8.0            </span></span>
<span><span class="co">#&gt; [13] rstan_2.32.7          StanHeaders_2.32.10   brms_2.22.0          </span></span>
<span><span class="co">#&gt; [16] Rcpp_1.1.0            sessioninfo_1.2.3     conflicted_1.2.0     </span></span>
<span><span class="co">#&gt; [19] janitor_2.2.1         matrixStats_1.5.0     modelr_0.1.11        </span></span>
<span><span class="co">#&gt; [22] tibble_3.3.0          dplyr_1.1.4           tidyr_1.3.1          </span></span>
<span><span class="co">#&gt; [25] rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        systemfonts_1.2.3    </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5           stringr_1.5.1         pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt; [13] arrayhelpers_1.1-0    fastmap_1.2.0         backports_1.5.0      </span></span>
<span><span class="co">#&gt; [16] labeling_0.4.3        utf8_1.2.6            rmarkdown_2.29       </span></span>
<span><span class="co">#&gt; [19] ps_1.9.1              ragg_1.5.0            purrr_1.1.0          </span></span>
<span><span class="co">#&gt; [22] xfun_0.53             cachem_1.1.0          jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [25] broom_1.0.9           parallel_4.5.1        R6_2.6.1             </span></span>
<span><span class="co">#&gt; [28] stringi_1.8.7         RColorBrewer_1.1-3    lubridate_1.9.4      </span></span>
<span><span class="co">#&gt; [31] estimability_1.5.1    knitr_1.50            zoo_1.8-14           </span></span>
<span><span class="co">#&gt; [34] Matrix_1.7-4          splines_4.5.1         timechange_0.3.0     </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1      abind_1.4-8           yaml_2.3.10          </span></span>
<span><span class="co">#&gt; [40] codetools_0.2-20      curl_7.0.0            processx_3.8.6       </span></span>
<span><span class="co">#&gt; [43] pkgbuild_1.4.8        lattice_0.22-7        withr_3.0.2          </span></span>
<span><span class="co">#&gt; [46] bridgesampling_1.1-2  coda_0.19-4.1         evaluate_1.0.5       </span></span>
<span><span class="co">#&gt; [49] survival_3.8-3        RcppParallel_5.1.11-1 tensorA_0.36.2.1     </span></span>
<span><span class="co">#&gt; [52] checkmate_2.3.3       stats4_4.5.1          distributional_0.5.0 </span></span>
<span><span class="co">#&gt; [55] generics_0.1.4        rprojroot_2.1.1       rstantools_2.5.0     </span></span>
<span><span class="co">#&gt; [58] scales_1.4.0          xtable_1.8-4          glue_1.8.0           </span></span>
<span><span class="co">#&gt; [61] emmeans_1.11.2-8      tools_4.5.1           data.table_1.17.8    </span></span>
<span><span class="co">#&gt; [64] mvtnorm_1.3-3         grid_4.5.1            QuickJSR_1.8.0       </span></span>
<span><span class="co">#&gt; [67] colorspace_2.1-1      nlme_3.1-168          cli_3.6.5            </span></span>
<span><span class="co">#&gt; [70] textshaping_1.0.3     svUnit_1.0.8          Brobdingnag_1.2-9    </span></span>
<span><span class="co">#&gt; [73] V8_7.0.0              gtable_0.3.6          digest_0.6.37        </span></span>
<span><span class="co">#&gt; [76] TH.data_1.1-4         htmlwidgets_1.6.4     farver_2.1.2         </span></span>
<span><span class="co">#&gt; [79] memoise_2.0.1         htmltools_0.5.8.1     lifecycle_1.0.4      </span></span>
<span><span class="co">#&gt; [82] MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-colpizzi2025food" class="csl-entry" role="listitem">
Colpizzi, I., Sica, C., Marchetti, I., Guidi, L., Danti, S., Lucchesi, S., Giusti, E., Di Meglio, M., Ballardini, D., Mazzoni, C., et al. (2025). Food-specific decision-making in anorexia nervosa: a comparative study of clinical, at-risk, and healthy control groups. <em>Eating Disorders</em>, 1–19.
</div>
<div id="ref-rescorla1972theory" class="csl-entry" role="listitem">
Rescorla, R. A., &amp; Wagner, A. R. (1972). A theory of Pavlovian conditioning: Variations in the effectiveness of reinforcement and non-reinforcement. <em>Classical conditioning II, Current research and theory</em>, <em>2</em>, 64–69.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/formal_models/02_dynamic_models.html" class="pagination-link" aria-label="Estensioni">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Estensioni</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/formal_models/04_study_method.html" class="pagination-link" aria-label="Decisione ottimale e utilità attesa: l’approccio bayesiano">
        <span class="nav-page-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/formal_models/03_rescorla_wagner.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>