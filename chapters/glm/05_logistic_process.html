<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>39&nbsp; Dal GLM a un modello processuale per dati binari – Psicometria</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/glm/06_missing_values.html" rel="next">
<link href="../../chapters/glm/04_poisson_model.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/glm/introduction_sec.html">GLM</a></li><li class="breadcrumb-item"><a href="../../chapters/glm/05_logistic_process.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Psicometria</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/psicometria-r/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informazioni generali</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Inferenza</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/01_bayes_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inferenza bayesiana</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/02_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Abbracciare l’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/03_uncertainty_quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">La quantificazione dell’incertezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/04_statistical_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modelli statistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/05_subj_prop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Aggiornare le credenze su un parametro: dal prior alla posterior</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/06_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Distribuzioni coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/07_summary_posterior.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sintesi a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/08_balance_prior_post.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">L’influenza della distribuzione a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/09_prior_pred_check.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Controllo predittivo a priori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/10_post_pred_distr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distribuzione predittiva a posteriori</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/bayesian_inference/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">MCMC</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/01_metropolis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">L’algoritmo di Metropolis-Hastings</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/02_ppl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Linguaggi di programmazione probabilistici</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/03_stan_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Introduzione pratica a Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/04_stan_diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Diagnostica delle catene markoviane</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/05_mcmc_prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Controlli predittivi bayesiani (a priori e a posteriori) con <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/06_stan_odds_ratio_stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analisi bayesiana dell’odds ratio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/07_stan_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Confrontare due medie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/08_stan_poisson_model_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/09_stan_gaussian_mixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modelli Mistura Gaussiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/10_stan_nuisance_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Modelli con più di un parametro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/11_stan_hier_beta_binom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Modello gerarchico beta-binomiale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/12_stan_parametrization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Parametrizzazioni centered e non-centered</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/13_bayesian_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Flusso di lavoro bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/mcmc/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Regressione</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/01_reglin_frequentist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">La regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/02_regr_toward_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">La regressione verso la media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/03_reglin_bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Modello bayesiano di regressione lineare bivariata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/04_synt_sugar_sea_ice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Zucchero sintattico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/05_stan_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Regressione lineare in Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/06_specification_error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Errore di specificazione e bias da variabile omessa</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/07_one_mean.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Inferenza bayesiana su una media</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/08_two_means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Confronto tra le medie di due gruppi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/09_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto: valutare la rilevanza pratica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/10_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Pianificazione della dimensione campionaria</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/11_anova_1via.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">ANOVA ad una via</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/linear_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">GLM</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/01_logistic_regr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Regressione logistica con Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/02_one_proportion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Inferenza sulle proporzioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/03_two_proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Confronto tra due proporzioni con la regressione logistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/04_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/05_logistic_process.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/06_missing_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/glm/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive sulla sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Entropia</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/01_entropy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Entropia e informazione di Shannon</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/02_kl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">La divergenza di Kullback-Leibler</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/03_model_comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Valutare i modelli bayesiani</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/entropy/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Modelli</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/introduction_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione alla sezione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/01_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Il modello di revisione degli obiettivi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/02_dynamic_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Estensioni</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/03_rescorla_wagner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Il modello di Rescorla–Wagner</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/04_study_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Decisione ottimale e utilità attesa: l’approccio bayesiano</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/formal_models/conclusions_sec.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Riflessioni conclusive della sezione</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Crisi</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/introduction_replication_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/01_crisis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">La crisi della replicazione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/02_limits_stat_freq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">Limiti dell’inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/03_effect_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">La grandezza dell’effetto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/04_s_m_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">51</span>&nbsp; <span class="chapter-title">Errori di segno e errori di grandezza</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/05_p_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">52</span>&nbsp; <span class="chapter-title">La fragilità del <em>p</em>-valore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/06_changes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">53</span>&nbsp; <span class="chapter-title">Riforma</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/07_degrees_of_freedom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">54</span>&nbsp; <span class="chapter-title">I gradi di libertà del ricercatore</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/replication_crisis/08_integrity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">55</span>&nbsp; <span class="chapter-title">Integrità della ricerca</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">La Shell</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a01a_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Cartelle e documenti</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a02_math_symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Simbologia di base</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a03_latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Equazioni Matematiche in LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a11_numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Numeri e intervalli</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a12_sum_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Sommatorie</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a13_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Insiemi</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a14_combinatorics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">H</span>&nbsp; <span class="chapter-title">Calcolo combinatorio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a15_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">I</span>&nbsp; <span class="chapter-title">Per liberarvi dai terrori preliminari</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a35_other_conjugate_families.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">J</span>&nbsp; <span class="chapter-title">Altre famiglie coniugate</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a36_gamma_poisson_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">K</span>&nbsp; <span class="chapter-title">Modello coniugato Gamma-Poisson</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a40_metropolis_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">L</span>&nbsp; <span class="chapter-title">Metropolis: esempio Normale–Normale</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a41_cmdstanr_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">M</span>&nbsp; <span class="chapter-title">Implementazione di modelli Bayesiani con Stan tramite <code>cmdstanr</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a47_first_order_markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">N</span>&nbsp; <span class="chapter-title">Catene di Markov</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a50_lin_fun.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">O</span>&nbsp; <span class="chapter-title">La funzione lineare</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendix/a71_install_cmdstan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">P</span>&nbsp; <span class="chapter-title">Come installare CmdStan</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#dal-modello-statico-al-modello-processuale" id="toc-dal-modello-statico-al-modello-processuale" class="nav-link active" data-scroll-target="#dal-modello-statico-al-modello-processuale"><span class="header-section-number">39.1</span> Dal modello statico al modello processuale</a></li>
  <li><a href="#oltre-il-glm-dinamica-temporale" id="toc-oltre-il-glm-dinamica-temporale" class="nav-link" data-scroll-target="#oltre-il-glm-dinamica-temporale"><span class="header-section-number">39.2</span> Oltre il GLM: dinamica temporale</a></li>
  <li><a href="#il-modello-ar1" id="toc-il-modello-ar1" class="nav-link" data-scroll-target="#il-modello-ar1"><span class="header-section-number">39.3</span> Il modello AR(1)</a></li>
  <li><a href="#dallar1-allark" id="toc-dallar1-allark" class="nav-link" data-scroll-target="#dallar1-allark"><span class="header-section-number">39.4</span> Dall’AR(1) all’AR(K)</a></li>
  <li><a href="#simulazione-dati" id="toc-simulazione-dati" class="nav-link" data-scroll-target="#simulazione-dati"><span class="header-section-number">39.5</span> Simulazione dati</a></li>
  <li><a href="#tabella-ponte-dallalgebra-a-stan" id="toc-tabella-ponte-dallalgebra-a-stan" class="nav-link" data-scroll-target="#tabella-ponte-dallalgebra-a-stan"><span class="header-section-number">39.6</span> Tabella-ponte: dall’algebra a Stan</a></li>
  <li><a href="#modello-stan" id="toc-modello-stan" class="nav-link" data-scroll-target="#modello-stan"><span class="header-section-number">39.7</span> Modello Stan</a></li>
  <li><a href="#confronto-con-glmm-logit-via-brm" id="toc-confronto-con-glmm-logit-via-brm" class="nav-link" data-scroll-target="#confronto-con-glmm-logit-via-brm"><span class="header-section-number">39.8</span> Confronto con GLMM logit (via <code>brm</code>)</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/glm/05_logistic_process.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/glm/introduction_sec.html">GLM</a></li><li class="breadcrumb-item"><a href="../../chapters/glm/05_logistic_process.html"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-ar1" class="quarto-section-identifier"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Dal GLM a un modello processuale per dati binari</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="introduzione" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="introduzione">Introduzione</h2>
<p>La <em>regressione logistica</em> è lo strumento di riferimento per analizzare esiti binari <span class="math inline">\(y\in\{0,1\}\)</span> in funzione di predittori osservabili <span class="math inline">\(\mathbf{x}\)</span>. Fin qui l’abbiamo usata come <em>GLM statico</em>, assumendo osservazioni indipendenti, effetti invarianti nel tempo e un unico meccanismo generativo. Queste ipotesi sono utili per molti problemi, ma diventano limitanti quando vogliamo descrivere <em>processi psicologici dinamici</em>, in cui la risposta osservata è l’esito momentaneo di <em>stati interni</em> che si evolvono nel tempo.</p>
<p>Esempi classici: in un compito ripetuto, la risposta al <em>trial</em> <span class="math inline">\(t\)</span> può dipendere dall’esito al <em>trial</em> <span class="math inline">\(t-1\)</span> (rinforzo, frustrazione, fatica), così come da <em>stati latenti</em> che variano lentamente (motivazione, attenzione). Il GLM logit standard non “vede” questa <em>history dependence</em>: tratta ogni risposta come se nascesse da zero. Per catturare la dimensione temporale, introduciamo una <em>variabile latente continua</em> <span class="math inline">\(u_{i,t}\)</span> — la propensione interna a rispondere “1” del soggetto <span class="math inline">\(i\)</span> al tempo <span class="math inline">\(t\)</span> — e le permettiamo di <em>portare memoria del passato</em>:</p>
<p><span class="math display">\[
\Pr(y_{i,t}=1\mid u_{i,t})=\operatorname{logit}^{-1}(u_{i,t}), \qquad
u_{i,t}= \alpha_i + \mathbf{x}_{i,t}^\top\boldsymbol\beta + \phi\,u_{i,t-1} + \eta_{i,t}.
\]</span></p>
<p>Qui <span class="math inline">\(\alpha_i\)</span> cattura la propensione media soggetto-specifica, <span class="math inline">\(\boldsymbol\beta\)</span> gli effetti dei predittori, <span class="math inline">\(\phi\)</span> la <em>persistenza dinamica</em> (quanta parte dello stato passato sopravvive), e <span class="math inline">\(\eta_{i,t}\)</span> il <em>rumore di processo</em>. Se <span class="math inline">\(\phi=0\)</span>, torniamo al GLM statico; se <span class="math inline">\(\phi\neq 0\)</span>, modelliamo esplicitamente la <em>dipendenza seriale</em>.</p>
<p>In questo capitolo mostreremo come passare dal GLM logit a un <em>modello processuale autoregressivo</em> (AR) su scala logit, implementato in <em>Stan</em>. Partiremo da un’interpretazione latente del logit, introdurremo l’AR(1) e la sua estensione AR(<span class="math inline">\(K\)</span>) per memorie più lunghe, simuleremo dati per verificare il recupero dei parametri e confronteremo le stime con un <em>GLMM logit</em> (via <code>brms</code>). Vedremo che distinguere tra <em>effetto dei predittori</em> (<span class="math inline">\(\boldsymbol\beta\)</span>) e <em>dinamica interna</em> (<span class="math inline">\(\phi\)</span>) è essenziale per evitare stime distorte e per ancorare l’analisi statistica a <em>ipotesi psicologiche</em> sui meccanismi che generano il comportamento.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esempio.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Immaginiamo uno studente che affronta un test a scelta multipla. Con un modello logistico classico possiamo prevedere se risponderà correttamente in base alla difficoltà della domanda. Ma se lo stesso studente sta svolgendo una lunga serie di prove, la sua risposta alla domanda 10 dipende anche da come è andata la domanda 9: un errore può ridurre la fiducia, un successo può aumentarla. In più, col passare del tempo, possono intervenire affaticamento o distrazione. Il modello statico logit non cattura nulla di tutto ciò. Per includere questi aspetti servono modelli che riconoscano che ogni osservazione porta memoria del passato.</p>
</div>
</div>
</div>
<p>L’obiettivo di questo capitolo è mostrare come, con <em>Stan</em>, sia possibile <em>esplicitare il meccanismo generativo</em> delle risposte, superando i limiti della regressione logistica classica e introducendo la nozione di <em>processi dinamici autoregressivi</em> che meglio riflettono la natura temporale dei fenomeni psicologici.</p>
<section id="panoramica-del-capitolo" class="level3 unnumbered unlisted"><h3 class="unnumbered unlisted anchored" data-anchor-id="panoramica-del-capitolo">Panoramica del capitolo</h3>
<ul>
<li>Introduzione ai modelli dinamici in psicologia, superando i limiti dei GLM statici.</li>
<li>La regressione logistica classica reinterpretata attraverso variabili latenti e soglie.</li>
<li>Estensione al modello AR(1) per catturare la dipendenza temporale e la “memoria” del passato.</li>
<li>Implementazione pratica in Stan, con simulazione dati e confronto con modelli statici (GLMM).</li>
<li>Evidenza che i modelli processuali dinamici forniscono stime più fedeli ai meccanismi generativi.</li>
</ul>
<div class="callout callout-style-simple callout-caution no-icon callout-titled" title="Preparazione del Notebook">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">brms</span>, <span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">brms</span>, <span class="va">bayestestR</span>, <span class="va">insight</span>, <span class="va">conflicted</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">conflicts_prefer</span><span class="op">(</span><span class="fu">posterior</span><span class="fu">::</span><span class="va">mad</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="dal-modello-statico-al-modello-processuale" class="level2" data-number="39.1"><h2 data-number="39.1" class="anchored" data-anchor-id="dal-modello-statico-al-modello-processuale">
<span class="header-section-number">39.1</span> Dal modello statico al modello processuale</h2>
<section id="la-regressione-logistica-classica" class="level3" data-number="39.1.1"><h3 data-number="39.1.1" class="anchored" data-anchor-id="la-regressione-logistica-classica">
<span class="header-section-number">39.1.1</span> La regressione logistica classica</h3>
<p>Nel modello di regressione logistica (GLM logit) la probabilità di osservare una risposta positiva è:</p>
<p><span class="math display">\[
\Pr(y_i=1 \mid \mathbf{x}_i) = \operatorname{logit}^{-1}\!\left(\alpha + \mathbf{x}_i^\top \boldsymbol\beta\right).
\]</span></p>
<p>Qui:</p>
<ul>
<li>
<span class="math inline">\(\alpha\)</span> è l’<em>intercetta</em>, che rappresenta la tendenza di base a rispondere 1;</li>
<li>
<span class="math inline">\(\boldsymbol\beta\)</span> descrive come i predittori osservati influenzano questa probabilità.</li>
</ul>
<p>Un modo intuitivo per interpretare la formula è introdurre una <em>variabile latente continua</em> <span class="math inline">\(u_i\)</span>, che possiamo pensare come la <em>propensione interna</em> dell’individuo a rispondere “1”:</p>
<p><span class="math display">\[
u_i = \alpha + \mathbf{x}_i^\top \boldsymbol\beta + \varepsilon_i,
\qquad \varepsilon_i \sim \text{Logistic}(0,1).
\]</span></p>
<p>La regola di decisione è semplice:</p>
<ul>
<li>se <span class="math inline">\(u_i &gt; 0\)</span> allora osserviamo <span class="math inline">\(y_i=1\)</span>,</li>
<li>se <span class="math inline">\(u_i \leq 0\)</span> allora osserviamo <span class="math inline">\(y_i=0\)</span>.</li>
</ul>
<p>In altre parole, immaginiamo che l’individuo abbia una <em>soglia fissa</em>: quando la propensione supera questa soglia, la risposta osservata diventa positiva.</p>
<p>Possiamo pensare a <span class="math inline">\(u_i\)</span> come a un “serbatoio di propensione”: se il livello supera la soglia, si osserva una risposta positiva. Nei modelli statici il serbatoio si svuota e si riempie indipendentemente a ogni trial; nei modelli dinamici, invece, il livello attuale dipende anche da quanto era pieno al trial precedente.</p>
<p>Nella regressione logistica classica, questa soglia è sempre costante nel tempo e uguale per tutti i trial. Ma nei processi psicologici reali ciò non è sempre realistico: la soglia decisionale (o l’intensità della propensione) può cambiare da un momento all’altro, ad esempio per effetto di apprendimento, fatica o variazioni di motivazione.</p>
<p>Ed è proprio da qui che nasce la necessità di <em>estendere il modello logit statico a un modello dinamico</em>, in cui la variabile latente <span class="math inline">\(u\)</span> (e talvolta anche la soglia) possa variare nel tempo e riflettere la natura evolutiva dei processi psicologici.</p>
</section></section><section id="oltre-il-glm-dinamica-temporale" class="level2" data-number="39.2"><h2 data-number="39.2" class="anchored" data-anchor-id="oltre-il-glm-dinamica-temporale">
<span class="header-section-number">39.2</span> Oltre il GLM: dinamica temporale</h2>
<p>Nella regressione logistica classica abbiamo visto che ogni risposta osservata <span class="math inline">\(y_i\)</span> può essere pensata come il risultato di una <em>propensione latente</em> <span class="math inline">\(u_i\)</span>, confrontata con una soglia fissa. Questa impostazione funziona bene se consideriamo le osservazioni come indipendenti e isolate.</p>
<p>Ma in psicologia le cose vanno spesso diversamente:</p>
<ul>
<li>negli <em>esperimenti con prove ripetute</em>, le decisioni prese oggi sono influenzate da quelle appena fatte;</li>
<li>nelle <em>misurazioni longitudinali (EMA)</em>, lo stato emotivo o motivazionale di un momento dipende in parte da quello precedente;</li>
<li>nei <em>compiti di apprendimento</em>, l’esperienza accumulata modifica gradualmente la propensione a scegliere un’opzione rispetto a un’altra.</li>
</ul>
<p>In tutti questi casi, è naturale immaginare che la variabile latente <em><span class="math inline">\(u_{i,t}\)</span> non nasca da zero a ogni prova</em>, ma <em>porti memoria del passato</em>.</p>
</section><section id="il-modello-ar1" class="level2" data-number="39.3"><h2 data-number="39.3" class="anchored" data-anchor-id="il-modello-ar1">
<span class="header-section-number">39.3</span> Il modello AR(1)</h2>
<p>Per rendere esplicita la dipendenza dal passato, usiamo un modello <em>autoregressivo di ordine 1</em> (AR(1); <span class="citation" data-cites="chatfield2019analysis">Chatfield &amp; Xing (<a href="#ref-chatfield2019analysis" role="doc-biblioref">2019</a>)</span>):</p>
<p><span class="math display">\[
\begin{aligned}
u_{i,t} &amp;= \alpha_i
          + \mathbf{x}_{i,t}^\top \boldsymbol\beta
          + \phi \, u_{i,t-1}
          + \eta_{i,t},
&amp; \eta_{i,t} \sim \mathcal{N}(0,\sigma_u), \\[6pt]
y_{i,t} \mid u_{i,t} &amp;\sim \text{Bernoulli}\!\left(\operatorname{logit}^{-1}(u_{i,t})\right).
\end{aligned}
\]</span></p>
<p>Possiamo immaginare <span class="math inline">\(u_{i,t}\)</span> come il livello di un “serbatoio di propensione”: se questo valore supera la soglia implicita dello 0 sulla scala logit, la risposta osservata è positiva <span class="math inline">\((y_{i,t}=1)\)</span>. La novità rispetto al modello statico è che il livello attuale <span class="math inline">\(u_{i,t}\)</span> dipende anche da quello precedente <span class="math inline">\(u_{i,t-1}\)</span>, attraverso il termine <span class="math inline">\(\phi u_{i,t-1}\)</span>.</p>
<p><strong>Significati dei parametri del modello AR(1):</strong></p>
<ul>
<li><p><em><span class="math inline">\(\alpha_i\)</span> (intercetta soggetto-specifica):</em> propensione media di un individuo (es. uno studente molto ansioso potrebbe avere più probabilità di rispondere “no”).</p></li>
<li><p><em><span class="math inline">\(\beta\)</span> (effetto dei predittori):</em> effetto di variabili osservabili (es. domande più facili aumentano la probabilità di risposta corretta).</p></li>
<li>
<p><em><span class="math inline">\(\phi\)</span> (persistenza dinamica):</em> quanta parte dello stato passato sopravvive:</p>
<ul>
<li>se <span class="math inline">\(\phi=0\)</span>, nessuna memoria: ogni risposta è “indipendente”,</li>
<li>se <span class="math inline">\(\phi&gt;0\)</span>, inerzia: un successo ieri aumenta la probabilità di successo oggi,</li>
<li>se <span class="math inline">\(\phi&lt;0\)</span>, alternanza: un successo ieri rende più probabile un errore oggi (pattern a zig-zag).</li>
</ul>
</li>
<li><p><em><span class="math inline">\(\sigma_u\)</span> (variabilità del processo):</em> irregolarità: se grande, le traiettorie diventano rumorose (es. risposte altalenanti per distrazioni).</p></li>
</ul>
<p>Un piccolo schema concettuale aiuta a visualizzare:</p>
<pre><code>u(t-1)  ──▶  u(t)  ──▶  y(t)
   │
   └─────────── φ ───────────┘</code></pre>
<p>Per esempio:</p>
<ul>
<li>
<span class="math inline">\(\alpha_i\)</span>: uno studente particolarmente ansioso potrebbe avere un’alta probabilità di rispondere “no” a prescindere dalla domanda;</li>
<li>
<span class="math inline">\(\beta\)</span>: se la domanda è facile (<span class="math inline">\(x=1\)</span>), aumenta la probabilità di risposta corretta;</li>
<li>
<span class="math inline">\(\phi\)</span>: se lo studente ha risposto correttamente ieri, oggi sarà più probabile che risponda ancora correttamente;</li>
<li>
<span class="math inline">\(\sigma_u\)</span>: cattura la variabilità inspiegata, come distrazioni improvvise.</li>
</ul>
<section id="che-cosè-u_it" class="level3" data-number="39.3.1"><h3 data-number="39.3.1" class="anchored" data-anchor-id="che-cosè-u_it">
<span class="header-section-number">39.3.1</span> Che cos’è <span class="math inline">\(u_{i,t}\)</span>?</h3>
<ul>
<li>
<span class="math inline">\(u_{i,t}\)</span> non è osservato: è uno <em>stato latente</em>.</li>
<li>Possiamo pensarlo come il “livello di propensione” di un individuo in un certo istante <span class="math inline">\(t\)</span>.</li>
<li>L’osservazione <span class="math inline">\(y_{i,t}\)</span> (corretto/errato, sì/no, 1/0) nasce da questo stato: se <span class="math inline">\(u_{i,t}\)</span> è alto, la probabilità di risposta positiva è alta; se è basso, è bassa.</li>
<li>Nei modelli Bayesiani o di stato latente, i valori di <span class="math inline">\(u_{i,t}\)</span> non si calcolano direttamente dai dati ma vengono <em>stimati/inferiti</em> dal modello. In pratica, otteniamo una distribuzione a posteriori su ciascun <span class="math inline">\(u_{i,t}\)</span>, non un singolo valore deterministico.</li>
</ul></section><section id="e-il-ruolo-di-phi" class="level3" data-number="39.3.2"><h3 data-number="39.3.2" class="anchored" data-anchor-id="e-il-ruolo-di-phi">
<span class="header-section-number">39.3.2</span> E il ruolo di <span class="math inline">\(\phi\)</span>?</h3>
<p>Il coefficiente <span class="math inline">\(\phi\)</span> funziona come un “peso di memoria”:</p>
<ul>
<li>Se <span class="math inline">\(\phi = 0\)</span>, il passato non conta: <span class="math inline">\(u\_{i,t}\)</span> dipende solo dai predittori e dal rumore.</li>
<li>Se <span class="math inline">\(\phi &gt; 0\)</span>, c’è <em>inerzia</em>: lo stato precedente influenza positivamente quello attuale.</li>
<li>Se <span class="math inline">\(\phi &lt; 0\)</span>, c’è <em>compensazione</em> o alternanza: uno stato alto ieri spinge verso uno basso oggi.</li>
</ul>
<p>Formalmente, <span class="math inline">\(\phi\)</span> è un coefficiente di regressione come <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>, ma agisce <em>sulla variabile latente del tempo precedente</em>, quindi introduce dipendenza temporale.</p>
</section><section id="come-si-trovano-i-valori-di-u_it-1" class="level3" data-number="39.3.3"><h3 data-number="39.3.3" class="anchored" data-anchor-id="come-si-trovano-i-valori-di-u_it-1">
<span class="header-section-number">39.3.3</span> Come “si trovano” i valori di <span class="math inline">\(u_{i,t-1}\)</span>?</h3>
<ul>
<li>All’inizio (al tempo <span class="math inline">\(t=1\)</span>), bisogna specificare una <em>condizione iniziale</em> per <span class="math inline">\(u_{i,0}\)</span>, ad esempio assumendo <span class="math inline">\(u_{i,0} \sim \mathcal{N}(0,\sigma_0)\)</span>.</li>
<li>Per i tempi successivi, ogni <span class="math inline">\(u_{i,t}\)</span> viene costruito ricorsivamente dal precedente: il modello stesso definisce la sequenza degli stati latenti.</li>
<li>In fase di stima (ad esempio con Stan), si usano i dati osservati <span class="math inline">\(y_{i,t}\)</span> per inferire a posteriori quali valori plausibili di <span class="math inline">\(u_{i,t}\)</span> rendono il modello coerente con le risposte osservate.</li>
</ul>
<p>Riassumendo:</p>
<ul>
<li>
<span class="math inline">\(u_{i,t}\)</span>: stato latente, stimato dal modello, non osservato.</li>
<li>
<span class="math inline">\(\phi\)</span>: coefficiente che regola quanto lo stato passato influenza quello presente.</li>
<li>
<span class="math inline">\(\alpha_i\)</span>, <span class="math inline">\(\beta\)</span>: intercetta e predittori osservati, come in una regressione logistica.</li>
<li>
<span class="math inline">\(\sigma_u\)</span>: variabilità residua del processo latente.</li>
</ul></section><section id="perché-è-importante" class="level3" data-number="39.3.4"><h3 data-number="39.3.4" class="anchored" data-anchor-id="perché-è-importante">
<span class="header-section-number">39.3.4</span> Perché è importante?</h3>
<p>Con il modello AR(1) facciamo un passo oltre la regressione logistica classica. La probabilità di risposta non è più determinata solo dai <em>fattori esterni osservati</em>, ma anche dagli <em>stati interni accumulati nel tempo</em>. In altre parole, il comportamento osservato non nasce “da zero” a ogni prova: porta con sé una <em>traccia del passato</em>.</p>
<p>Esempi concreti aiutano a capirlo:</p>
<ul>
<li>
<em>Compito di apprendimento:</em> se un partecipante ha appena ricevuto un rinforzo positivo, la sua propensione a ripetere la stessa scelta sarà più alta al trial successivo.</li>
<li>
<em>Diario EMA:</em> un umore negativo oggi aumenta la probabilità di trovarsi in uno stato simile anche domani, a meno che un evento esterno intervenga a interrompere la continuità.</li>
</ul>
<p>La lezione fondamentale è questa: <em>le scelte non sono indipendenti, ma intrecciate con la storia recente dell’individuo</em>. Ed è proprio questa “memoria del passato” che rende i modelli dinamici strumenti più realistici e potenti per descrivere processi psicologici rispetto ai modelli statici.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Esempio
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Per fare un esempio semplice, consideriamo un modello <em>continuo</em> con <em>un solo predittore continuo</em>. La dipendenza temporale la collochiamo <em>nei residui</em>, con una struttura <em>AR(1)</em>. In questo modo evitiamo il problema di introdurre variabili latenti non osservabili come <span class="math inline">\(u\)</span>.</p>
<p>Per il soggetto <span class="math inline">\(i\)</span> al tempo <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
y_{i,t} &amp;= \alpha_i + \beta\,x_{i,t} + e_{i,t},\\
e_{i,t} &amp;= \phi\, e_{i,t-1} + \eta_{i,t}, \qquad \eta_{i,t}\sim\mathcal N(0,\sigma_\eta^2).
\end{aligned}
\]</span></p>
<p>dove:</p>
<ul>
<li>
<span class="math inline">\(y_{i,t}\)</span> è la <em>risposta osservata</em> (continua),</li>
<li>
<span class="math inline">\(x_{i,t}\)</span> è il <em>predittore osservato</em> (continuo),</li>
<li>
<span class="math inline">\(e_{i,t}\)</span> è l’<em>errore</em> con memoria AR(1),</li>
<li>
<span class="math inline">\(\phi\)</span> è l’<em>autocorrelazione a lag 1</em> dei residui,</li>
<li>
<span class="math inline">\(\sigma_\eta\)</span> controlla l’<em>ampiezza del rumore “nuovo”</em> che entra a ogni passo.</li>
</ul>
<p>In altre parole, il valore osservato <span class="math inline">\(y_{i,t}\)</span> è composto da:</p>
<ul>
<li>una parte <em>sistematicamente spiegata</em> dal predittore <span class="math inline">\(x_{i,t}\)</span>, ponderata da <span class="math inline">\(\beta\)</span>,</li>
<li>una parte <em>casuale</em>, <span class="math inline">\(e_{i,t}\)</span>, che però non è indipendente: conserva memoria del residuo precedente (<span class="math inline">\(\phi e_{i,t-1}\)</span>). Se ieri il modello ha sovrastimato, è probabile che anche oggi rimanga un residuo positivo; lo stesso vale per una sottostima.</li>
</ul>
<blockquote class="blockquote">
<p><strong>Nota su <span class="math inline">\(e_{i,0}\)</span>.</strong> Per generare una serie “stazionaria”, inizializziamo il primo residuo dalla distribuzione stazionaria:</p>
<p><span class="math display">\[
e_{i,0} \sim \mathcal N\!\left(0,\; \frac{\sigma_\eta^2}{1-\phi^2}\right).
\]</span></p>
</blockquote>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ---- Funzione di simulazione ----</span></span>
<span><span class="va">simulate_reg_ar1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span> <span class="op">=</span> <span class="fl">0.8</span>, <span class="va">phi</span> <span class="op">=</span> <span class="fl">0.7</span>, <span class="va">sigma_eta</span> <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>                             <span class="va">T_</span> <span class="op">=</span> <span class="fl">60</span>, <span class="va">x_sd</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">seed</span> <span class="op">=</span> <span class="fl">123</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>  <span class="va">n_subj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">n_subj</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Varianza stazionaria dei residui AR(1)</span></span>
<span>  <span class="va">sigma_e2</span> <span class="op">&lt;-</span> <span class="va">sigma_eta</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">phi</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">n_subj</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">e_prev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sigma_e2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># e_{i,0}</span></span>
<span>    <span class="va">rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">T_</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">T_</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="va">x_sd</span><span class="op">)</span>             <span class="co"># predittore osservato</span></span>
<span>      <span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="va">sigma_eta</span><span class="op">)</span>        <span class="co"># innovazione</span></span>
<span>      <span class="va">e_t</span> <span class="op">&lt;-</span> <span class="va">phi</span> <span class="op">*</span> <span class="va">e_prev</span> <span class="op">+</span> <span class="va">eta</span>            <span class="co"># residuo AR(1)</span></span>
<span>      <span class="va">y_t</span> <span class="op">&lt;-</span> <span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta</span> <span class="op">*</span> <span class="va">x_t</span> <span class="op">+</span> <span class="va">e_t</span>   <span class="co"># risposta continua</span></span>
<span>      <span class="va">rows</span><span class="op">[[</span><span class="va">t</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>        subject <span class="op">=</span> <span class="va">i</span>, time <span class="op">=</span> <span class="va">t</span>,</span>
<span>        x <span class="op">=</span> <span class="va">x_t</span>, e <span class="op">=</span> <span class="va">e_t</span>, y <span class="op">=</span> <span class="va">y_t</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">e_prev</span> <span class="op">&lt;-</span> <span class="va">e_t</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">rec</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">rows</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">rec</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># ---- Parametri e simulazione ----</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>   <span class="co"># intercette soggetto-specifiche</span></span>
<span><span class="va">beta</span>  <span class="op">&lt;-</span> <span class="fl">0.8</span>           <span class="co"># effetto del predittore x</span></span>
<span><span class="va">phi</span>   <span class="op">&lt;-</span> <span class="fl">0.7</span>           <span class="co"># autocorrelazione a lag 1 dei residui</span></span>
<span><span class="va">sigma_eta</span> <span class="op">&lt;-</span> <span class="fl">1.0</span>       <span class="co"># deviazione standard innovazione</span></span>
<span><span class="va">T_</span>    <span class="op">&lt;-</span> <span class="fl">60</span>            <span class="co"># lunghezza serie temporale</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">simulate_reg_ar1</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">phi</span>, <span class="va">sigma_eta</span>, <span class="va">T_</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Grafico didattico ----</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>x_scaled <span class="op">=</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">x_scaled</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">ave_y</span><span class="op">)</span>,</span>
<span>             data <span class="op">=</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">subject</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">summarise</span><span class="op">(</span>ave_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             linewidth <span class="op">=</span> <span class="fl">0.3</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">subject</span>, ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             labeller <span class="op">=</span> <span class="fu">as_labeller</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>               <span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Soggetto "</span>, <span class="va">s</span>, <span class="st">" (alpha = "</span>, <span class="va">alpha</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>             <span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Regressione con residui AR(1): y(t) e x(t) riscalato"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"phi = "</span>, <span class="va">phi</span>, <span class="st">", sigma_eta = "</span>, <span class="va">sigma_eta</span>, <span class="st">", beta = "</span>, <span class="va">beta</span><span class="op">)</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"y(t)  (x in tratteggio, riscalato)"</span>, x <span class="op">=</span> <span class="st">"Tempo"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_logistic_process_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li>
<p><strong>Struttura del modello</strong></p>
<ul>
<li>La parte regressiva è <span class="math inline">\(\alpha_i + \beta x_{i,t}\)</span>.</li>
<li>La memoria sta nei residui: <span class="math inline">\(e_{i,t} = \phi e_{i,t-1} + \eta_{i,t}\)</span>.</li>
<li>Così il predittore <span class="math inline">\(x_{i,t}\)</span> è esogeno e <span class="math inline">\(\phi\)</span> ha un significato chiaro: è l’<em>autocorrelazione</em> tra residui consecutivi.</li>
</ul>
</li>
<li>
<p><strong>Grafico a pannelli</strong></p>
<ul>
<li>Linea piena = <span class="math inline">\(y_{i,t}\)</span>.</li>
<li>Tratteggio = <span class="math inline">\(x_{i,t}\)</span>, riscalato per confrontarlo visivamente con <span class="math inline">\(y\)</span>.</li>
<li>Si vede che <span class="math inline">\(y\)</span> segue <span class="math inline">\(x\)</span>, ma non cambia bruscamente: la presenza di <span class="math inline">\(\phi=0.7\)</span> rende la traiettoria più “liscia” grazie alla memoria nei residui.</li>
</ul>
</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ---- Verifica dell'AR(1) sui residui (soggetto 1) ----</span></span>
<span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">subject</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">ols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">df1</span><span class="op">)</span></span>
<span><span class="va">resid_ols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">ols_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df1</span><span class="op">$</span><span class="va">time</span>, <span class="va">resid_ols</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"Residui OLS (soggetto 1)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Tempo"</span>, ylab <span class="op">=</span> <span class="st">"Residuo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">resid_ols</span>, main <span class="op">=</span> <span class="st">"ACF residui OLS (soggetto 1)"</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_logistic_process_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li><strong>ACF dei residui OLS</strong></li>
</ol>
<p>Nel modello di regressione lineare semplice <span class="math inline">\(y \sim x\)</span> si assume che i residui siano indipendenti. Nel nostro esempio, però, i residui hanno memoria AR(1): se ieri erano positivi, oggi tendono a esserlo di nuovo.</p>
<p>L’<em>ACF (autocorrelation function)</em> dei residui ci permette di vedere questo effetto:</p>
<ul>
<li>misura quanto i residui in tempi diversi sono correlati,</li>
<li>il valore a <em>lag 1</em> (tra residui consecutivi) è chiaramente positivo e vicino a <span class="math inline">\(\phi\)</span>.</li>
</ul>
<p>Quindi:</p>
<ul>
<li>il modello lineare classico che assume residui indipendenti <em>non descrive bene i dati</em>,</li>
<li>occorre un modello che includa la memoria, come l’AR(1) sui residui o un modello equivalente in stato-spazio.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="dallar1-allark" class="level2" data-number="39.4"><h2 data-number="39.4" class="anchored" data-anchor-id="dallar1-allark">
<span class="header-section-number">39.4</span> Dall’AR(1) all’AR(K)</h2>
<p>Il modello AR(1) ci ha mostrato che lo stato latente <span class="math inline">\(u_{i,t}\)</span> non nasce mai da zero, ma porta con sé una traccia del passato immediato. Tuttavia, in molti processi psicologici questa “memoria a un passo” può essere troppo corta.</p>
<p>Pensiamo a situazioni in cui:</p>
<ul>
<li>l’effetto di un’esperienza non si esaurisce al trial successivo ma dura più a lungo,</li>
<li>l’umore di oggi non dipende solo da quello di ieri, ma anche da quello di due o tre giorni fa,</li>
<li>l’apprendimento si accumula su una <em>coda di feedback</em> estesa.</li>
</ul>
<p>In questi casi conviene estendere il modello ad un processo <em>autoregressivo di ordine <span class="math inline">\(K\)</span> (AR(K))</em>:</p>
<p><span class="math display">\[
u_{i,t} = \alpha_i
        + \mathbf{x}_{i,t}^\top \boldsymbol\beta
        + \phi_1 u_{i,t-1}
        + \phi_2 u_{i,t-2}
        + \dots
        + \phi_K u_{i,t-K}
        + \eta_{i,t},
\]</span> <span class="math display">\[
\eta_{i,t} \sim \mathcal{N}(0,\sigma_u).
\]</span></p>
<section id="interpretazione-psicologica" class="level3" data-number="39.4.1"><h3 data-number="39.4.1" class="anchored" data-anchor-id="interpretazione-psicologica">
<span class="header-section-number">39.4.1</span> Interpretazione psicologica</h3>
<ul>
<li>
<em><span class="math inline">\(K=1\)</span> (AR(1))</em> → memoria cortissima: il presente dipende solo dallo stato immediatamente precedente (es. l’effetto diretto di un feedback appena ricevuto).</li>
<li>
<em><span class="math inline">\(K=2\)</span> (AR(2))</em> → memoria breve: lo stato attuale risente degli ultimi due passi (es. l’umore influenzato dagli ultimi due giorni consecutivi).</li>
<li>
<em><span class="math inline">\(K \geq 3\)</span></em> → memoria più lunga: utile per processi cumulativi o ciclici (es. oscillazioni tra fasi di alta e bassa motivazione).</li>
</ul>
<p>In altre parole, aumentando <span class="math inline">\(K\)</span> allarghiamo la “finestra temporale” che il modello utilizza per spiegare il presente.</p>
</section><section id="perché-è-utile" class="level3" data-number="39.4.2"><h3 data-number="39.4.2" class="anchored" data-anchor-id="perché-è-utile">
<span class="header-section-number">39.4.2</span> Perché è utile?</h3>
<p>L’estensione ad AR(K) consente di modellare una gamma più ricca di dinamiche:</p>
<ul>
<li>
<em>inerzia semplice</em> (AR(1)),</li>
<li>
<em>effetti ritardati</em>, che emergono dopo due o più step,</li>
<li>
<em>oscillazioni regolari</em> o <em>pattern ciclici</em> (catturabili già con un AR(2) o AR(3)).</li>
</ul>
<p>Così il modello diventa più flessibile e aderente alla complessità dei processi psicologici reali, nei quali la memoria del passato non ha sempre la stessa profondità, ma può essere breve, prolungata o ciclica.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Quando usare modelli AR in psicologia?</strong></p>
<ul>
<li>Nei compiti decisionali con <em>prove ripetute</em>, quando sospettiamo che non solo l’ultima esperienza ma anche quelle precedenti influenzino la scelta.</li>
<li>Negli <em>studi EMA</em>, quando l’umore o la motivazione di oggi risentono di più giorni consecutivi.</li>
<li>In generale, in tutti i casi in cui la <em>sequenza temporale</em> porta informazioni importanti che sarebbe un errore trattare come semplice rumore.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="simulazione-dati" class="level2" data-number="39.5"><h2 data-number="39.5" class="anchored" data-anchor-id="simulazione-dati">
<span class="header-section-number">39.5</span> Simulazione dati</h2>
<p>Prima di stimare il modello su dati reali, conviene costruire un dataset <em>simulato</em> (AR(1) logit a livello latente). In questo modo possiamo verificare se il modello riesce a recuperare parametri noti e comprendere meglio il suo funzionamento.</p>
<p>Immaginiamo <span class="math inline">\(I=100\)</span> soggetti, ciascuno con <span class="math inline">\(T=30\)</span> prove, e un predittore binario <span class="math inline">\(x_{i,t}\)</span> (ad esempio: tipo di stimolo, 0 = neutro, 1 = emozionale). Lo stato latente <span class="math inline">\(u_{i,t}\)</span> evolve come un AR(1) sulla <em>scala logit</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">I</span>   <span class="op">&lt;-</span> <span class="fl">100</span>   <span class="co"># numero di soggetti</span></span>
<span><span class="va">Tt</span>  <span class="op">&lt;-</span> <span class="fl">30</span>    <span class="co"># numero di trial per soggetto</span></span>
<span><span class="va">N</span>   <span class="op">&lt;-</span> <span class="va">I</span><span class="op">*</span><span class="va">Tt</span>  <span class="co"># osservazioni totali</span></span>
<span></span>
<span><span class="co"># Parametri "veri" usati per generare i dati</span></span>
<span><span class="va">alpha_mu</span>    <span class="op">&lt;-</span> <span class="fl">0.0</span>   <span class="co"># intercetta media</span></span>
<span><span class="va">alpha_sigma</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>   <span class="co"># variabilità tra-soggetti</span></span>
<span><span class="va">beta_true</span>   <span class="op">&lt;-</span> <span class="fl">0.6</span>   <span class="co"># effetto del predittore</span></span>
<span><span class="va">phi_true</span>    <span class="op">&lt;-</span> <span class="fl">0.5</span>   <span class="co"># persistenza dinamica</span></span>
<span><span class="va">sigma_u</span>     <span class="op">&lt;-</span> <span class="fl">0.6</span>   <span class="co"># rumore di processo</span></span>
<span></span>
<span><span class="co"># Intercette soggetto-specifiche</span></span>
<span><span class="va">alpha_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">I</span>, <span class="va">alpha_mu</span>, <span class="va">alpha_sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predittore binario (0/1) random</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">N</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Costruzione dataset</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">I</span>, each <span class="op">=</span> <span class="va">Tt</span><span class="op">)</span>,</span>
<span>  t  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">Tt</span>, times <span class="op">=</span> <span class="va">I</span><span class="op">)</span>,</span>
<span>  x  <span class="op">=</span> <span class="va">x</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stato latente e risposta</span></span>
<span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">I</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">a</span>  <span class="op">&lt;-</span> <span class="va">alpha_i</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="va">Tt</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">tt</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">Tt</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">idx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">Tt</span> <span class="op">+</span> <span class="va">tt</span></span>
<span>    <span class="va">mean_ut</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">+</span> <span class="va">beta_true</span><span class="op">*</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">tt</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0</span>, <span class="va">phi_true</span><span class="op">*</span><span class="va">ui</span><span class="op">[</span><span class="va">tt</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">ui</span><span class="op">[</span><span class="va">tt</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">mean_ut</span>, <span class="va">sigma_u</span><span class="op">)</span>        <span class="co"># stato latente</span></span>
<span>    <span class="va">p</span>       <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">ui</span><span class="op">[</span><span class="va">tt</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>              <span class="co"># probabilità risposta</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">p</span><span class="op">)</span>                   <span class="co"># risposta binaria</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">u</span><span class="op">[</span><span class="op">(</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">Tt</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">i</span><span class="op">*</span><span class="va">Tt</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ui</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">u_lat</span> <span class="op">&lt;-</span> <span class="va">u</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">y</span>     <span class="op">&lt;-</span> <span class="va">y</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il modello ha bisogno di sapere quale osservazione viene <em>prima</em> nello stesso soggetto. Se non stiamo attenti, potremmo collegare l’ultimo trial del soggetto <span class="math inline">\(i\)</span> con il primo del soggetto <span class="math inline">\(i+1\)</span>, il che è sbagliato. Per evitare errori, creiamo un indice <code>prev</code> che punta al trial precedente <em>solo dello stesso soggetto</em>. Se non esiste (primo trial), mettiamo <code>0</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span>, <span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">prev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">idx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="va">prev</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">idx</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># 0 = nessun precedente</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">[</span><span class="va">prev</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esempio: se il soggetto 5 ha 30 trial, per il trial 12 <code>prev</code> punterà al trial 11, mentre per il trial 1 avrà valore <code>0</code>.</p>
</section><section id="tabella-ponte-dallalgebra-a-stan" class="level2" data-number="39.6"><h2 data-number="39.6" class="anchored" data-anchor-id="tabella-ponte-dallalgebra-a-stan">
<span class="header-section-number">39.6</span> Tabella-ponte: dall’algebra a Stan</h2>
<p>Per tradurre il modello matematico in Stan, costruiamo una “mappa” dei concetti.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 18%">
<col style="width: 32%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th>Concetto</th>
<th>Simbolo</th>
<th>Stan</th>
<th>Nota</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Numero osservazioni</td>
<td><span class="math inline">\(N\)</span></td>
<td><code>int&lt;lower=1&gt; N;</code></td>
<td></td>
</tr>
<tr class="even">
<td>Numero soggetti</td>
<td><span class="math inline">\(I\)</span></td>
<td><code>int&lt;lower=1&gt; I;</code></td>
<td></td>
</tr>
<tr class="odd">
<td>Soggetto per trial</td>
<td>—</td>
<td><code>array[N] int&lt;lower=1,upper=I&gt; id;</code></td>
<td></td>
</tr>
<tr class="even">
<td>Trial precedente (stesso soggetto)</td>
<td>—</td>
<td><code>array[N] int&lt;lower=0,upper=N&gt; prev;</code></td>
<td>0 se non esiste</td>
</tr>
<tr class="odd">
<td>Predittori</td>
<td><span class="math inline">\(\mathbf{x}_{i,t}\)</span></td>
<td><code>array[N] int x;</code></td>
<td>Estendibile a matrice</td>
</tr>
<tr class="even">
<td>Risposta</td>
<td><span class="math inline">\(y_{i,t}\)</span></td>
<td><code>array[N] int y;</code></td>
<td>Bernoulli</td>
</tr>
<tr class="odd">
<td>Stato latente</td>
<td><span class="math inline">\(u_{i,t}\)</span></td>
<td><code>vector[N] u;</code></td>
<td></td>
</tr>
<tr class="even">
<td>Intercetta soggetto</td>
<td><span class="math inline">\(\alpha_i\)</span></td>
<td>
<code>vector[I] alpha;</code> (non centrato)</td>
<td></td>
</tr>
<tr class="odd">
<td>Persistenza</td>
<td><span class="math inline">\(\phi\)</span></td>
<td><code>real&lt;lower=-0.99,upper=0.99&gt; phi;</code></td>
<td>vincolo stazionarietà</td>
</tr>
<tr class="even">
<td>Rumore di processo</td>
<td><span class="math inline">\(\sigma_u\)</span></td>
<td><code>real&lt;lower=0&gt; sigma_u;</code></td>
<td>deviazione standard</td>
</tr>
</tbody>
</table></section><section id="modello-stan" class="level2" data-number="39.7"><h2 data-number="39.7" class="anchored" data-anchor-id="modello-stan">
<span class="header-section-number">39.7</span> Modello Stan</h2>
<p>Ora traduciamo il modello AR(1) logit in Stan. L’idea è di rappresentare esplicitamente tre parti del processo:</p>
<ol type="1">
<li><p><em>Intercette soggetto-specifiche</em> (<span class="math inline">\(\alpha_i\)</span>), stimate in forma <em>non centrata</em> per migliorare la mescolanza della catena.</p></li>
<li>
<p><em>Evoluzione dello stato latente <span class="math inline">\(u_{i,t}\)</span>:</em></p>
<ul>
<li>al primo trial di ciascun soggetto, <span class="math inline">\(u_{i,1}\)</span> dipende solo dall’intercetta, dai predittori e dal rumore;</li>
<li>nei trial successivi, <span class="math inline">\(u_{i,t}\)</span> dipende anche dal valore precedente <span class="math inline">\(u_{i,t-1}\)</span>, con peso <span class="math inline">\(\phi\)</span>.</li>
</ul>
</li>
<li><p><em>Likelihood:</em> la risposta osservata <span class="math inline">\(y_{i,t}\)</span> segue una Bernoulli logit con parametro <span class="math inline">\(u_{i,t}\)</span>.</p></li>
</ol>
<p>Inoltre, nel blocco <code>generated quantities</code> calcoliamo:</p>
<ul>
<li>
<code>y_rep</code> = repliche simulate, utili per i posterior predictive check;</li>
<li>
<code>log_lik</code> = contributi della verosimiglianza, necessari per il calcolo di LOO/WAIC.</li>
</ul>
<p>Formalmente, il modello implementato è:</p>
<p><span class="math display">\[
\begin{aligned}
u_{i,1} &amp;\sim \mathcal{N}(\alpha_i + \mathbf{x}_{i,1}^\top \beta, \sigma_u), \\
u_{i,t} &amp;\sim \mathcal{N}(\alpha_i + \mathbf{x}_{i,t}^\top \beta + \phi u_{i,t-1}, \sigma_u) \quad (t&gt;1), \\
y_{i,t} \mid u_{i,t} &amp;\sim \text{Bernoulli}\!\left(\operatorname{logit}^{-1}(u_{i,t})\right).
\end{aligned}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_code</span> <span class="op">&lt;-</span> <span class="st">'</span></span>
<span><span class="st">data{</span></span>
<span><span class="st">  int&lt;lower=1&gt; N;</span></span>
<span><span class="st">  int&lt;lower=1&gt; I;</span></span>
<span><span class="st">  array[N] int&lt;lower=1,upper=I&gt; id;</span></span>
<span><span class="st">  array[N] int&lt;lower=0,upper=1&gt; x;    // estendibile a vettore</span></span>
<span><span class="st">  array[N] int&lt;lower=0,upper=1&gt; y;</span></span>
<span><span class="st">  array[N] int&lt;lower=0,upper=N&gt; prev; // 0 se non esiste trial precedente dello stesso soggetto</span></span>
<span><span class="st">}</span></span>
<span><span class="st">parameters{</span></span>
<span><span class="st">  vector[I] alpha_raw;</span></span>
<span><span class="st">  real      alpha_mu;</span></span>
<span><span class="st">  real&lt;lower=0&gt; alpha_sigma;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  real beta;</span></span>
<span><span class="st">  real&lt;lower=-0.99, upper=0.99&gt; phi;</span></span>
<span><span class="st">  real&lt;lower=0&gt; sigma_u;</span></span>
<span><span class="st"></span></span>
<span><span class="st">  vector[N] eps; // innovazioni standard N(0,1)</span></span>
<span><span class="st">}</span></span>
<span><span class="st">transformed parameters{</span></span>
<span><span class="st">  vector[I] alpha = alpha_mu + alpha_sigma * alpha_raw;</span></span>
<span><span class="st">  vector[N] u;</span></span>
<span><span class="st">  for (n in 1:N){</span></span>
<span><span class="st">    real mean_u = alpha[id[n]] + beta * x[n];</span></span>
<span><span class="st">    if (prev[n] == 0) {</span></span>
<span><span class="st">      // opzionale: condizione stazionaria per il primo trial</span></span>
<span><span class="st">      real sd1 = sigma_u / sqrt(1 - square(phi));</span></span>
<span><span class="st">      u[n] = mean_u + sd1 * eps[n];</span></span>
<span><span class="st">    } else {</span></span>
<span><span class="st">      u[n] = mean_u + phi * u[prev[n]] + sigma_u * eps[n];</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">model{</span></span>
<span><span class="st">  // Priori più informative (vedi §2)</span></span>
<span><span class="st">  alpha_raw   ~ normal(0, 1);</span></span>
<span><span class="st">  alpha_mu    ~ normal(0, 0.5);</span></span>
<span><span class="st">  alpha_sigma ~ normal(0, 0.5);   // &lt;lower=0&gt; già impone metà-normale</span></span>
<span><span class="st">  beta        ~ normal(0, 0.5);</span></span>
<span><span class="st">  phi         ~ normal(0, 0.4);   // bounds già imposti</span></span>
<span><span class="st">  sigma_u     ~ normal(0, 0.5);   // metà-normale su sd</span></span>
<span><span class="st"></span></span>
<span><span class="st">  eps ~ normal(0,1);              // innovazioni standard</span></span>
<span><span class="st">  y ~ bernoulli_logit(u);</span></span>
<span><span class="st">}</span></span>
<span><span class="st">generated quantities{</span></span>
<span><span class="st">  array[N] int y_rep;</span></span>
<span><span class="st">  vector[N] log_lik;</span></span>
<span><span class="st">  for (n in 1:N){</span></span>
<span><span class="st">    y_rep[n] = bernoulli_logit_rng(u[n]);</span></span>
<span><span class="st">    log_lik[n] = bernoulli_logit_lpmf(y[n] | u[n]);</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}</span></span>
<span><span class="st">'</span></span>
<span><span class="va">stan_file</span> <span class="op">&lt;-</span> <span class="fu">write_stan_file</span><span class="op">(</span><span class="va">stan_code</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Focalizziamoci sul blocco di codice che costruisce la <em>variabile latente dinamica</em> <span class="math inline">\(u_n\)</span> su cui poi si basa la likelihood logistica dei dati osservati <span class="math inline">\(y_n\)</span>.</p>
<p><em>Struttura della likelihood.</em> Il modello assume che la risposta osservata <span class="math inline">\(y_n \in \{0,1\}\)</span> derivi da una regressione logistica:</p>
<p><span class="math display">\[
y_n \sim \text{Bernoulli}\!\left(\operatorname{logit}^{-1}(u_n)\right),
\]</span></p>
<p>dove <span class="math inline">\(u_n\)</span> è il <em>predittore lineare dinamico</em> che evolve nel tempo con memoria AR(1). In pratica, invece di avere un predittore statico <span class="math inline">\(u_n = \alpha_i + \beta x_n\)</span>, qui aggiungiamo una <em>dipendenza dal passato</em>: lo stato latente corrente dipende anche da quello precedente.</p>
<p>Costruzione di <span class="math inline">\(u_n\)</span> nel codice:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span>:N){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">real</span> mean_u = alpha[id[n]] + beta * x[n];</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (prev[n] == <span class="dv">0</span>) {</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// primo trial del soggetto</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">real</span> sd1 = sigma_u / sqrt(<span class="dv">1</span> - square(phi));</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    u[n] = mean_u + sd1 * eps[n];</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// trial successivi</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    u[n] = mean_u + phi * u[prev[n]] + sigma_u * eps[n];</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>
<p><strong>Linea 1.</strong> Calcoliamo il contributo sistematico del soggetto e del predittore:</p>
<p><span class="math display">\[
\texttt{mean\_u} = \alpha_{id[n]} + \beta x_n.
\]</span></p>
<p>Qui <span class="math inline">\(\alpha_{id[n]}\)</span> è l’intercetta specifica del soggetto, mentre <span class="math inline">\(\beta x_n\)</span> è l’effetto del predittore osservato.</p>
</li>
<li>
<p><strong>Caso <code>prev[n]==0</code>.</strong> È il <em>primo trial</em> di quel soggetto. Non abbiamo uno stato precedente a cui agganciarci, quindi inizializziamo <span class="math inline">\(u_n\)</span> assumendo la <em>condizione stazionaria</em> del processo AR(1):</p>
<p><span class="math display">\[
u_n \sim \mathcal N\!\left(\texttt{mean\_u}, \; \frac{\sigma_u^2}{1-\phi^2}\right).
\]</span></p>
<p>Questo è implementato come <code>mean_u + sd1 * eps[n]</code>, dove <code>eps[n] ~ Normal(0,1)</code> e <code>sd1 = sigma_u / sqrt{1 - phi^2}</code>.</p>
</li>
<li>
<p><strong>Caso <code>prev[n]!=0</code>.</strong> È un trial successivo. In questo caso <span class="math inline">\(u_n\)</span> dipende <em>dal valore precedente</em> <span class="math inline">\(u_{prev[n]}\)</span>:</p>
<p><span class="math display">\[
u_n = \texttt{mean\_u} + \phi \, u_{prev[n]} + \sigma_u \, \varepsilon_n,
\quad \varepsilon_n \sim \mathcal N(0,1).
\]</span></p>
<p>Qui <span class="math inline">\(\phi\)</span> è il coefficiente AR(1) che controlla <em>quanto del passato sopravvive nel presente</em>.</p>
</li>
</ul>
<p>Intuizione:</p>
<ul>
<li>
<em><span class="math inline">\(\alpha_i\)</span>:</em> propensione media del soggetto.</li>
<li>
<em><span class="math inline">\(\beta x_n\)</span>:</em> effetto del predittore osservato al trial <span class="math inline">\(n\)</span>.</li>
<li>
<em><span class="math inline">\(\phi u_{prev[n]}\)</span>:</em> memoria: se ieri <span class="math inline">\(u\)</span> era alto, oggi tenderà a restare alto (se <span class="math inline">\(\phi&gt;0\)</span>).</li>
<li>
<em><span class="math inline">\(\sigma_u \varepsilon_n\)</span>:</em> rumore nuovo che introduce variabilità tra un trial e l’altro.</li>
</ul>
<p>Il risultato finale è che la probabilità di risposta positiva è:</p>
<p><span class="math display">\[
\Pr(y_n=1) = \operatorname{logit}^{-1}(u_n),
\]</span></p>
<p>e l’intera likelihood del modello è:</p>
<p><span class="math display">\[
p(y \mid \alpha, \beta, \phi, \sigma_u) = \prod_{n=1}^N \text{Bernoulli}\!\left(y_n \,\middle|\, \operatorname{logit}^{-1}(u_n)\right),
\]</span></p>
<p>dove ciascun <span class="math inline">\(u_n\)</span> è costruito ricorsivamente come sopra.</p>
<p>Generazione dei dati di input:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">stan_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  N   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,</span>
<span>  I   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  id  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,</span>
<span>  x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">as.array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">as.array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  prev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">as.array</a></span><span class="op">(</span><span class="va">prev</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compilazione del modello:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/cmdstan_model.html">cmdstan_model</a></span><span class="op">(</span><span class="va">stan_file</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Campionamento:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">stan_dat</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>, parallel_chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter_warmup <span class="op">=</span> <span class="fl">1500</span>, iter_sampling <span class="op">=</span> <span class="fl">1500</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Riassunto dei parametri chiave:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"alpha_mu"</span>,<span class="st">"alpha_sigma"</span>,<span class="st">"beta"</span>,<span class="st">"phi"</span>,<span class="st">"sigma_u"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 5 × 10</span></span>
<span><span class="co">#&gt;   variable     mean median    sd   mad     q5   q95  rhat ess_bulk ess_tail</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 alpha_mu    0.104  0.098 0.099 0.094 -0.047 0.275 1.004 1146.168 1890.425</span></span>
<span><span class="co">#&gt; 2 alpha_sigma 0.691  0.684 0.116 0.114  0.517 0.895 1.002  936.525 2046.042</span></span>
<span><span class="co">#&gt; 3 beta        0.609  0.607 0.094 0.095  0.456 0.770 1.000 2591.209 4164.984</span></span>
<span><span class="co">#&gt; 4 phi         0.492  0.495 0.069 0.068  0.374 0.601 1.001 1218.997 2733.870</span></span>
<span><span class="co">#&gt; 5 sigma_u     0.695  0.691 0.187 0.176  0.393 1.004 1.005  381.850  561.846</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Lettura dei risultati.</strong></p>
<p>Confrontiamo i valori stimati con quelli usati nella simulazione:</p>
<ul>
<li><p><em><span class="math inline">\(\alpha_\mu\)</span> (vero = 0.0)</em> → stimato ≈ 0.10. L’intercetta media è molto vicina al valore vero, con intervallo che comprende lo 0. La stima è quindi ben calibrata.</p></li>
<li><p><em><span class="math inline">\(\alpha_\sigma\)</span> (vero = 0.7)</em> → stimato ≈ 0.69. La variabilità tra soggetti è recuperata quasi perfettamente. Questo mostra che il modello distingue bene la propensione media dei soggetti dalle loro differenze individuali.</p></li>
<li><p><em><span class="math inline">\(\beta\)</span> (vero = 0.6)</em> → stimato ≈ 0.61. L’effetto del predittore viene stimato con grande precisione, centrato sul valore vero.</p></li>
<li><p><em><span class="math inline">\(\phi\)</span> (vero = 0.5)</em> → stimato ≈ 0.49. Anche il parametro di persistenza dinamica è correttamente recuperato: la memoria del passato è catturata in linea con i dati generati.</p></li>
<li><p><em><span class="math inline">\(\sigma_u\)</span> (vero = 0.6)</em> → stimato ≈ 0.69. Il rumore di processo è leggermente sovrastimato, ma rimane molto vicino al valore usato nella simulazione.</p></li>
</ul>
<p>In sintesi, il modello MCMC recupera in modo accurato tutti i parametri simulati. Le diagnostiche (Rhat ≈ 1, ESS elevati, nessuna divergenza) confermano che la catena ha esplorato bene lo spazio dei parametri.</p>
<section id="diagnostica-e-posterior-predictive-check" class="level3" data-number="39.7.1"><h3 data-number="39.7.1" class="anchored" data-anchor-id="diagnostica-e-posterior-predictive-check">
<span class="header-section-number">39.7.1</span> Diagnostica e Posterior Predictive Check</h3>
<p>Un passo fondamentale è confrontare i dati osservati con quelli simulati dal modello (<code>y_rep</code>). Se il modello è adeguato, le distribuzioni delle repliche devono sovrapporsi a quella dei dati reali.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">yrep_draws</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="fu">draws</span><span class="op">(</span><span class="st">"y_rep"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Converte in data.frame e poi in matrice</span></span>
<span><span class="va">yrep_df</span>  <span class="op">&lt;-</span> <span class="fu">as_draws_df</span><span class="op">(</span><span class="va">yrep_draws</span><span class="op">)</span></span>
<span><span class="va">yrep_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">yrep_df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"^y_rep"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">yrep_df</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># proporzione osservata</span></span>
<span><span class="va">prop_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">stan_dat</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># proporzioni replicate (una per draw)</span></span>
<span><span class="va">prop_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">yrep_mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ppc_dens_overlay</span><span class="op">(</span>y <span class="op">=</span> <span class="va">stan_dat</span><span class="op">$</span><span class="va">y</span>, yrep <span class="op">=</span> <span class="va">yrep_mat</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="05_logistic_process_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>Il <em>posterior predictive check</em> mostra che la distribuzione dei dati simulati dal modello (<code>y_rep</code>) si sovrappone bene a quella dei dati osservati (<code>y</code>).</p>
<ul>
<li>La <em>densità osservata</em> (linea nera) cade quasi sempre all’interno del ventaglio di densità replicate (linee colorate).</li>
<li>Questo significa che il modello riesce a generare dati che “assomigliano” a quelli reali, un segnale che la struttura autoregressiva AR(1) e i parametri stimati catturano i meccanismi principali del processo.</li>
<li>Se vedessimo sistematiche discrepanze (ad esempio code troppo corte o una distribuzione spostata), sarebbe un campanello d’allarme che il modello è <strong>mal specificato</strong> o che mancano variabili importanti.</li>
</ul>
<p>In sintesi: un buon PPC non prova che il modello sia <em>vero</em>, ma aumenta la fiducia che sia <em>plausibile</em> e che descriva i dati in modo coerente con le ipotesi teoriche.</p>
</section></section><section id="confronto-con-glmm-logit-via-brm" class="level2" data-number="39.8"><h2 data-number="39.8" class="anchored" data-anchor-id="confronto-con-glmm-logit-via-brm">
<span class="header-section-number">39.8</span> Confronto con GLMM logit (via <code>brm</code>)</h2>
<p>Per confronto abbiamo stimato lo stesso dataset con un GLM logit semplice in <code>brm</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">stan_dat</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">stan_dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">stan_dat</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ATTENZIONE: brms ignora la dipendenza seriale e l'eterogeneità nei trials!</span></span>
<span><span class="va">fit_glmer</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="op">(</span><span class="va">x</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">bernoulli</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span>
<span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit_glmer</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: bernoulli </span></span>
<span><span class="co">#&gt;   Links: mu = logit </span></span>
<span><span class="co">#&gt; Formula: y ~ x + (x | id) </span></span>
<span><span class="co">#&gt;    Data: dat (Number of observations: 3000) </span></span>
<span><span class="co">#&gt;   Draws: 2 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multilevel Hyperparameters:</span></span>
<span><span class="co">#&gt; ~id (Number of levels: 100) </span></span>
<span><span class="co">#&gt;                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; sd(Intercept)        1.20      0.11     1.00     1.44 1.00      608     1062</span></span>
<span><span class="co">#&gt; sd(x)                0.13      0.10     0.00     0.37 1.00      552      821</span></span>
<span><span class="co">#&gt; cor(Intercept,x)    -0.09      0.55    -0.95     0.92 1.00     2199     1438</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Coefficients:</span></span>
<span><span class="co">#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept     0.42      0.13     0.17     0.68 1.01      347      630</span></span>
<span><span class="co">#&gt; x             0.50      0.09     0.32     0.69 1.00     2547     1579</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretazione-dei-risultati-brm" class="level3" data-number="39.8.1"><h3 data-number="39.8.1" class="anchored" data-anchor-id="interpretazione-dei-risultati-brm">
<span class="header-section-number">39.8.1</span> Interpretazione dei risultati <em>brm</em>
</h3>
<p>Il modello multilevel logit con slope/intercetta casuali, <span class="math inline">\(y \sim x + (x \mid id)\)</span>, stima:</p>
<ul>
<li>
<em>Intercept = 0.42</em> (SE ≈ 0.13): log-odds media di risposta 1 quando <span class="math inline">\(x=0\)</span>, considerando la variabilità tra soggetti.</li>
<li>
<em><span class="math inline">\(x = 0.50\)</span></em> (SE ≈ 0.09; 95% CI [0.32, 0.69]): effetto medio del predittore sulla log-odds, con pooling parziale tra soggetti.</li>
</ul>
<p><em>Eterogeneità tra soggetti:</em></p>
<ul>
<li>
<em>sd(Intercept) ≈ 1.20:</em> forte variabilità individuale nella propensione di base.</li>
<li>
<em>sd(x) ≈ 0.13:</em> variabilità più contenuta nell’effetto di <span class="math inline">\(x\)</span>.</li>
<li>
<em>cor(Intercept, x) ≈ −0.09</em> con IC molto ampio: nessuna evidenza di relazione sistematica tra tendenza di base e sensibilità al predittore.</li>
</ul>
<p>Il modello, quindi, distingue l’effetto medio di <span class="math inline">\(x\)</span> dalla notevole eterogeneità individuale, ma non rappresenta esplicitamente la dipendenza seriale tra prove.</p>
</section><section id="confronto-con-stan-modello-processuale-ar1" class="level3" data-number="39.8.2"><h3 data-number="39.8.2" class="anchored" data-anchor-id="confronto-con-stan-modello-processuale-ar1">
<span class="header-section-number">39.8.2</span> Confronto con Stan (modello processuale AR(1))</h3>
<p>Il modello AR(1) in Stan, stimato sugli stessi dati simulati, recupera accuratamente i valori veri:</p>
<ul>
<li>
<span class="math inline">\(\beta \approx 0.61\)</span> (vero = 0.60),</li>
<li>
<span class="math inline">\(\phi \approx 0.49\)</span> (vero = 0.50),</li>
<li>
<span class="math inline">\(\alpha_\sigma \approx 0.69\)</span> (vero = 0.70),</li>
<li>
<span class="math inline">\(\sigma_u \approx 0.69\)</span> (vero = 0.60).</li>
</ul>
<p>La differenza principale riguarda l’effetto di <span class="math inline">\(x\)</span>:</p>
<ul>
<li>Nel GLMM multilevel, <span class="math inline">\(\hat\beta \approx 0.50\)</span>,</li>
<li>Nel modello processuale AR(1), <span class="math inline">\(\hat\beta \approx 0.61\)</span>, perfettamente in linea con il valore vero.</li>
</ul>
<p>Questo accade perché il modello <em>brm</em> controlla l’eterogeneità individuale ma <em>non rappresenta la dinamica temporale</em>: la memoria del passato (<span class="math inline">\(\phi\)</span>) resta non modellata e una parte della dipendenza seriale viene assorbita nelle stime delle varianze casuali o nell’effetto medio del predittore.</p>
<p>Il modello in Stan, invece, <em>separa esplicitamente</em> il contributo del predittore (<span class="math inline">\(\beta\)</span>) dalla persistenza dinamica (<span class="math inline">\(\phi\)</span>) e dal rumore di processo (<span class="math inline">\(\sigma_u\)</span>), producendo stime più fedeli al meccanismo generativo.</p>
</section><section id="messaggio-chiave" class="level3" data-number="39.8.3"><h3 data-number="39.8.3" class="anchored" data-anchor-id="messaggio-chiave">
<span class="header-section-number">39.8.3</span> Messaggio chiave</h3>
<ul>
<li>Il GLMM con slope/intercette casuali cattura bene l’eterogeneità tra soggetti, ma non la dipendenza temporale.</li>
<li>Il modello AR(1) in Stan, introducendo la dinamica degli stati latenti, fornisce un effetto di <span class="math inline">\(x\)</span> più vicino al valore vero e una rappresentazione più realistica del processo psicologico sottostante.</li>
</ul></section></section><section id="riflessioni-conclusive" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="riflessioni-conclusive">Riflessioni conclusive</h2>
<p>In questo capitolo abbiamo superato i limiti del <em>GLM logit statico</em> introducendo una <em>struttura dinamica</em> sugli stati latenti. L’idea chiave è semplice e potente: la probabilità di risposta non dipende solo da <span class="math inline">\(\mathbf{x}\)</span>, ma anche da <em>ciò che è appena accaduto</em>, tramite lo stato <span class="math inline">\(u_{i,t}\)</span> che <em>accumula</em> informazioni nel tempo. Con l’AR(1) (ed estensioni AR(<span class="math inline">\(K\)</span>)) abbiamo reso esplicita la <em>memoria</em> del processo; con <em>Stan</em> abbiamo separato in modo netto <em>propensione media</em> (<span class="math inline">\(\alpha_i\)</span>), <em>effetto dei predittori</em> (<span class="math inline">\(\boldsymbol\beta\)</span>), <em>persistenza</em> (<span class="math inline">\(\phi\)</span>) e <em>rumore di processo</em> (<span class="math inline">\(\sigma_u\)</span>), ottenendo stime fedeli al <em>meccanismo generativo</em>.</p>
<p>Il confronto con un <em>GLMM logit</em> ha chiarito il punto: i modelli multilevel gestiscono bene l’eterogeneità tra soggetti, ma se la <em>dipendenza temporale</em> non è rappresentata, parte della dinamica viene assorbita in varianze casuali o negli effetti medi, <em>distorcendo</em> l’interpretazione. I <em>posterior predictive checks</em> hanno confermato che il modello processuale riproduce le caratteristiche salienti dei dati, aumentando la fiducia nella sua adeguatezza.</p>
<p>Il messaggio metodologico è duplice:</p>
<ol type="1">
<li>
<strong>Statisticamente</strong>, i GLM restano un quadro unificante, ma vanno estesi quando la struttura dei dati lo richiede: nei compiti ripetuti, nelle misure EMA, nei processi di apprendimento o affaticamento, la <em>storia</em> conta.</li>
<li>
<strong>Psicologicamente</strong>, passare a un <em>modello processuale</em> significa spostarsi dalla <em>descrizione</em> all’<em>ipotesi sui meccanismi</em>: ciò che stimiamo non è solo “se un predittore influisce”, ma <em>come</em> l’influenza si accumula, persiste o si alterna nel tempo.</li>
</ol>
<p>Nei capitoli successivi useremo questa logica per ampliare la modellazione di processi cognitivi e decisionali: la dinamica latente diventerà il filo conduttore che collega il dato osservato al <em>processo</em> che lo ha generato.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="Informazioni sull'ambiente di sviluppo">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Informazioni sull’ambiente di sviluppo
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] insight_1.4.2         bayestestR_0.17.0     cmdstanr_0.9.0       </span></span>
<span><span class="co">#&gt;  [4] pillar_1.11.0         tinytable_0.13.0      patchwork_1.3.2      </span></span>
<span><span class="co">#&gt;  [7] ggdist_3.3.3          tidybayes_3.0.7       bayesplot_1.14.0     </span></span>
<span><span class="co">#&gt; [10] ggplot2_3.5.2         reliabilitydiag_0.2.1 priorsense_1.1.1     </span></span>
<span><span class="co">#&gt; [13] posterior_1.6.1       loo_2.8.0             rstan_2.32.7         </span></span>
<span><span class="co">#&gt; [16] StanHeaders_2.32.10   brms_2.22.0           Rcpp_1.1.0           </span></span>
<span><span class="co">#&gt; [19] sessioninfo_1.2.3     conflicted_1.2.0      janitor_2.2.1        </span></span>
<span><span class="co">#&gt; [22] matrixStats_1.5.0     modelr_0.1.11         tibble_3.3.0         </span></span>
<span><span class="co">#&gt; [25] dplyr_1.1.4           tidyr_1.3.1           rio_1.2.3            </span></span>
<span><span class="co">#&gt; [28] here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        reshape2_1.4.4       </span></span>
<span><span class="co">#&gt; [10] systemfonts_1.2.3     vctrs_0.6.5           stringr_1.5.1        </span></span>
<span><span class="co">#&gt; [13] pkgconfig_2.0.3       arrayhelpers_1.1-0    fastmap_1.2.0        </span></span>
<span><span class="co">#&gt; [16] backports_1.5.0       labeling_0.4.3        utf8_1.2.6           </span></span>
<span><span class="co">#&gt; [19] rmarkdown_2.29        ps_1.9.1              ragg_1.5.0           </span></span>
<span><span class="co">#&gt; [22] purrr_1.1.0           xfun_0.53             cachem_1.1.0         </span></span>
<span><span class="co">#&gt; [25] jsonlite_2.0.0        broom_1.0.9           parallel_4.5.1       </span></span>
<span><span class="co">#&gt; [28] R6_2.6.1              stringi_1.8.7         RColorBrewer_1.1-3   </span></span>
<span><span class="co">#&gt; [31] lubridate_1.9.4       estimability_1.5.1    knitr_1.50           </span></span>
<span><span class="co">#&gt; [34] zoo_1.8-14            pacman_0.5.1          Matrix_1.7-4         </span></span>
<span><span class="co">#&gt; [37] splines_4.5.1         timechange_0.3.0      tidyselect_1.2.1     </span></span>
<span><span class="co">#&gt; [40] abind_1.4-8           yaml_2.3.10           codetools_0.2-20     </span></span>
<span><span class="co">#&gt; [43] curl_7.0.0            processx_3.8.6        pkgbuild_1.4.8       </span></span>
<span><span class="co">#&gt; [46] plyr_1.8.9            lattice_0.22-7        withr_3.0.2          </span></span>
<span><span class="co">#&gt; [49] bridgesampling_1.1-2  coda_0.19-4.1         evaluate_1.0.5       </span></span>
<span><span class="co">#&gt; [52] survival_3.8-3        RcppParallel_5.1.11-1 tensorA_0.36.2.1     </span></span>
<span><span class="co">#&gt; [55] checkmate_2.3.3       stats4_4.5.1          distributional_0.5.0 </span></span>
<span><span class="co">#&gt; [58] generics_0.1.4        rprojroot_2.1.1       rstantools_2.5.0     </span></span>
<span><span class="co">#&gt; [61] scales_1.4.0          xtable_1.8-4          glue_1.8.0           </span></span>
<span><span class="co">#&gt; [64] emmeans_1.11.2-8      tools_4.5.1           data.table_1.17.8    </span></span>
<span><span class="co">#&gt; [67] mvtnorm_1.3-3         grid_4.5.1            QuickJSR_1.8.0       </span></span>
<span><span class="co">#&gt; [70] colorspace_2.1-1      nlme_3.1-168          cli_3.6.5            </span></span>
<span><span class="co">#&gt; [73] textshaping_1.0.3     svUnit_1.0.8          Brobdingnag_1.2-9    </span></span>
<span><span class="co">#&gt; [76] V8_7.0.0              gtable_0.3.6          digest_0.6.37        </span></span>
<span><span class="co">#&gt; [79] TH.data_1.1-4         htmlwidgets_1.6.4     farver_2.1.2         </span></span>
<span><span class="co">#&gt; [82] memoise_2.0.1         htmltools_0.5.8.1     lifecycle_1.0.4      </span></span>
<span><span class="co">#&gt; [85] MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="bibliografia" class="level2 unnumbered unlisted"><h2 class="unnumbered unlisted anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-chatfield2019analysis" class="csl-entry" role="listitem">
Chatfield, C., &amp; Xing, H. (2019). <em>The analysis of time series: an introduction with R</em>. Chapman; hall/CRC.
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/psicometria-r\/intro\.html");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/glm/04_poisson_model.html" class="pagination-link" aria-label="Modello di Poisson">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Modello di Poisson</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/glm/06_missing_values.html" class="pagination-link" aria-label="Dati mancanti in psicologia">
        <span class="nav-page-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Dati mancanti in psicologia</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Psicometria</strong> è una risorsa didattica creata per il corso di Scienze e Tecniche Psicologiche dell’Università degli Studi di Firenze.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/psicometria-r/blob/main/chapters/glm/05_logistic_process.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/psicometria-r/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>